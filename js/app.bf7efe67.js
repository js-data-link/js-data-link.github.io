(function(){"use strict";var e={2223:function(e,t,a){var s=a(144),l=a(629),n=a(9669),r=a.n(n);function i(e,t){return t?r().request({url:`/data/${t.path}/${e}.json`,method:"get"}).then((e=>e.data)):r().request({url:`/data/${e}.json`,method:"get"}).then((e=>e.data))}function o(e){return ds.state.SupportedVersions.find((t=>t.name===e))}function c(e){return ds.state.HeroSource[e]}function u(e){return ds.state.SkillSource[e]}function d(e){const t=e.match(/\[(\d+)\]/)[1];return ds.state.SkillSource[t]}function f(e){return ds.state.ItemSource[e]}function h(e){const t=e.match(/\[(\d+)\]/)[1];return ds.state.ItemSource[t]}function m(e){return ds.state.StageSource[e]}function p(e,t,a){const s=`${e}-${t}-${a}`;return ds.state.Indexes.SuitIndex[s]}function g(e){return ds.state.Indexes.TitleIndex[e]}function b(e,t){return 10==t?ds.state.Indexes.TitleIndex[e]:ds.state.Indexes.SkillIndex[e]}function v(e){return ds.state.Indexes.MatchIndex[e]||[]}function _(e){return ds.state.Indexes.SkillConfigIndex[e]}function k(e){return ds.state.EventInfoSource[e].name}function y(e){return ds.state.customSkill.customSKills.find((t=>t.name==e))}function $(e){return ds.state.Const.friend[e]}function L(e,t){return ds.state.Const.rconf[e][t]}function x(e){return ds.state.BattleSource[e]}function S(e){return ds.state.EventConditionSource[e]}function A(e){return 0==e["teams"].length?"团战":1==e["teams"].length&&0==e["teams"][0]?"主角":"定员"}a(2087);const w={"标准裸攻":1200,"标准裸防":1200,"标准裸轻":1200,"标准场攻":1400,"标准场防":1750,"标准场轻":1300,"标准时序":6400,"标准裸主系":1200,"标准场主系":1400,"标准副系":400,"标准敌方场攻":1250,"标准敌方场防":1250,"标准敌方场轻":950,"标准敌方时序":5e3,"标准敌方武常":700,"标准武功威力":2e3,"标准暴击威力":1280,"标准突防威力":900,"标准破甲威力":600,"标准破军威力":450,"破防指数系数":.001,"减破防指数系数":5e-4,"破防分值系数":.003,"主系分值权重":.9,"时序分值系数":10,"轻功命中基准值":9e3,"命中伤害分值系数":4,"命中计算上限":1,"吸血分值基础":1.5,"吸血分值系数":5,"双击分值系数":1.08,"三击分值系数":2.52,"被攻击受伤度分值系数":3.6,"攻击受伤度分值系数":.9,"伤害反弹分值系数":2,"伤害转移分值系数":1,"伤害反震分值系数":5,"异常概率基础值":.2,"主动伤害权重":.8},C=[[0,0,0],[5,.196269186,.385470032],[10,.361933895,.695426217],[15,.500343722,.941680016],[20,.614654319,1.134735539],[25,.707827406,1.283866457],[30,.78263076,1.397192897],[35,.841638223,1.481758346],[40,.8872297,1.543606558],[45,.921591157,1.587858451],[50,.946714622,1.618789015],[55,.964398185,1.63990421],[60,.976246001,1.654017874],[65,.983668285,1.663328621],[70,.987881313,1.669496746],[75,.989907427,1.673721126],[80,.990575029,1.676816127],[85,.990518582,1.679288503],[90,.990178615,1.681414297],[95,.98987473,1.690323893],[100,.98987473,1.71981649]],Z=[[0,.25,.25,.5],[5,.25,.25,.5],[10,.2,.2,.4],[15,.15,.15,.3],[20,.1,.1,.2]],I=[[0,0],[10,1.111],[20,2.5],[30,4.286],[40,6.667],[50,9.667],[60,13.333],[70,17.778],[80,23.333],[90,30.222],[100,38.889]],E={"点穴":10,"封气":.7,"虚弱":.5,"盲目":.2,"定身":.6,"厌食":.1,"冰封":.2,"封招":.3,"剧毒":.4,"外伤":.2,"内伤":.2,"随机":.34},P={"封气":.5,"点穴":.3,"虚弱":.3,"盲目":.2,"定身":.2,"厌食":.2,"冰封":.2,"封招":.2,"剧毒":.1,"外伤":.1,"内伤":.1,"全部":2.4,"破甲":.3,"突防":.3,"杀气":.1,"杀内":.1,"杀体":.1,"杀命":.1,"中毒":.1,"秒杀":.2,"受伤":3.6,"双击":.3,"暴击":.5,"反击":.5,"击退":.3,"暗器":.1,"外功":1},F=["拳掌","御剑","兵器","指腿","暗毒"],O=["受伤","中毒","点穴","封气","定身","封招","厌食","外伤","内伤","剧毒","虚弱","盲目","冰封","暴击","双击","破甲","突防","反击","杀命","杀内","杀体","杀气","秒杀"],T=["点穴","封气","定身","封招","厌食","外伤","内伤","剧毒","虚弱","盲目","冰封"];var B={constants:w,castConf:C,rangeConf:Z,debuffConf:E,immuneConf:P,repelConf:I,classes:F,immuneTags:O,debuffTags:T,getTotalAtk(e){return e.getValueInc("裸攻")*w["标准裸攻"]+e.getValueInc("场攻")*w["标准场攻"]},getPower(e){return e.getValueInc("威力")*w["标准武功威力"]},getDePower(e){return-e.getValueInc("减威")*w["标准武功威力"]},getClassPower(e){return F.map((t=>e.getClassValueInc(t,"威力")*w["标准武功威力"]))},getClassDePower(e){return F.map((t=>-e.getClassValueInc(t,"减威")*w["标准武功威力"]))},getTotalDef(e){return e.getValueInc("裸防")*w["标准裸防"]+e.getValueInc("场防")*w["标准场防"]},getTotalAgi(e){return e.getValueInc("裸轻")*w["标准裸轻"]+e.getValueInc("场轻")*w["标准场轻"]},getTotalSeriesSpeed(e){return e.getValue("裸系")*(.2*w["标准裸主系"]+.8*w["标准副系"])+e.getValue("场系")*(.2*w["标准场主系"]+.8*w["标准副系"])}};function V(e,t){return t=t||0,(a,s)=>{s=s||1;const l=(t+a*e)*s;return{res:l,factor:e,base:t}}}function D(e,t){return t=t||0,a=>{const s=t+a*e;return{res:s,factor:e,base:t}}}function j(e){return t=>D(e)(t-1)}function K(e,t){return t=t||0,a=>{const s=t+a*a*e;return{res:s,factor:e,base:t}}}function G(e){return t=>{if(t<0){const a=D(e,0)(-t);return a.res=-a.res,a}const a=1/(1-t)-1,s=a*e;return{res:s,factor:e,base:0}}}function R(e){return t=>G(e)(1-t)}function q(e){return e=e||{},(t,a,s)=>{if(e.flag&&1==a)return t;e["num"]&&1!=e["pct"]||(a=`${(100*a).toFixed(0)}%`),e["rate"]&&(s=s||1,a=`${a}:${(100*s).toFixed(0)}%`);const l=e["symbol"]||"+";return`${t}${l}${a}`}}function M(e){return e["round"]?(e,t,a)=>`${e}${t.toFixed(0)}%+${(100*a).toFixed(0)}%`:(e,t,a)=>`${e}${(100*t).toFixed(0)}%+${(100*a).toFixed(0)}%`}class N{constructor(e,t,a){a=a||{},this.key=e,this.group=t,this.name=a.name||e,this.value=a.value||0,this.desc=a.desc||"",this.calcType=a.calcType||"valueRate",this.calcFlags=a.calcFlags||[],this.calcArgs=a.calcArgs||{},this.printType=a.printType||"attr",this.printFlags=a.printFlags||[],this.printOptions=a.printOptions||{}}hasCalcFlag(e){return this.calcFlags.indexOf(e)>=0}hasPrintFlag(e){return this.printFlags.indexOf(e)>=0}calcTypeDisplay(){const e=[];switch(this.calcType){case"inverse":e.push("反比计算");break;case"inversePct":e.push("反比计算");break}return e.join("|")}calcGrade(e,t){switch(this.calcType){case"linear":return D(this.value,this.calcArgs["base"])(e);case"inverse":return G(this.value)(e);case"square":return K(this.value,this.calcArgs["base"])(e);case"linearPct":return j(this.value)(e);case"inversePct":return R(this.value)(e);case"valueRate":return V(this.value,this.calcArgs["base"])(e,t)}throw new Error(`Unknown calcType: ${this.calcType}`)}print(e,t,a){const s={...this.printOptions};switch(this.printFlags.forEach((e=>{s[e]=!0})),this.printType){case"attr":return q(s)(e,t,a);case"debuff":return M(s)(e,t,a)}throw new Error(`Unknown printType: ${this.printType}`)}}function H(e,t,a){return t instanceof Object&&(a=t,t=null),new N(e,t,a)}const U=[H("裸攻","属性",{name:"本身攻击",calcFlags:["cmn","pct"],printOptions:{symbol:"*"}}),H("裸防","属性",{name:"本身防御",calcFlags:["cmn","pct"],printOptions:{symbol:"*"}}),H("裸轻","属性",{name:"本身轻功",calcFlags:["cmn","pct"],printOptions:{symbol:"*"}}),H("场攻","属性",{name:"战场攻击",calcFlags:["cmn","pct"],printOptions:{symbol:"*"}}),H("场防","属性",{name:"战场防御",calcFlags:["cmn","pct"],printOptions:{symbol:"*"}}),H("场轻","属性",{name:"战场轻功",calcFlags:["cmn","pct"],printOptions:{symbol:"*"}}),H("时序","属性",{name:"行动时序",calcFlags:["cmn","pct"],printOptions:{symbol:"*"}}),H("裸系","属性",{name:"自身五系",calcFlags:["cmn","apct"],printOptions:{symbol:"*"}}),H("场系","属性",{name:"战场五系",calcFlags:["cmn","apct"],printOptions:{symbol:"*"}}),H("攻系","属性",{name:"攻防五系",calcFlags:["cmn","apct"],printOptions:{symbol:"*"}}),H("单系系数","属性",{value:10,calcFlags:["apct"]}),H("武常","属性",{name:"本方武常",calcFlags:["apct"],value:12,printOptions:{symbol:"*"}}),H("降敌武常","属性",{name:"敌方武常",value:12,printOptions:{symbol:"*"}}),H("忽视系数","属性",{value:10,printFlags:["flag"]}),H("移动","属性",{value:.25,calcArgs:{base:.25},calcFlags:["cmn"]}),H("射程","属性",{value:.25,calcArgs:{base:.25},calcFlags:["cmn"]}),H("范围","属性",{value:.5,calcArgs:{base:.5},calcFlags:["cmn"]}),H("出招","属性",{calcFlags:["cmn"]}),H("单系出招","属性",{calcFlags:["cmn"]}),H("伤害","属性",{value:4,calcType:"linearPct",calcFlags:["cmn","pct"],printOptions:{symbol:"*"}}),H("减伤","属性",{value:4,calcType:"inversePct",calcFlags:["cmn","pct"],printOptions:{symbol:"*"}}),H("加受伤","属性",{calcFlags:["cmn","pct"]}),H("减受伤","属性",{calcFlags:["cmn","pct"]}),H("吸血","属性",{value:5,calcArgs:{base:1.5},calcFlags:["cmn"],printOptions:{symbol:"*"}}),H("命中","判定",{value:4,calcType:"linearPct",calcFlags:["cmn","pct"],printOptions:{symbol:"*"}}),H("必中","判定",{value:5,calcType:"square",printFlags:["flag"]}),H("闪避","判定",{value:4,calcType:"inversePct",calcFlags:["cmn","pct"],printOptions:{symbol:"*"}}),H("暴击","判定",{value:8,calcFlags:["cmn"]}),H("双击","判定",{value:1.08,calcFlags:["cmn"]}),H("突防","判定",{value:5}),H("破甲","判定",{value:3}),H("三击","判定",{value:2.5}),H("反震","属性",{calcFlags:["cmn"]}),H("反弹","属性",{calcFlags:["cmn"]}),H("挪移","属性",{calcFlags:["cmn"]}),H("不受击","判定",{name:"无视攻击",value:4,calcType:"inverse",calcFlags:["cmn"],printOptions:{symbol:"*"}}),H("伤害减半","判定",{value:4,calcFlags:["cmn"]}),H("威力减半","判定",{value:4.5}),H("双倍伤害","判定",{value:4,calcFlags:["cmn"]}),H("回血","回复",{value:.002,printFlags:["num"]}),H("回血比","回复",{name:"百分比回血",value:20}),H("回内","回复",{value:25e-5,printFlags:["num"]}),H("回内比","回复",{name:"百分比回内",value:2.5}),H("回体","回复",{value:.02,printFlags:["num"]}),H("回伤","回复",{value:.03,printFlags:["num"]}),H("解毒","回复",{value:.004,printFlags:["num"]}),H("清伤","回复",{value:2,printFlags:["flag"]}),H("清毒","回复",{value:.2,printFlags:["flag"]}),H("回气","回复",{value:.3,printFlags:["num"]}),H("满气","回复",{value:3,printFlags:["flag"]}),H("加速","回复",{name:"回复行动条",value:5}),H("解除异常","回复",{value:1.6,printFlags:["flag"]}),H("解除一项异常","回复",{value:.8,printFlags:["flag"]}),H("重伤复活","回复",{value:.8,printFlags:["flag"]}),H("满血复活","回复",{value:3,printFlags:["flag"]}),H("挥金复活","回复",{value:1.5,printFlags:["flag"]}),H("满血复活队友","回复",{value:2,printFlags:["flag"]}),H("重伤复活队友","回复",{value:.6,printFlags:["flag"]}),H("攻击回内","回复",{value:25e-5,printFlags:["num"]}),H("直伤","致害",{value:.003,printFlags:["num"]}),H("受伤","致害",{value:.02,printFlags:["num"]}),H("杀内","致害",{value:4e-4,printFlags:["num"]}),H("杀内比","致害",{name:"百分比杀内",value:4}),H("吸内比","致害",{name:"百分比吸内",value:10}),H("杀体","致害",{value:.05,printFlags:["num"]}),H("杀气","致害",{value:.3,printFlags:["num"]}),H("清气","致害",{value:3,printFlags:["flag"]}),H("中毒","致害",{value:.005,printFlags:["num"]}),H("反弹异常","致害",{value:.3}),H("随机异常","致害",{value:.34,printType:"debuff",printFlags:["round"]}),H("造成外伤","致害",{value:.2,printType:"debuff",printFlags:["round"]}),H("造成内伤","致害",{value:.2,printType:"debuff",printFlags:["round"]}),H("造成盲目","致害",{value:.2,printType:"debuff",printFlags:["round"]}),H("造成虚弱","致害",{value:.5,printType:"debuff",printFlags:["round"]}),H("造成定身","致害",{value:.6,printType:"debuff",printFlags:["round"]}),H("造成剧毒","致害",{value:.4,printType:"debuff",printFlags:["round"]}),H("击退","致害",{name:"击退行动条",value:10,calcFlags:["cmn"],printType:"debuff"}),H("反击","行动",{value:2,printFlags:["flag"]}),H("星璇反击","行动",{value:4,printFlags:["flag"]}),H("反击两次","行动",{value:2,printFlags:["flag"]}),H("万相反击","行动",{value:10,printFlags:["flag"]}),H("星阵反击","行动",{value:20,printFlags:["flag"]}),H("无我","行动",{value:8,printFlags:["flag"]}),H("无剑真魔","行动",{value:5,printFlags:["flag"]}),H("狂宵","行动",{value:6,printFlags:["flag"]}),H("天鹏","行动",{value:3,printFlags:["flag"]}),H("追击","行动",{value:5,printFlags:["flag"]}),H("再攻","行动",{value:6,printFlags:["flag"]}),H("再起","行动",{value:9,printFlags:["flag"]}),H("六龙","结算",{value:10,printFlags:["flag"]}),H("法身","结算",{value:3,printFlags:["flag"]}),H("天极","结算",{value:16,printFlags:["flag"]}),H("无双","结算",{value:6,printFlags:["flag"]}),H("破军","结算",{value:2,printFlags:["flag"]}),H("不动","结算",{value:1,printFlags:["flag"]}),H("星光","结算",{value:3,printFlags:["flag"]}),H("百世","结算",{value:4,printFlags:["flag"]}),H("天子","结算",{value:15,printFlags:["flag"]}),H("涅槃","结算",{value:3.5,printFlags:["flag"]}),H("解体","结算",{value:2.5,printFlags:["flag"]}),H("内力承伤","结算",{value:3}),H("无视天赋","结算",{value:5,printFlags:["flag"]}),H("无视特技","结算",{value:6.25,printFlags:["flag"]}),H("无视称号","结算",{value:2,printFlags:["flag"]}),H("无视内轻属性","结算",{value:3,printFlags:["flag"]}),H("无视武常","结算",{value:24,printFlags:["flag"]}),H("无视双方武常","结算",{value:2.4,printFlags:["flag"]}),H("双击全伤","结算",{value:1.2,printFlags:["flag"]}),H("左右全伤","结算",{value:1.2,printFlags:["flag"]}),H("护体","爆气",{name:"护体概率",value:5}),H("爆内","爆气",{name:"爆内概率",value:2}),H("全屏爆绝","爆气",{value:3,printFlags:["flag"]}),H("两次爆绝","爆气",{value:1,printFlags:["flag"]}),H("爆内时爆绝","爆气",{value:.3,printFlags:["flag"]}),H("爆绝时爆内","爆气",{value:2.7,printFlags:["flag"]}),H("调息回合","爆气",{value:.2,printFlags:["num"]}),H("护体回合","爆气",{value:.2,printFlags:["num"]}),H("暗器必中","暗器",{value:1,printFlags:["flag"]}),H("暗器命中","暗器",{value:1}),H("暗器伤害","暗器",{value:.5}),H("暗器范围","暗器",{value:1,printFlags:["num"]}),H("暗器反击","暗器",{value:.1,printFlags:["flag"]}),H("医疗","治疗",{value:3}),H("服药","治疗",{value:1}),H("连续服药","治疗",{value:.5,printFlags:["flag"]}),H("服药不减","治疗",{value:1,printFlags:["flag"]}),H("立即服药","治疗",{value:.5,printFlags:["flag"]}),H("无负面服药","治疗",{value:.5,printFlags:["flag"]}),H("受医疗","治疗",{value:1}),H("修炼系数","养成",{value:8}),H("无限制修炼","养成",{value:4,printFlags:["flag"]}),H("无限制装备","养成",{value:1,printFlags:["flag"]}),H("武器属性","养成",{value:3}),H("防具属性","养成",{value:2.5}),H("骑宠属性","养成",{value:2}),H("免疫击退","免疫",{value:.3}),H("免疫反击","免疫",{value:.5}),H("免疫破甲","免疫",{value:.3}),H("免疫突防","免疫",{value:.3}),H("本方行动加速","称号",{value:25,calcType:"valueRate"}),H("敌方行动减速","称号",{value:25,calcType:"valueRate"}),H("杀敌转化","称号",{value:5})],Q=U.reduce(((e,t)=>(e[t.key]=t,e)),{}),Y={"主系":{factor:.9,desc:"一般是单系攻击效果，如忽视系数"},"单系":{factor:.2,desc:"一般是单系防御效果，如剑系伤害降低"},"主动":{factor:.8,desc:"主动攻击效果，如朱蛤吞月"},"男性":{factor:.6,desc:"针对男性的攻防效果，如天怒红莲"},"女性":{factor:.4,desc:"针对女性的攻防效果，如红粉骷髅"},"外功":{factor:.5,desc:"外功出招效果，如芷芳若汀"},"暴击":{factor:.3,desc:"攻击发生暴击时触发的效果"},"双击":{factor:.5,desc:"攻击发生双击时触发的效果，如珠联璧合"},"击中":{factor:.9,desc:"攻击命中目标后触发的效果，如天威奋烈"},"闪避":{factor:.7,desc:"被攻击闪避后触发的效果，如神游太虚"},"击杀":{factor:.3,desc:"击杀目标后触发的效果，如血海飘香"},"多杀":{factor:.15,desc:"击杀多个目标后触发的效果，如紫衫龙王"},"反击":{factor:.8,desc:"斗转/星璇反击状态下触发的效果，如龙城剑啸"},"被击中":{factor:2,desc:"被攻击命中后触发的效果，如狂宵逆浪"},"被暴击":{factor:.2,desc:"被攻击暴击后触发的效果，如菩提金身"},"被双击":{factor:.3,desc:"被攻击双击后触发的效果，如太虚妄情"},"被闪避":{factor:.2,desc:"攻击被闪避后触发的效果，如天镇武魂"},"获得异常":{factor:.2,desc:"获得异常后触发的效果，如金珂玉叶"},"战斗开始":{factor:.3,desc:"战斗开始时触发一次的效果，如悲酥清风减内"},"行动后":{factor:.7,desc:"行动后触发的效果，如凝元守一"},"退场":{factor:.1,desc:"退场时触发一次的效果，如血色玉碎"},"退场全体":{factor:.4,desc:"退场时触发一次的全体效果"},"医疗":{factor:.3,desc:"医疗时额外触发的效果，如百草凝魂解除状态"},"休息":{factor:.2,desc:"休息时额外触发的效果，如浮生若梦解除状态"},"流转":{factor:.2,desc:"流转给下一个队友的效果（注意流转技能都是全屏光环，该系数考虑了全屏光环的4倍系数）"},"回复敌方":{factor:0,desc:"回复敌方的效果，如梵我如一"},"爆内":{factor:.1,desc:"爆内时额外触发的效果，如天无尽藏"},"低血":{factor:.3,desc:"血量低于3000时触发的效果，如谁舞青山"},"低体":{factor:.4,desc:"体力低于50时触发的效果，如冷月冥归"},"双人":{factor:1.5,desc:"自身+主角双人效果，如鸯旋竞秀"},"本方全体":{factor:4,desc:"影响本方全体的光环称号"},"全体队友":{factor:3,desc:"影响全体队友的光环称号"},"敌方全体":{factor:4,desc:"影响敌方全体的光环称号"}};class X{constructor(){this.valueAttrs={},this.classValueAttrs={},this.extValues=[],this.flags={},this.immunes={},this.deBuffMakes={}}isEmpty(){return 0===Object.keys(this.valueAttrs).length&&0===Object.keys(this.classValueAttrs).length&&0===this.extValues.length&&0===Object.keys(this.flags).length&&0===Object.keys(this.immunes).length&&0===Object.keys(this.deBuffMakes).length}getValue(e){return this.valueAttrs[e]||0}setValue(e,t){this.valueAttrs[e]=t}getValueInc(e){const t=this.getValue(e);return 0!=t?t-1:0}getClassValue(e,t){return this.classValueAttrs[e]&&this.classValueAttrs[e][t]||0}getMainClassValue(e){const t=Math.max;return t(...B.classes.map((t=>this.getClassValue(t,e))))}setClassValue(e,t,a){this.classValueAttrs[e]||(this.classValueAttrs[e]={}),this.classValueAttrs[e][t]=a}getClassValueInc(e,t){const a=this.getClassValue(e,t);return 0!=a?a-1:0}getMainClassValueInc(e,t){const a=t?Math.min:Math.max;return a(...B.classes.map((t=>this.getClassValueInc(t,e))))}getExtValues(){return this.extValues}setExtValue(e,t,a,s){const l={attrType:e,value:t,rate:a,condition:s};this.extValues.push(l)}addDeBuffMake(e,t,a){this.deBuffMakes[e]||(this.deBuffMakes[e]=[]),this.deBuffMakes[e].push({rate:t,round:a})}addImmune(e){this.immunes[e]=!0}merge(e){const t=(e,t,a)=>{if(!t)return a;if(!a)return t;const s=Q[e];return s.hasCalcFlag("pct")?t*a:s.hasCalcFlag("apct")?(1+t)*(1+a)-1:t+a};for(const a in e.valueAttrs)this.valueAttrs[a]=t(a,this.valueAttrs[a],e.valueAttrs[a]);for(const a in e.classValueAttrs){this.classValueAttrs[a]||(this.classValueAttrs[a]={});for(const s in e.classValueAttrs[a])this.classValueAttrs[a][s]=t(s,this.classValueAttrs[a][s],e.classValueAttrs[a][s])}this.extValues=this.extValues.concat(e.extValues);for(const a in e.flags)this.flags[a]=!0;for(const a in e.immunes)this.immunes[a]=!0;for(const a in e.deBuffMakes)this.deBuffMakes[a]||(this.deBuffMakes[a]=[]),this.deBuffMakes[a]=this.deBuffMakes[a].concat(e.deBuffMakes[a])}}function W(e){const t=e.toFixed(0);return t>=0?t:`(${t})`}function z(e){const t=e.toFixed(2);return t>=0?t:`(${t})`}class J{constructor(e){this.type=e,this.logs=[],this.gradePoint=0}log(e){this.logs.push(e)}toString(){return`${this.type}: ${this.gradePoint.toFixed(2)}`}detail(){return this.logs.join("\n")}}class ee{constructor(e){this.entries=[],this.factor=e||1,this.totalGrade=0}addEntry(e){e&&0!=e.gradePoint&&this.entries.push(e)}calcTotalGradePoint(){let e=0;return this.entries.forEach((t=>{e+=t.gradePoint})),this.totalGrade=e*this.factor,{base:e,final:this.totalGrade}}toString(e){e=e||"";const t=this.calcTotalGradePoint(),a=this.entries.map((e=>e.toString())).join("，");return 1!=this.factor?`${e}分值：${t.final.toFixed(2)}（${t.base.toFixed(2)} * ${this.factor})，[${a}]`:`${e}分值：${t.final.toFixed(2)}，[${a}]`}detail(){const e=this.entries.map((e=>`[${e.toString()}]\n${e.detail()}\n`)).join("\n");return e}}function te(e,t){let a=new ee(t);return a.addEntry(ae(e)),a.addEntry(le(e)),a.addEntry(re(e)),a.addEntry(oe(e)),a.addEntry(ce(e)),a.addEntry(ie(e)),a.addEntry(ue(e)),a.addEntry(de(e)),a.addEntry(fe(e)),a.addEntry(he(e)),a.addEntry(me(e)),a.addEntry(pe(e)),a.addEntry(be(e)),a.addEntry(ge(e)),a.addEntry(ve(e)),a}function ae(e){const t=new J("时序分"),a=B.getTotalAtk(e),s=B.getTotalDef(e),l=B.getTotalAgi(e),n=B.getTotalSeriesSpeed(e);0==a&&0==s&&0==l&&0==n||t.log(`自身属性增幅：总攻击${W(a)}，总防御${W(s)}，总轻功${W(l)}，平均系数${W(n)}`);const r=-B.constants["标准敌方场攻"]*e.getValueInc("敌攻"),i=-B.constants["标准敌方场防"]*e.getValueInc("敌防"),o=-B.constants["标准敌方场轻"]*e.getValueInc("敌轻");0==r&&0==i&&0==o||t.log(`敌方属性降幅：攻击${W(r)}，防御${W(i)}，轻功${W(o)}`);const c=e.getValueInc("时序"),u=-e.getValueInc("敌时");0==c&&0==u||t.log(`时序系数：自身时序增加${z(c)}，敌方时序降低${z(u)}`);const d=B.constants["标准时序"],f=B.constants["标准敌方时序"],h=B.constants["时序分值系数"];t.log(`常数：标准时序${d}，标准敌方时序${f}，时序分值系数${h}`);const m=a+s+2*l+n;0!=m&&t.log(`自身属性时序增加值 = 总攻击+总防御+总轻功*2+平均系数 = ${W(a)}+${W(s)}+${W(l)}*2+${W(n)} = ${W(m)}`);const p=(d+m)*(1+c);p!=d&&t.log(`自身最终时序 = (标准时序+属性时序增加值)*(1+时序增加系数) = (${d}+${W(m)})*(1+${z(c)}) = ${W(p)}`);const g=r+i+2*o;0!=g&&t.log(`敌方时序属性降低值 = 攻击降低+防御降低+轻功降低*2 = ${W(r)}+${W(i)}+${W(o)}*2 = ${W(g)}`);const b=(f-g)*(1-u);t.log(`敌方最终时序 = (标准时序-属性时序降低值)*(1-时序降低系数) = (${f}-${W(g)})*(1-${z(u)}) = ${W(b)}`);const v=p/b/(d/f);t.log(`最终时序倍率 = (自身最终时序/标准时序)/(敌方最终时序/标准敌方时序) = (${W(p)}/${d})/(${W(b)}/${f}) = ${z(v)}`);const _=(v-1)*h;return t.log(`时序分值 = (最终时序倍率-1)*时序分值系数 = (${z(v)}-1)*${h} = ${z(_)}`),t.gradePoint=_,t}function se(e,t){const a=e.getValueInc("裸攻"),s=e.getValueInc("场攻"),l=B.constants["标准裸攻"],n=B.constants["标准场攻"],r=a*l+s*n;0==a&&0==s||(t.log(`属性：自身攻击加成${z(a)}，战场攻击加成${z(s)}；常数：标准自身攻击${W(l)}，标准战场攻击${W(n)}`),t.log(`计算：总攻击增加 = 自身攻击加成*标准自身攻击+战场攻击加成*标准战场攻击 = ${z(a)}*${l}+${z(s)}*${n} = ${W(r)}`));const i=-e.getValueInc("敌防"),o=B.constants["标准敌方场防"],c=i*o;0!=i&&(t.log(`属性：敌方防御减成：${z(i)}，常数：标准敌方防御${o}`),t.log(`计算：敌方防御降低 = 敌方防御减成*标准敌方防御 = ${z(i)}*${o} = ${z(c)}`));const u=e.getValueInc("威力"),d=B.constants["标准武功威力"],f=u*d;0!=u&&(t.log(`属性：全系威力加成${z(u)}；常数：标准威力攻击当量${d}`),t.log(`计算：全系威力攻击增加 = 全系威力加成*标准威力攻击当量 = ${z(u)}*${d} = ${W(f)}`));const h=e.getMainClassValueInc("威力"),m=h*d;h>0&&(t.log(`属性：主系威力加成${z(h)}；常数：标准威力攻击当量${d}`),t.log(`计算：主系威力攻击增加 = 主系威力加成*标准威力攻击当量 = ${z(h)}*${d} = ${W(m)}`));const p=e.getValue("裸系"),g=e.getValue("场系"),b=e.getValue("攻系"),v=e.getMainClassValue("攻系"),_=B.constants["标准裸主系"],k=B.constants["标准场主系"],y=B.constants["标准副系"],$=1.5*(p*_+(g+b+v)*k),L=1.5*(p*y+g*y+b*y);0==p&&0==g&&0==b&&0==v||(t.log(`属性：自身系数加成${z(p)}，战场系数加成${z(g)}，攻防系数加成${z(b)}，主系攻防系数加成${z(v)}；常数：标准主系自身数值${W(_)}，标准主系战场数值${W(k)}，标准副系数值${W(y)}`),t.log(`计算：主系攻击增加 = (自身系数加成*标准主系自身数值+(战场系数加成+攻防系数加成+主系攻防系数加成)*标准主系战场数值)*1.5 = (${z(p)}*${W(_)}+(${z(g)}+${z(b)}+${z(v)})*${W(k)})*1.5 = ${W($)}`),t.log(`计算：副系攻击增加 = (自身系数加成*标准副系数值+(战场系数加成+攻防系数加成)*标准副系数值)*1.5 = (${z(p)}*${W(y)}+(${z(g)}+${z(b)})*${W(y)})*1.5 = ${W(L)}`));const x=r+2*c+f+m+$,S=r+2*c+f+L;return t.log("总攻击公式：总攻击 = 属性攻击+威力攻击+系数攻击+敌方防御降低*2"),t.log(`主系总攻击 = ${W(r)}+(${W(f)}+${W(m)})+${W($)}+${W(c)}*2 = ${W(x)}`),t.log(`副系总攻击 = ${W(r)}+${W(f)}+${W(L)}+${W(c)}*2 = ${W(S)}`),[x,S]}function le(e){const t=new J("基本攻击分"),[a,s]=se(e,t),l=B.constants["破防指数系数"],n=B.constants["破防分值系数"],r=B.constants["主系分值权重"];t.log(`分值公式：分值 = 攻击*(1+惩罚系数*攻击)*分值系数*主副系占比；常数：惩罚系数${l}，分值系数${n}，主系权重${r}`);const i=_e(a,l,n)*r,o=_e(s,l,n)*(1-r);return t.log(`主系分值 = ${W(a)}*(1+${l}*${W(a)})*${n}*${z(r)} = ${z(i)}`),t.log(`副系分值 = ${W(s)}*(1+${l}*${W(s)})*${n}*${z(1-r)} = ${z(o)}`),t.gradePoint=i+o,t.log(`总分值 = ${z(i)}+${z(o)} = ${z(t.gradePoint)}`),t}function ne(e,t){const a=e.getValueInc("裸防"),s=e.getValueInc("场防"),l=B.constants["标准裸防"],n=B.constants["标准场防"],r=a*l+s*n;0==a&&0==s||(t.log(`属性：自身防御加成${z(a)}，战场防御加成${z(s)}；常数：标准自身防御${W(l)}，标准战场防御${W(n)}`),t.log(`计算：总防御增加 = 自身防御加成*标准自身防御+战场防御加成*标准战场防御 = ${z(a)}*${l}+${z(s)}*${n} = ${W(r)}`));const i=-e.getValueInc("敌攻"),o=B.constants["标准敌方场攻"],c=i*o;0!=i&&(t.log(`属性：敌方攻击减成：${z(i)}，常数：标准敌方攻击${o}`),t.log(`计算：敌方攻击降低 = 敌方攻击减成*标准敌方攻击 = ${z(i)}*${o} = ${z(c)}`));const u=-e.getValueInc("减威"),d=B.constants["标准武功威力"],f=u*d;0!=u&&(t.log(`属性：全系威力减成${z(u)}；常数：标准威力攻击当量${d}`),t.log(`计算：全系减威防御增加 = 全系威力减成*标准威力攻击当量 = ${z(u)}*${d} = ${W(f)}`));const h=-e.getMainClassValueInc("减威"),m=h*d;0!=h&&(t.log(`属性：主系威力减成${z(h)}；常数：标准威力攻击当量${d}`),t.log(`计算：主系减威防御增加 = 主系威力减成*标准威力攻击当量 = ${z(h)}*${d} = ${W(m)}`));const p=e.getValue("裸系"),g=e.getValue("场系"),b=e.getValue("攻系"),v=e.getMainClassValue("攻系"),_=B.constants["标准裸主系"],k=B.constants["标准场主系"],y=B.constants["标准副系"],$=1.5*(p*_+g*k+(b+v)*k),L=1.5*(p*y+g*y+b*y);0==p&&0==g&&0==b&&0==v||(t.log(`属性：自身系数加成${z(p)}，战场系数加成${z(g)}，攻防系数加成${z(b)}，主系攻防系数加成${z(v)}；常数：标准主系自身数值${W(_)}，标准主系战场数值${W(k)}，标准副系数值${W(y)}`),t.log(`计算：主系防御增加 = (自身系数加成*标准主系自身数值+(战场系数加成+攻防系数加成+主系攻防系数加成)*标准主系战场数值)*1.5 = (${z(p)}*${W(_)}+(${z(g)}+${z(b)}+${z(v)})*${W(k)})*1.5 = ${W($)}`),t.log(`计算：副系防御增加 = (自身系数加成*标准副系数值+(战场系数加成+攻防系数加成)*标准副系数值)*1.5 = (${z(p)}*${W(y)}+(${z(g)}+${z(b)})*${W(y)})*1.5 = ${W(L)}`));const x=2*r+c+f+m+$,S=2*r+c+f+L;return t.log("总防御公式：总防御 = 属性防御*2+威力防御+系数防御+敌方攻击降低"),t.log(`主系总防御 = ${W(r)}*2+(${W(f)}+${W(m)})+${W($)}+${W(c)} = ${W(x)}`),t.log(`副系总防御 = ${W(r)}*2+${W(f)}+${W(L)}+${W(c)} = ${W(S)}`),[x,S]}function re(e){const t=new J("基本防御分"),[a,s]=ne(e,t),l=B.constants["减破防指数系数"],n=B.constants["破防分值系数"],r=.2;t.log(`分值公式：分值 = 防御*(1+惩罚系数*防御)*分值系数*主副系占比；常数：惩罚系数${l}，分值系数${n}，主系权重${r}`);const i=_e(a,l,n)*r,o=_e(s,l,n)*(1-r);return t.log(`主系分值 = ${W(a)}*(1+${l}*${W(a)})*${n}*${z(r)} = ${z(i)}`),t.log(`副系分值 = ${W(s)}*(1+${l}*${W(s)})*${n}*${z(1-r)} = ${z(o)}`),t.gradePoint=i+o,t.log(`总分值 = ${z(i)}+${z(o)} = ${z(t.gradePoint)}`),t}function ie(e){const t=new J("暴击分"),a=e.getValue("暴击");if(0==a)return null;const s=se(e,{log:()=>{}});t.log(`攻击属性: 主系攻击${W(s[0])}，副系攻击${W(s[1])}`);const l=B.constants["标准暴击威力"],n=B.constants["破防指数系数"],r=B.constants["破防分值系数"],i=B.constants["主系分值权重"],o=s.map((e=>_e(e,n,r)));t.log(`攻击分值: 主系分值${z(o[0])}，副系分值${z(o[1])}`);let c=0;const u=(e,a,l)=>{t.log(`计算${e}相关属性: ${e}率${z(a)}；常数：标准${e}威力${W(l)}`);const u=s.map((e=>e+l));t.log(`${e}时攻击威力 = 基本攻击威力+标准${e}威力；主系攻击 = ${W(s[0])}+${l} = ${W(u[0])}，副系攻击 = ${W(s[1])}+${l} = ${W(u[1])}`);const d=u.map((e=>_e(e,n,r)));t.log(`${e}时攻击分值计算：主系分值 = 计算攻击分值(${W(u[0])}) = ${z(d[0])}，副系分值 = 计算攻击分值(${W(u[1])}) = ${z(d[1])}`);const f=d.map(((e,t)=>(e-o[t])*a));t.log(`${e}附加分值 = (${e}时攻击分值-基础攻击分值)*${e}率；主系攻击分值 = (${z(d[0])}-${z(o[0])})*${z(a)}=${z(f[0])}，副系攻击分值 = (${z(d[1])} - ${z(o[1])})*${z(a)} = ${z(f[1])}`);const h=f[0]*i+f[1]*(1-i);return t.log(`综合${e}附加分值 = 主系攻击分值*主系分值权重+副系攻击分值*(1-主系分值权重) = ${z(f[0])}*${z(i)}+${z(f[1])}*${z(1-i)} = ${z(h)}`),c+=h,h},d=[];return a>0&&d.push(["暴击分值",u("暴击",a,l)]),t.log(`情景攻击总分 = ${d.map((([e,t])=>`${e}(${z(t)})`)).join(" + ")} = ${z(c)}`),t.gradePoint=c,t}function oe(e){const t=new J("增伤分");let a=e.getValueInc("命中");a>B.constants["命中计算上限"]&&(a=B.constants["命中计算上限"]);const s=e.getValueInc("伤害");let l=e.getMainClassValueInc("命中");l>B.constants["命中计算上限"]&&(l=B.constants["命中计算上限"]);const n=e.getMainClassValueInc("伤害");t.log(`属性：命中加成${z(a)}，伤害加成${z(s)}, 主系命中加成${z(l)}, 主系伤害加成${z(n)}`);const r=B.getTotalAgi(e),i=-B.constants["标准敌方场轻"]*e.getValueInc("敌轻"),o=B.constants["轻功命中基准值"],c=(r+i)/o;0==r&&0==i||(t.log(`属性计算：自身轻功增加 = ${W(r)}，敌方轻功降低 = ${W(i)}；常数：轻功命中基准值${o}`),t.log(`轻功命中加成 = (1+(自身轻功增加+敌方轻功降低)/轻功命中基准值) = (1+(${W(r)}+${W(i)})/${o}) = ${z(c)}`));const u=B.constants["命中伤害分值系数"],d=B.constants["主系分值权重"],f=(1+a)*(1+c)*(1+s),h=f*(1+l)*(1+n);t.log(`综合增伤 = (1+命中加成)*(1+轻功命中加成)*(1+伤害加成) = (1+${z(a)})*(1+${z(c)})*(1+${z(s)}) = ${z(f)}`),t.log(`主系增伤 = 综合增伤*(1+主系命中加成)*(1+主系伤害加成) = ${z(f)}*(1+${z(l)})*(1+${z(n)}) = ${z(h)}，副系增伤 = 综合增伤 = ${z(f)}`);const m=h>=1?h-1:1-1/h,p=f>=1?f-1:1-1/f;h<1?t.log(`主系增伤差值(修正) = 1-1/主系增伤 = 1-1/${z(h)} = ${z(m)}`):t.log(`主系增伤差值 = 主系增伤-1 = ${z(h)}-1 = ${z(m)}`),f<1?t.log(`副系增伤差值(修正) = 1-1/副系增伤 = 1-1/${z(f)} = ${z(p)}`):t.log(`副系增伤差值 = 副系增伤-1 = ${z(f)}-1 = ${z(p)}`);const g=m*u*d,b=p*u*(1-d),v=g+b;return t.log(`主系增伤分= 主系增伤差值*命中伤害分值系数*主系分值权重 = ${z(g)}*${u}*${d} = ${z(g)}`),t.log(`副系增伤分= 副系增伤差值*命中伤害分值系数*(1-主系分值权重) = ${z(b)}*${u}*(1-${d}) = ${z(b)}`),t.log(`总增伤分 = 主系增伤分+副系增伤分 = ${z(g)}+${z(b)} = ${z(v)}`),t.gradePoint=v,t}function ce(e){const t=new J("减伤分"),a=-e.getValueInc("闪避"),s=-e.getValueInc("减伤"),l=-e.getMainClassValueInc("闪避",!0),n=-e.getMainClassValueInc("减伤",!0);t.log(`属性：闪避加成${z(a)}，减伤加成${z(s)}, 主系闪避加成${z(l)}, 主系减伤加成${z(n)}`);const r=B.getTotalAgi(e),i=-B.constants["标准敌方场轻"]*e.getValueInc("敌轻"),o=B.constants["轻功命中基准值"];let c=(r+i)/o;0==r&&0==i||(t.log(`属性计算：自身轻功增加 = ${W(r)}，敌方轻功降低 = ${W(i)}；常数：轻功命中基准值${o}`),t.log(`轻功闪避加成 = (1+(自身轻功增加+敌方轻功降低)/轻功命中基准值) = (1+(${W(r)}+${W(i)})/${o}) = ${z(c)}`)),c>.9&&(c=.9);let u=1;const d=[],f=e.getValue("不受击");f>0&&(u*=1-f,d.push({type:"不受攻击",value:z(1-f)}));const h=e.getValue("伤害减半");if(h>0&&(u*=1-h/2,d.push({type:"伤害减半",value:z(1-h/2)})),d.length>0){const e=d.map((e=>`${e.type}：${e.value}`)).join("，");t.log(`特殊减伤因素${e}`),d.length>1?t.log(`特殊减伤期望值 = ${d.map((e=>e.value)).join("*")} = ${z(u)}`):t.log(`特殊减伤期望值 = ${d[0].value}`)}const m=B.constants["命中伤害分值系数"],p=.2,g=(1-a)*(1-c)*(1-s)*u,b=g*(1-l)*(1-n);t.log(`综合减伤 = (1-闪避加成)*(1-轻功闪避加成)*(1-减伤加成)*特殊减伤期望 = (1-${z(a)})*(1-${z(c)})*(1-${z(s)})*${z(u)} = ${z(g)}`),t.log(`主系减伤 = 综合减伤*(1-主系闪避加成)*(1-主系减伤加成) = ${z(g)}*(1-${z(l)})*(1-${z(n)}) = ${z(b)}，副系减伤 = 综合减伤 = ${z(g)}`);const v=b>=1?1-b:1/b-1,_=g>=1?1-b:1/g-1;b<1?t.log(`主系减伤差值(修正) = 1/主系减伤-1 = 1/${z(b)}-1 = ${z(v)}`):t.log(`主系减伤差值(修正) = 1-主系减伤 = 1-${z(b)} = ${z(v)}`),g<1?t.log(`副系减伤差值(修正) = 1/副系增伤-1 = 1/${z(g)}-1 = ${z(_)}`):t.log(`副系减伤差值(修正) = 1-副系减伤 = 1-${z(g)} = ${z(_)}`);const k=v*m*p,y=_*m*(1-p),$=k+y;return t.log(`主系减伤分= 主系减伤差值*命中伤害分值系数*主系分值权重 = ${z(k)}*${m}*${p} = ${z(k)}`),t.log(`副系减伤分= 副系减伤差值*命中伤害分值系数*(1-主系分值权重) = ${z(y)}*${m}*(1-${p}) = ${z(y)}`),t.log(`总减伤分 = 主系减伤分+副系减伤分 = ${z(k)}+${z(y)} = ${z($)}`),t.gradePoint=$,t}function ue(e){const t=new J("双击分"),a=e.getValue("双击");if(0==a)return null;const s=B.constants["双击分值系数"];t.log(`属性：双击率 = ${z(a)}，常数：双击分值系数 = ${s}`);const l=ke(a,0,s);return t.log(`双击分 = 双击率*双击分值系数 = ${z(a)}*${s} = ${z(l)}`),t.gradePoint=l,t}function de(e){const t=new J("出招分"),a=e.getValue("出招"),s=e.getValue("单系出招"),l=e.getMainClassValue("出招")+s;t.log(`属性：全系出招率 = ${z(a)}；主系出招率 = ${z(l)}`);const n=$e(a,B.castConf,(e=>e[2])),r=$e(l,B.castConf,(e=>e[1]));return t.log(`查出招分表：全系出招分(${z(a)}) = ${z(n)}；主系出招分(${z(l)}) = ${z(r)}`),t.gradePoint=n+r,t.log(`出招分 = 全系出招分+主系出招分 = ${z(n)}+${z(r)} = ${z(t.gradePoint)}`),t}function fe(e){const t=new J("距离分"),a=e.getValue("移动"),s=e.getValue("射程"),l=e.getValue("范围");t.log(`属性：移动${W(a)}，射程${W(s)}，范围${W(l)}`);const n=Le(a,B.rangeConf,(e=>e[1])),r=Le(s,B.rangeConf,(e=>e[2])),i=Le(l,B.rangeConf,(e=>e[3]));return t.log(`查表计算：移动分(${W(a)}) = ${z(n)}，射程分(${W(s)}) = ${z(r)}，范围分(${W(l)}) = ${z(i)}`),t.gradePoint=n+r+i,t.log(`距离分 = 移动分+射程分+范围分 = ${z(n)}+${z(r)}+${z(i)} = ${z(t.gradePoint)}`),t}function he(e){const t=new J("吸血分"),a=e.getValue("吸血");if(0==a)return null;const s=B.constants["吸血分值基础"],l=B.constants["吸血分值系数"];t.log(`属性：吸血率${z(a)}，常数：吸血分值基础${s}，吸血分值系数${l}`);const n=ke(a,s,l);return t.log(`吸血分 = 吸血率*吸血分值系数+吸血分值基础 = ${z(a)}*${l}+${s} = ${z(n)}`),t.gradePoint=n,t}function me(e){const t=new J("受伤分"),a=e.getValueInc("加受伤");let s=-e.getValueInc("减受伤");if(0==a&&0==s)return null;s>1&&(s=1);const l=B.constants["攻击受伤度分值系数"],n=B.constants["被攻击受伤度分值系数"];t.log(`属性：攻击受伤度${z(a)}，被攻击受伤度${z(s)}，常数：攻击受伤度分值系数${l}，被攻击受伤度分值系数${n}`);const r=a>0?ye(a,l):-ye(a,n);a>0?t.log(`攻击受伤度分 = 攻击受伤度^2*攻击受伤度分值系数 = ${z(a)}^2*${l} = ${z(r)}`):a<0&&t.log(`攻击受伤度分 = -攻击受伤度^2*被攻击受伤度分值系数 = ${z(a)}^2*${n} = ${z(r)}`);const i=s>0?ye(s,n):-ye(s,l);s>0?t.log(`被攻击受伤度分 = 被攻击受伤度^2*被攻击受伤度分值系数 = ${z(s)}^2*${n} = ${z(i)}`):s<0&&t.log(`被攻击受伤度分 = -被攻击受伤度^2*攻击受伤度分值系数 = -${z(s)}^2*${l} = ${z(i)}`);const o=r+i;return t.log(`受伤分 = 攻击受伤度分+被攻击受伤度分 = ${z(r)}+${z(i)} = ${z(o)}`),t.gradePoint=o,t}function pe(e){const t=new J("反伤分"),a=e.getValue("反弹"),s=e.getValue("反震"),l=e.getValue("挪移");if(0==a&&0==s&&0==l)return null;const n=B.constants["伤害反弹分值系数"],r=B.constants["伤害反震分值系数"],i=B.constants["伤害转移分值系数"];t.log(`属性：反弹率${z(a)}，反震率${z(s)}，挪移率${z(l)}，常数：反弹分值系数${n}，反震分值系数${r}，挪移分值系数${i}`);const o=ke(a,0,n),c=ke(s,0,r),u=ke(l,0,i);t.log(`反弹分 = 反弹率*反弹分值系数 = ${z(a)}*${n} = ${z(o)}`),t.log(`反震分 = 反震率*反震分值系数 = ${z(s)}*${r} = ${z(c)}`),t.log(`挪移分 = 挪移率*转移分值系数 = ${z(l)}*${i} = ${z(u)}`);const d=o+c+u;return t.log(`反伤分 = 反弹分+反震分+挪移分 = ${z(o)}+${z(c)}+${z(u)} = ${z(d)}`),t.gradePoint=d,t}function ge(e){const t=new J("免疫分");if(0==e.immunes.length)return null;let a=0;const s=[];return Object.entries(B.immuneConf).forEach((([t,l])=>{e.immunes[t]&&(a+=l,s.push({key:t,value:l}))})),t.log(`免疫条目：${s.map((e=>`${e.key}(${e.value})`)).join("，")}`),s.length>1?t.log(`免疫分 = ${s.map((e=>e.value)).join("+")} = ${z(a)}`):t.log(`免疫分 = ${z(a)}`),t.gradePoint=a,t}function be(e){const t=new J("异常分");if(0==e.deBuffMakes.length)return null;let a=0;const s=[];if(Object.entries(B.debuffConf).forEach((([t,l])=>{const n=e.deBuffMakes[t];null!=n&&n.forEach((e=>{const n={};"点穴"==t&&(n["square"]=!0);const r=xe(e.rate/100,e.round,B.constants["异常概率基础值"],l,n);a+=r,s.push([t,e.rate,`${e.round}回合`,r])}))})),e.deBuffMakes["击退"]){const t=e.deBuffMakes["击退"];t.forEach((e=>{const t=10*(100/(100-e.round)-1),l=t*e.rate/100;a+=l,s.push(["击退",e.rate,`击退${e.round}%行动条`,l])}))}return t.log(`异常条目：${s.map((e=>`${e[0]}#${e[1]}%${e[2]}(${z(e[3])})`)).join("，")}`),s.length>1?t.log(`异常分 = ${s.map((e=>z(e[3]))).join("+")} = ${z(a)}`):t.log(`异常分 = ${z(a)}`),t.gradePoint=a,t}function ve(e){const t=new J("特殊词条分"),a=e.getExtValues();if(0==a.length)return null;let s=0;const l=[];return a.forEach((e=>{const t=e.attrType,a=Q[t],n=e.value,r=e.rate,i=a.calcGrade(n,r),o=e.condition;if(o){const e=Y[o];if(e){const t=e.factor;i.res*=t,i.cond={name:o,factor:t}}}l.push({key:t,value:n,rate:r,r:i}),s+=i.res})),l.forEach((e=>{let a=`[${e.key}]`;e.r.cond&&(a+=`(${e.r.cond.name})`),a+=`${z(e.r.res)}`;let s=`数值${z(e.value)}，系数${e.r.factor}`;0!=e.r.base&&(s+=`，基数${e.r.base}`),e.r.cond&&(s+=`，条件系数${e.r.cond.factor}`),e.rate&&(s+=`，概率${e.rate}`);let l=`${z(e.value)}*${z(e.r.factor)}`;0!=e.r.base&&(l+=`+${z(e.r.base)}`),0!=e.r.base&&(e.r.cond||e.rate)&&(l=`(${l})`),e.r.cond&&(l+=`*${e.r.cond.factor}`),e.rate&&(l+=`*${e.rate}`),l=`分值 = ${l} = ${z(e.r.res)}`,t.log(`${a}：${s}；${l}`)})),t.gradePoint=s,t}function _e(e,t,a){return e*(1+e*t)*a}function ke(e,t,a){return t+e*a}function ye(e,t){return e*e*t}function $e(e,t,a){const s=Math.round(100*e);if(s<=0)return 0;let l=t.findIndex((e=>s<e[0]))-1;return l<-1&&(l=t.length-1),a(t[l])}function Le(e,t,a){const s=Math.round(e);if(s<=0)return 0;let l=t.findIndex((e=>s<e[0]))-1,n=a(t[0]),r=0;l<-1&&(l=t.length-1);for(let i=0;i<l;i++)n+=(t[i][0]-r)*a(t[i]),r=t[i][0];return n+=(s-r)*a(t[l]),n>20*a(t[0])&&(n=20*a(t[0])),n}function xe(e,t,a,s,l){if(0==e||0==t)return 0;let n=e+a;return n>1&&(n=1),l&&l["square"]&&(n*=n),n*t*s}class Se{constructor(e,t){t=t||{},this.skillConfigs={},e.forEach((e=>{this.skillConfigs[e["skillType"]]=e})),this.rangeFactor=t.rangeFactor||1,this.energyGp=t.energyGp||0}}class Ae{constructor(e){e&&(this.type=e.type,this.skillType=e.skillType,this.extGrade=null,this.mainAttr=e.mainAttr,this.viceAttr=e.viceAttr,this.teamAttr=e.teamAttr,this.rangeFactor=e.rangeFactor||1,this.energyGp=e.energyGp||0)}calcGrade(){const e={totalGrade:0,mainGp:0,viceGp:0,teamGp:0,extGp:0,otherGp:0};this.extGrade&&(this.extGrade.fixed?(e["extGp"]=Number(this.extGrade.fixed),e["totalGrade"]=Number(this.extGrade.fixed),e["extDesc"]=this.extGrade.desc):this.extGrade.add&&(e["extGp"]=Number(this.extGrade.add),e["totalGrade"]=Number(this.extGrade.add),e["extDesc"]=this.extGrade.desc)),this.mainAttr.isEmpty()||(e["mainGrade"]=te(this.mainAttr),e["mainGp"]=e["mainGrade"].calcTotalGradePoint().final,e["totalGrade"]+=e["mainGp"]),this.viceAttr.isEmpty()||(e["viceGrade"]=te(this.viceAttr),e["viceGp"]=e["viceGrade"].calcTotalGradePoint().final,e["totalGrade"]+=e["viceGp"]),this.teamAttr.isEmpty()||(e["teamGrade"]=te(this.teamAttr,this.rangeFactor),e["teamGp"]=e["teamGrade"].calcTotalGradePoint().final,e["totalGrade"]+=e["teamGp"]),this.energyGp>0&&(e["otherGp"]+=this.energyGp,e["totalGrade"]+=this.energyGp);const t=()=>{let t="",a="",s=[];const l=(e,t)=>{t=Number(t),0!=t&&s.push([e,t.toFixed(2)])};return"光环"===this.type?(a="单体",l("单体分值",e.mainGp),l("光环分值",e.teamGp),t+="光环，"):"防功"===this.type?(l("特技分值",e.mainGp),l("装备分值",e.viceGp),a="特技",t+="防功，"):(a="单体",l("单体分值",e.mainGp)),l("额外分值",e.extGp),l("其他分值",e.otherGp),s.length>1?t+=`综合分值：${e.totalGrade.toFixed(2)}，[${s.map((e=>`${e[0]}：${e[1]}`)).join("，")}]\n`:1==s.length&&(t+=`${s.map((e=>`${e[0]}：${e[1]}`)).join("，")}\n`),e["mainGrade"]&&(t+="==========================================\n",t+=e["mainGrade"].toString(a)+"\n",t+="------------------------\n",t+=e["mainGrade"].detail()),e["viceGrade"]&&(t+="==========================================\n",t+=e["viceGrade"].toString("装备")+"\n",t+="------------------------\n",t+=e["viceGrade"].detail()),e["teamGrade"]&&(t+="==========================================\n",t+=e["teamGrade"].toString("光环")+"\n",t+="------------------------\n",t+=e["teamGrade"].detail()),e["extGp"]&&(t+="==========================================\n",t+=`额外分值：${e["extGp"].toFixed(2)}，${e["extDesc"]}\n`),e["otherGp"]&&(t+="==========================================\n",t+=`其他分值：特技气格折算${e["otherGp"].toFixed(2)}\n`),t};return e["detail"]=t,e}}function we(e,t){t=t||{};const a=new X,s=new X,l=new X;let n="";if(t.defFlag)n="防功",t.useFlag?(e.skillConfigs["状态"]&&Ce(e.skillConfigs["状态"],a,"normal",t),e.skillConfigs["团队状态"]&&(Ce(e.skillConfigs["团队状态"],a,"normal",t),Ce(e.skillConfigs["团队状态"],l,"normal",t))):e.skillConfigs["装备技"]&&Ce(e.skillConfigs["装备技"],s,"normal",t);else if(0===Object.values(e.skillConfigs).length);else if(1===Object.values(e.skillConfigs).length)Object.entries(e.skillConfigs).forEach((([e,s])=>{Ce(s,a,"normal",t),"团队天赋"==e?(n="光环",Ce(s,l,"team_talent",t)):"团队状态"==e&&(n="光环",Ce(s,l,"normal",t))}));else{if(2!==Object.values(e.skillConfigs).length)throw new Error("技能配置数量异常");e.skillConfigs["装备技"]&&e.skillConfigs["状态"]?(n="防功",t.useFlag?Ce(e.skillConfigs["状态"],a,"normal",t):Ce(e.skillConfigs["装备技"],s,"normal",t)):e.skillConfigs["团队天赋"]&&e.skillConfigs["团队状态"]?(n="光环",Ce(e.skillConfigs["团队天赋"],a,"normal",t),Ce(e.skillConfigs["团队天赋"],l,"team_talent",t),Ce(e.skillConfigs["团队状态"],l,"team_buff",t)):console.log("技能配置数量异常",e)}return new Ae({type:n,skillType:t.skillType,mainAttr:a,viceAttr:s,teamAttr:l,rangeFactor:e.rangeFactor,energyGp:e.energyGp})}function Ce(e,t,a,s){const l=(e,a)=>{a>0&&(s.upFlag&&(a*=2),t.setValue(e,a))},n=(e,a)=>{a>0&&(a*=.01,s.upFlag&&(a*=2),t.setValue(e,a))},r=(e,a)=>{a>0&&(a*=.01,s.upFlag&&(a=2*a-1),t.setValue(e,a))},i=(e,a,l)=>{e&&l>0&&(l*=.01,s.upFlag&&(l*=2),t.setClassValue(e,a,l))},o=(e,a,l)=>{e&&l>0&&(l*=.01,s.upFlag&&(l=2*l-1),t.setClassValue(e,a,l))};if("normal"!=a&&"team_talent"!=a||(r("裸攻",e["bodyAtk"]),r("裸防",e["bodyDef"]),r("裸轻",e["bodyAgi"]),r("场攻",e["battleAtk"]),r("场防",e["battleDef"]),r("场轻",e["battleAgi"]),r("时序",e["battleAsp"]),r("敌攻",e["enemyAtk"]),r("敌防",e["enemyDef"]),r("敌轻",e["enemyAgi"]),r("敌时",e["enemyAsp"]),n("双击",e["doubleHit"]),n("暴击",e["critical"]),l("移动",e["moveDistance"]),l("射程",e["attackDistance"]),l("范围",e["attackRange"]),n("出招",e["castInc"]),i(e["specCastIncType"],"出招",e["specCastInc"])),("normal"==a||"team_buff"==a)&&(r("命中",e["hitInc"]),r("闪避",e["hitDec"]),r("威力",e["powerInc"]),r("减威",e["powerDec"]),r("伤害",e["damageInc"]),r("减伤",e["damageDec"]),o(e["specHitIncType"],"命中",e["specHitInc"]),o(e["specHitDecType"],"闪避",e["specHitDec"]),o(e["specPowerIncType"],"威力",e["specPowerInc"]),o(e["specPowerDecType"],"减威",e["specPowerDec"]),o(e["specDamageIncType"],"伤害",e["specDamageInc"]),o(e["specDamageDecType"],"减伤",e["specDamageDec"]),r("加受伤",e["injuryInc"]),e["injuryDec"]>0&&e["injuryDec"]<=50&&s.upFlag?t.addImmune("受伤"):r("减受伤",e["injuryDec"]),n("吸血",e["bloodSuck"]),n("反弹",e["damageCounter"]),n("挪移",e["damageTransfer"]),n("反震",e["damageReflect"]),e["deBuffImmune"]&&""!=e["deBuffImmune"].trim()&&e["deBuffImmune"].split(" ").map((e=>e.trim())).forEach((e=>t.addImmune(e))),e["deBuffMake"]&&""!=e["deBuffMake"].trim())){let a=e["deBuffRate"];s.upFlag&&(a*=2);const l=e["deBuffRound"];e["deBuffMake"].split(" ").map((e=>e.trim())).forEach((e=>t.addDeBuffMake(e,a,l)))}const c=e["ext"];c&&(c["values"]&&c["values"].forEach((e=>{const a=Q[e["attr"]],l=e["condition"],n=e["rate"];if(a){let r=Number(e["value"]);s.upFlag&&(a.hasCalcFlag("pct")?r=2*r-1:r*=2),!a.hasCalcFlag("cmn")||l||n?t.setExtValue(e["attr"],r,n?Number(n):1,l):t.setValue(e["attr"],r)}})),c["classValues"]&&c["classValues"].forEach((e=>{const a=Q[e["attr"]],l=e["type"];if(a){let n=Number(e["value"]);s.upFlag&&(a.hasCalcFlag("pct")?n=2*n-1:n*=2),t.setClassValue(l,e["attr"],n)}})),c["flags"]&&c["flags"].forEach((e=>{const a=Q[e];a&&t.setExtValue(e,1)})),c["debuffs"]&&c["debuffs"].forEach((e=>{let a=e["rate"];s.upFlag&&(a*=2),t.addDeBuffMake(e["attr"],100*a,"击退"==e["attr"]?100*e["value"]:e["value"])})),c["immunes"]&&c["immunes"].forEach((e=>{t.addImmune(e)})))}function Ze(e){if(0==e)return 3;const t=2*e+1;return(t*t-1)/800}function Ie(e,t){return t&&Math.max(.2*(7-e),0),Math.max(.2*(5-e),0)}function Ee(e){let t=[];return e.values&&e.values.forEach((({attr:e,value:a})=>{const s=Q[e];s?(e=s.name||e,t.push(s.print(e,a))):(t.push(`${e}:${a}`),console.log(`未知属性:${e}`))})),e.debuffs&&e.debuffs.forEach((({attr:e,value:a,rate:s})=>{const l=Q[e];l?(e=l.name||e,t.push(l.print(e,a,s))):(t.push(`${e}:${a}, ${s}`),console.log(`未知属性:${e}`))})),e.immunes&&t.push(`免疫${e.immunes.join("/")}`),e.flags&&e.flags.forEach((e=>{t.push(e)})),t.join("，")}const Pe=e=>(t,a)=>(e=e||{},`${e.prefix||""}${t}${e.suffix||""}${e.symbol}${(100*a).toFixed(0)}%`),Fe=e=>(t,a)=>(e=e||{},`${e.prefix||""}${t}${e.suffix||""}+${a.toFixed(0)}`),Oe={"拳掌":"拳系","御剑":"剑系","兵器":"兵系","指腿":"特系","暗毒":"暗系"};function Te(e){const t=[];let a="";const s=(e,s)=>{e&&""!=e&&(s&&a!==s?(t.push(`${s}${e}`),a=s):t.push(e))};if(""==e.type){const a=Be(e.mainAttr);t.push(a.join("，"))}else if("防功"==e.type){const a=Be(e.mainAttr),s=Be(e.viceAttr);t.push(a.join("，")),t.push(`[装备效果]${s.join("，")}`)}else if("光环"==e.type){const t=Be(e.mainAttr,{type:"attr"}),a=Be(e.mainAttr,{type:"enemyAttr"}),l=Be(e.mainAttr,{type:"feature"}),n=Be(e.mainAttr,{type:"effect"}),r=Be(e.teamAttr,{type:"effect"});t.length>0&&s(t.join("，"),"本方"),l.length>0&&s(l.join("，"),"本方"),"天赋"==e.skillType?(n.length>0&&s(n.join("，"),"自身"),r.length>0&&s(r.join("，"),"队友"),a.length>0&&s(a.join("，"),"敌方")):(n.length>0&&s(n.join("，"),"本方"),a.length>0&&s(a.join("，"),"敌方"))}return t.join("，")}function Be(e,t){t=t||{};const a=t.type||"",s=[],l=t=>{const a=t(e);a&&s.push(...a)};return""!=a&&"attr"!=a||(l(De),l(Ve)),"enemyAttr"==a&&l(je),""!=a&&"effect"!=a||(l(Ke),l(Ge),l(Re),l(qe)),""==a?(l(Ne),l(Me),l(Ue)):("feature"==a&&(l(He),l(Me),l(Ue)),"effect"==a&&l(Qe)),""!=a&&"effect"!=a||(l(Ye),l(Xe)),s}function Ve(e){const t=[];return We(t,"攻击",e.getValue("裸攻")),We(t,"防御",e.getValue("裸防")),We(t,"轻功",e.getValue("裸轻")),Je(t,Pe({symbol:"*",prefix:"基础"}))}function De(e){const t=[];return We(t,"攻击",e.getValue("场攻")),We(t,"防御",e.getValue("场防")),We(t,"轻功",e.getValue("场轻")),We(t,"时序",e.getValue("时序")),Je(t,Pe({symbol:"*",prefix:"战场"}))}function je(e){const t=[];return We(t,"攻击",e.getValue("敌攻")),We(t,"防御",e.getValue("敌防")),We(t,"轻功",e.getValue("敌轻")),We(t,"时序",e.getValue("敌时")),Je(t,Pe({symbol:"*",prefix:""}),{asc:!0})}function Ke(e){const t=[];return We(t,"威力",e.getValue("威力")),We(t,"命中",e.getValue("命中")),We(t,"伤害",e.getValue("伤害")),We(t,"受伤度",e.getValue("加受伤")),Je(t,Pe({symbol:"*",prefix:"武功"}))}function Ge(e){const t=[];return B.classes.forEach((a=>{const s=[];We(s,"威力",e.getClassValue(a,"威力")),We(s,"命中",e.getClassValue(a,"命中")),We(s,"伤害",e.getClassValue(a,"伤害")),t.push(...Je(s,Pe({symbol:"*",prefix:`${Oe[a]}武功`})))})),t}function Re(e){const t=[];return We(t,"威力",e.getValue("减威")),We(t,"命中",e.getValue("闪避")),We(t,"伤害",e.getValue("减伤")),We(t,"受伤度",e.getValue("减受伤")),Je(t,Pe({symbol:"*",prefix:"被攻击"}),{asc:!0})}function qe(e){const t=[];return B.classes.forEach((a=>{const s=[];We(s,"威力",e.getClassValue(a,"减威")),We(s,"命中",e.getClassValue(a,"闪避")),We(s,"伤害",e.getClassValue(a,"减伤")),t.push(...Je(s,Pe({symbol:"*",prefix:`被${Oe[a]}攻击`}),{asc:!0}))})),t}function Me(e){const t=[];return B.classes.forEach((a=>{We(t,`${Oe[a]}出招`,e.getClassValue(a,"出招"))})),ze(t,Pe({symbol:"+"}))}function Ne(e){const t=[];return We(t,"暴击",e.getValue("暴击")),We(t,"双击",e.getValue("双击")),We(t,"出招",e.getValue("出招")),We(t,"吸血",e.getValue("吸血")),We(t,"反震",e.getValue("反震")),We(t,"反弹",e.getValue("反弹")),We(t,"挪移",e.getValue("挪移")),Je(t,Pe({symbol:"+"}))}function He(e){const t=[];return We(t,"暴击",e.getValue("暴击")),We(t,"双击",e.getValue("双击")),We(t,"出招",e.getValue("出招")),Je(t,Pe({symbol:"+"}))}function Ue(e){const t=[];return We(t,"移动距离",e.getValue("移动")),We(t,"武功移动",e.getValue("射程")),We(t,"杀伤范围",e.getValue("范围")),Je(t,Fe())}function Qe(e){const t=[];return We(t,"吸血",e.getValue("吸血")),We(t,"反震",e.getValue("反震")),We(t,"反弹",e.getValue("反弹")),We(t,"挪移",e.getValue("挪移")),Je(t,Pe({symbol:"+"}))}function Ye(e){const t=[];B.debuffTags.forEach((a=>{e.deBuffMakes[a]&&e.deBuffMakes[a].forEach((e=>{t.push([a,e.rate,e.round])}))})),e.deBuffMakes["随机"]&&e.deBuffMakes["随机"].forEach((e=>{t.push(["随机不利状态",e.rate,e.round])})),t.sort(((e,t)=>e[2]!=t[2]?t[2]-e[2]:t[1]-e[1]));const a=[];let[s,l]=[0,1];while(s<t.length){if(l>=t.length||t[l][2]!=t[s][2]||t[l][1]!=t[s][1]){const e=t.slice(s,l).map((e=>e[0])).join("/");a.push(`攻击造成${e}${t[s][2]}回合+${t[s][1].toFixed(0)}%`),s=l}l++}return a}function Xe(e){if(0==Object.values(e.immunes).length)return[];const t=[];e.immunes["全部"]&&t.push("持续不利状态"),B.immuneTags.forEach((a=>{e.immunes[a]&&t.push(a)}));const a=t.join("/");return[`免疫${a}`]}function We(e,t,a){0!=a&&e.push({name:t,value:a})}function ze(e,t){const a=[];return e.forEach((e=>{a.push(t(e.name,e.value))})),a}function Je(e,t,a){a=a||{};const s=a.asc||!1;e.sort(((e,t)=>s?e.value-t.value:t.value-e.value));const l=[];let[n,r]=[0,1];while(n<e.length){if(r>=e.length||e[r].value!=e[n].value){const a=e.slice(n,r).map((e=>e.name)).join("/");l.push(t(a,e[n].value)),n=r}r++}return l}function et(e,t){return t.has(e)?t.get(e):e}function tt(e){return e>0?"是":""}const at=new Map([[0,"男"],[1,"女"],[2,"妖"],[3,"非男"],[-1,""]]);function st(e){return et(e,at)}function lt(e,t){return-1==e||(3==e?"女"==t||"妖"==t:st(e)==t)}const nt=new Map([[1,"慕容世家"],[2,"大理段氏"],[3,"黄金家族"],[4,"天波杨府"],[6,"爱新觉罗"],[7,"凤阳朱氏"],[0,""],[-1,""]]);function rt(e){return et(e,nt)}const it=new Map([[1,"峨眉派"],[2,"武当派"],[3,"逍遥派"],[4,"丐帮"],[5,"桃花岛"],[6,"日月教"],[7,"华山派"],[8,"明教"],[9,"古墓派"],[0,""],[-1,""]]);function ot(e){return et(e,it)}const ct=new Map([[-1,""],[0,"武器"],[1,"防具"],[2,"骑宠"]]);function ut(e){return et(e,ct)}const dt=new Map([[0,"阴"],[1,"阳"],[2,"调和"]]);function ft(e){return et(e,dt)}function ht(e){return-1==e||2==e?"":et(e,dt)}function mt(e){return 2==e?"调和":0==e||-1==e?"":e}function pt(e){return 0==e?"":1==e?"左右互搏":2==e?"双手":e}const gt=new Map([[1,"内伤"],[2,"虚弱"],[3,"盲目"],[4,"外伤"],[5,"剧毒"],[6,"厌食"],[7,"定身"],[8,"点穴"],[9,"封气"],[10,"冰封"],[11,"封招"],[100,"随机"]]);function bt(e){return 0==e?"":100==e?"解除全部":e<0?"造成"+et(-e,gt):"解除"+et(e,gt)}const vt=new Map([[0,"剧情"],[1,"装备"],[2,"秘籍"],[3,"药品"],[4,"暗器"]]);function _t(e){return et(e,vt)}const kt=new Map([[0,"暗毒"],[1,"拳掌"],[2,"御剑"],[3,"兵器"],[4,"指腿"],[5,"内功"],[6,"轻功"],[7,"天赋"],[8,"特技"],[10,"称号"]]);function yt(e){return et(e,kt)}const $t=new Map([[0,""],[1,"1级"],[2,"2级"],[3,"3级"],[4,"4级"],[5,"5级"],[6,"特殊"],[7,"防功"]]);function Lt(e){return et(e,$t)}const xt=new Map([[0,"伤害"],[1,"杀伤内力"],[2,"治疗"],[3,"恢复内力"]]);function St(e){return et(e,xt)}const At=new Map([[0,"点"],[1,"线"],[2,"十"],[3,"面"],[4,"菱"],[5,"全"],[6,"自"],[7,"田"],[8,"井"],[9,"米"],[10,"角"],[11,"楔"],[12,"卐"]]);function wt(e){return et(e,At)}function Ct(e,t){const a=t(e);return a?`[${a["id"]}]${a["name"]}`:e}function Zt(e){return-1==e?"":Ct(e,c)}function It(e){return-1==e||0==e?"":Ct(e,u)}function Et(e){return-1==e||0==e?"":Ct(e,f)}function Pt(e){switch(e){case 6:return 50;case 7:return 60;case 8:return 70;case 9:return 80;default:return 0}}var Ft={getSkillAttrGroup(e,t={}){const a=u(e);if(null==a)return{totalGrade:0,desc:""};const s=yt(a["type"]),l=_(e)||[];let n=1;a["ext_range"]?"双人"===a["ext_range"]&&(n=.5):n=Ze(a["attr_selfRange"]);const r=8==a["type"]?Ie(a["attr_costEng"],n>0):0,i=new Se(l,{rangeFactor:n,energyGp:r,skillId:e}),o=we(i,{...t,skillType:s,skillId:e});return o},calcSkillGrade(e,t={}){const a=u(e),s=this.getSkillAttrGroup(e,t);a["ext_grade"]&&(s["extGrade"]=a["ext_grade"]);const l=s.calcGrade();return l["desc"]=Te(s),l},getTitleAttrGroup(e){let t=[];e["ext_attrs"]&&(t=e["ext_attrs"].map((t=>({name:e["name"],skillId:e["skillId"],skillType:10,ext:t}))));const a=new Se(t,{rangeFactor:1,energyGp:0,skillId:e["skillId"]}),s=we(a,{skillType:10,skillId:e["skillId"]});return s},calcTitleGrade(e){if(null==e)return{totalGrade:0,desc:""};const t=this.getTitleAttrGroup(e);e["ext_grade"]&&(t["extGrade"]=e["ext_grade"]);const a=t.calcGrade();return a["desc"]=Te(t),a},fmtSkillExtAttr:Ee};function Ot(){Object.entries(ds.state.SkillExtConfigSource).forEach((([e,t])=>{const a=u(e),s=_(e)||[];t["range"]&&(a["ext_range"]=t["range"]),t["grade"]&&(a["ext_grade"]=t["grade"]),t["attrs"]&&(a["ext_attr"]=t["attrs"],t["attrs"].forEach((t=>{const a=s.find((e=>e["skillType"]===t["type"]));if(a)a["ext"]=t;else{const a=u(e),s={name:a["name"],skillId:e,skillType:t["type"],ext:t};ds.state.SkillConfigSource.push(s),ds.state.Indexes.SkillConfigIndex[e]?ds.state.Indexes.SkillConfigIndex[e].push(s):ds.state.Indexes.SkillConfigIndex[e]=[s]}})))})),Object.entries(ds.state.TitleExtConfigSource).forEach((([e,t])=>{const a=g(e);t["range"]&&(a["ext_range"]=t["range"]),t["grade"]&&(a["ext_grade"]=t["grade"]),t["attrs"]&&(a["ext_attrs"]=t["attrs"]);const s=Ft.calcTitleGrade(a);a["grade"]=Number(s.totalGrade.toFixed(2)),a["grade_ext"]=()=>`${a["name"]}分值计算\n`+s.detail(),a["gen_desc"]=s["desc"]}))}function Tt(){Object.entries(ds.state.ItemSource).forEach((([,e])=>{if(e.targetSkill>0){const t=u(e.targetSkill);if(t)switch(t.type){case 0:t["level"]=e.attr_ts;break;case 1:t["level"]=e.attr_fs;break;case 2:t["level"]=e.attr_ss;break;case 3:t["level"]=e.attr_ws;break;case 4:t["level"]=e.attr_rs;break}}}))}function Bt(){Object.values(ds.state.TitleConfigSource).forEach((e=>{e["id"]=e["skillId"],e["type"]=10}))}function Vt(){Object.values(ds.state.SkillSource).forEach((e=>{const t=5==e.type&&7==e.levelType,a=Ft.calcSkillGrade(e.id,{defFlag:t});if(e["grade"]=a.totalGrade.toFixed(2),e["grade_ext"]=()=>`${e["name"]}分值计算\n`+a.detail(),e["gen_desc"]=a["desc"],5==e.type&&(4==e.levelType||5==e.levelType)){const t=Ft.calcSkillGrade(e.id,{upFlag:!0});e["grade_up"]=t.totalGrade.toFixed(2),e["grade_up_ext"]=()=>`${e["name"]}护体分值计算\n`+t.detail(),e["grade_mean"]=((t.totalGrade+a.totalGrade)/2).toFixed(2)}if(t){const t=Ft.calcSkillGrade(e.id,{useFlag:!0,defFlag:!0});e["grade_up"]=t.totalGrade.toFixed(2),e["grade_up_ext"]=()=>`${e["name"]}防功使用分值计算\n`+t.detail()}let s={};t&&(s.defFlag=t,s.useFlag=!0);const l=Ft.getSkillAttrGroup(e.id,s);e["attr_group"]=l}))}function Dt(){Object.values(ds.state.HeroSource).forEach((e=>{const t=p(e["equip_wp"],e["equip_ar"],e["equip_pt"]);t&&(e["suit"]=t.name,e["suit_bs"]=t.bsId,e["suit_fs"]=t.fsId,e["suit_talent"]=t.talentId),e["grade_total"]=0;const a=(t,a,s,l)=>{if(e[t]=e[t]||0,e[`${t}_detail`]=e[`${t}_detail`]||[],!a)return;let n;isNaN(a)?(n=Number(a.grade)||0,l=`${a.name}(${l})`):n=a,e[t]+=n*s,e[`${t}_detail`].push({grade:n,factor:s,desc:l})};a("grade_talent",u(e["talent"]),1,"天赋"),a("grade_ke",u(e["talent"]),1,"天赋"),a("grade_ke_talent",u(e["talent"]),1,"天赋"),a("grade_talent",u(e["suit_talent"]),1,"套装天赋"),a("grade_total",e["grade_talent"],1,"天赋"),a("grade_bs",u(e["equip_bs"]),1,"内功"),a("grade_bs",u(e["suit_bs"]),1,"套装内功"),a("grade_total",e["grade_bs"],1,"内功"),a("grade_fs",u(e["equip_fs"]),1,"轻功"),a("grade_fs",u(e["suit_fs"]),1,"套装轻功"),a("grade_total",e["grade_fs"],1,"轻功"),e["grade_ss"]=0;const s=[];for(let c=0;c<10;c++){const t=e["skills"][c];t["skill"]&&s.push({id:t["skill"],desc:`第${c+1}格`})}if(e["equip_wp"]>0){const t=f(e["equip_wp"]);t["useSkill"]>0&&(s.find((e=>e.id==t["useSkill"]))||s.push({id:t["useSkill"],desc:"武器"}))}const l=[];for(let c of s){const e=u(c.id);e&&8==e["type"]?l.push({grade:Number(e.grade)||0,desc:`${e["name"]}(${c.desc})`}):5==e["type"]&&7==e["levelType"]&&l.push({grade:Number(e.grade_up)||0,desc:`${e["name"]}(${c.desc})`})}const n=[];for(let c of s){const e=u(c.id);if(e&&e["trigger"]){let t=0,a=[];e["trigger"].forEach((e=>{const s=u(e);8==s["type"]?(t+=Number(s.grade)||0,a.push({grade:Number(s.grade)||0,desc:`${s["name"]}`})):5==s["type"]&&7==s["levelType"]&&(t+=Number(s.grade_up)||0,a.push({grade:Number(s.grade_up)||0,desc:`${s["name"]}`}))})),n.push({grade:t,desc:`${e["name"]}(${c.desc}) `,details:a})}}l.sort(((e,t)=>t.grade-e.grade)),e["grade_ss"]=0;for(let c=0;c<l.length;c++)0==c?(a("grade_ss",l[c].grade,.8,l[c].desc),l[c].grade>10&&l[c].grade<=15?(a("grade_ke",10,1,l[c].desc),a("grade_ke_ss",10,1,l[c].desc)):(a("grade_ke",l[c].grade,1,l[c].desc),a("grade_ke_ss",l[c].grade,1,l[c].desc))):1==c?a("grade_ss",l[c].grade,.4,l[c].desc):2==c&&a("grade_ss",l[c].grade,.2,l[c].desc);a("grade_total",e["grade_ss"],1,"特技"),n.sort(((e,t)=>t.grade-e.grade)),e["grade_ts"]=0;const r={0:.4,1:.2,2:.1};let i=!1;for(let c=0;c<n.length;c++){const e=r[c]||0;e>0&&n[c].details.forEach((t=>{a("grade_ts",t.grade,e,`${n[c].desc} 触发 ${t.desc}`),!i&&n[c].desc.indexOf("武器")<0&&(i=!0,a("grade_ke",t.grade,.5,`${n[c].desc} 触发 ${t.desc}`),a("grade_ke_ts",t.grade,.5,`${n[c].desc} 触发 ${t.desc}`))}))}a("grade_total",e["grade_ts"],1,"触发特技");const o=g(e["title"]);o&&o["grade"]>0&&(a("grade_title",Number(o["grade"]),1,o["name"]),a("grade_ke",Number(o["grade"]),1,`${o["name"]}(称号)`),a("grade_ke_title",Number(o["grade"]),1,o["name"])),2==e["attr_atkCnt"]&&a("grade_ke",1,1,"两次攻击"),e["roleRound"]<4&&2==e["mpKind"]&&a("grade_ke",1,1,"内力调和"),a("grade_total",e["grade_title"],1,"称号")}))}function jt(){ds.state.Indexes.SkillIndex={},Object.values(ds.state.SkillSource).forEach((e=>{ds.state.Indexes.SkillIndex[e.id]={}})),Object.values(ds.state.SkillSource).forEach((e=>{Gt(e)})),Object.values(ds.state.HeroSource).forEach((e=>{Rt(e)})),ds.state.EventSource.xw.forEach((e=>{qt(e)})),Object.values(ds.state.SkillSource).forEach((e=>{if(e["type"]>=5){const t=ds.state.Indexes.SkillIndex[e.id],a=(t["owner_friend"]||[]).length,s=(t["owner_npc"]||[]).length;0==a&&0==s&&(e["ke"]=1)}})),ds.state.ListSource.match1.forEach((e=>{const t=ds.state.Indexes.SkillIndex[e["matchSkillId"]];t["match"]=t["match"]||[],t["match"].push(`[${e["itemId"]}]${f(e["itemId"]).name}+${e["power"]}`);const a=ds.state.Indexes.MatchIndex[e["matchSkillId"]]||[];a.push({type:"item",...e}),ds.state.Indexes.MatchIndex[e["matchSkillId"]]=a})),ds.state.ListSource.match2.forEach((e=>{const t=ds.state.Indexes.SkillIndex[e["matchSkillId"]];t["match"]=t["match"]||[],t["match"].push(`[${e["skillId"]}]${u(e["skillId"]).name}+${e["power"]}`);const a=ds.state.Indexes.MatchIndex[e["matchSkillId"]]||[];a.push({type:"skill",...e}),ds.state.Indexes.MatchIndex[e["matchSkillId"]]=a})),Object.values(ds.state.SkillSource).forEach((e=>{if(e["trigBy"]&&e["trigBy"]>0){const t=ds.state.Indexes.SkillIndex[e["trigBy"]];t["trigger"]=t["trigger"]||[];const a=e["attr_trig"]?e["attr_trig"]:0;let s=`${a}% [${e.id}]${e.name}`;e["attrl_power"]>0&&(s+=` (${e["attrl_power"]})`),8==e["type"]?s+="(特技)":5==e["type"]&&(s+="(防功)"),t["trigger"].push(s);const l=u(e["trigBy"]);l["trigger"]=l["trigger"]||[],l["trigger"].push(e["id"]),8==e["type"]&&(l["trigger_effect"]=l["trigger_effect"]||[],l["trigger_effect"].push(e["id"]))}}))}function Kt(e,t,a){if(a=a||{},!t||t<=0)return;const s=a.title?ds.state.Indexes.TitleIndex[t]:ds.state.Indexes.SkillIndex[t];if(!s)return;const l=a.suffix?`[${e.id}]${e.name}(${a.suffix})`:`[${e.id}]${e.name}`;e["friend"]?(s["owner_friend"]=s["owner_friend"]||[],s["owner_friend"].includes(l)||s["owner_friend"].push(l)):(s["owner_npc"]=s["owner_npc"]||[],s["owner_npc"].includes(l)||s["owner_npc"].push(l))}function Gt(e){const t=ds.state.Indexes.SkillConfigIndex[e.id]||[];for(const a of t)Number(a["round"])>0&&(e["config_round"]=a["round"]),a["skillType"].includes("团队")&&(e["config_aura"]="是")}function Rt(e){const t=(t,a)=>{Kt(e,t,a)};t(e["equip_bs"]),t(e["equip_fs"]),t(e["talent"]),t(e["title"],{title:!0});const a=p(e["equip_wp"],e["equip_ar"],e["equip_pt"]);if(a&&(t(a.bsId,{suffix:"套装"}),t(a.fsId,{suffix:"套装"}),t(a.talentId,{suffix:"套装"})),e["equip_wp"]>0){const a=f(e["equip_wp"]);a["useSkill"]>0&&t(a["useSkill"],{suffix:"武器"})}e["skills"].forEach((a=>{const s=a["skill"];if(s<=0)return;const l=u(s);5==l.type||6==l.type?7==l.levelType&&t(s,{suffix:"防功"}):e["mastery"]==s?t(s,{suffix:"专精"}):t(s)}))}function qt(e){const t=e["index"],a=e["index2"],s=e["value"],l=c(t),n=e["op"];"洗武功"==n?Kt(l,a,{suffix:`洗${s+1}格`}):"洗天赋"==n?Kt(l,a,{suffix:"洗天赋"}):"洗专精"==n&&Kt(l,a,{suffix:"洗专精"})}function Mt(){Object.values(ds.state.HeroSource).forEach((e=>{for(let t=0;t<4;t++){const a=e["items"][t];if(a["item"]&&a["item"]>0){const t=f(a["item"]);e["friend"]?(t["owner_friend"]=t["owner_friend"]||[],t["owner_friend"].push(`[${e.id}]${e.name}`)):(t["owner_npc"]=t["owner_npc"]||[],t["owner_npc"].push(`[${e.id}]${e.name}`))}}})),Object.values(ds.state.ItemSource).forEach((e=>{Nt(e)}))}function Nt(e){if(2!=e["type"])return;e["tags"]=e["tags"]||[];const t=e=>-1!=e;if((t(e["req_hero1"])||t(e["req_hero2"])||t(e["req_gender"])||t(e["req_party"])||t(e["req_family"]))&&e["tags"].push("限定"),e.targetSkill&&e.targetSkill>0){const t=[e["attr_fs"],e["attr_ss"],e["attr_ws"],e["attr_rs"],e["attr_ts"]],[a,s]=t.reduce(((e,t)=>(e[0]+=t,t>e[1]&&(e[1]=t),e)),[0,0]),l=u(e.targetSkill);switch(l.type){case 0:e["level"]=e["attr_ts"],e["bookType"]="暗毒";break;case 1:e["level"]=e["attr_fs"],e["bookType"]="拳掌";break;case 2:e["level"]=e["attr_ss"],e["bookType"]="御剑";break;case 3:e["level"]=e["attr_ws"],e["bookType"]="兵器";break;case 4:e["level"]=e["attr_rs"],e["bookType"]="指腿";break;case 5:e["level"]=l["levelType"],e["bookType"]="内功";break;case 6:e["level"]=l["levelType"],e["bookType"]="轻功";break;default:e["bookType"]="特殊";break}if(l.type>=0&&l.type<=4){e["req_poiMk"]>0&&e["tags"].push("用毒"),a!=s&&e["tags"].push("双系");const t=Pt(e["level"]);t>0&&t!=e["req_itl"]&&(e["req_itl"]>t?e["tags"].push("高资"):e["tags"].includes("用毒")||e["tags"].includes("限定")||e["tags"].push("低资"))}}else{const t=[e["attr_fs"],e["attr_ss"],e["attr_ws"],e["attr_rs"],e["attr_ts"]];t.reduce(((e,t)=>e+t),0)>0&&(e["bookType"]="特殊")}}function Ht(){Object.values(ds.state.HeroSource).forEach((e=>{Ut(e)})),Object.values(ds.state.SuitSource).forEach((e=>{Qt(e)}))}function Ut(e){const t=p(e["equip_wp"],e["equip_ar"],e["equip_pt"]);t&&(e["friend"]?(t["owner_friend"]=t["owner_friend"]||[],t["owner_friend"].push(`[${e.id}]${e.name}`)):(t["owner_npc"]=t["owner_npc"]||[],t["owner_npc"].push(`[${e.id}]${e.name}`)))}function Qt(e){let t=!1,a=[e["weaponId"],e["armorId"],e["petId"]];for(const l of a){if(null==l)continue;const e=f(l);(e["ke"]||e["req_hero1"]>0&&c(e["req_hero1"]).ke)&&(t=!0)}a.forEach((a=>{if(a>0){const s=f(a);s&&(t?(s["owner_suit_ke"]=s["owner_suit_ke"]||[],s["owner_suit_ke"].push(`${e.name}`)):(s["owner_suit_nk"]=s["owner_suit_nk"]||[],s["owner_suit_nk"].push(`${e.name}`)))}}));let s=[e["talentId"],e["bsId"],e["fsId"]];s.forEach((a=>{if(a>0){const s=ds.state.Indexes.SkillIndex[a];s&&(t?(s["owner_suit_ke"]=s["owner_suit_ke"]||[],s["owner_suit_ke"].push(`${e.name}`)):(s["owner_suit_nk"]=s["owner_suit_nk"]||[],s["owner_suit_nk"].push(`${e.name}`)))}}))}const Yt=[173,187,188,189,574,1490,506,572,945,602,1441],Xt=[4];function Wt(){Yt.forEach((e=>{const t=u(e);t&&(t["ke"]=1)})),Xt.forEach((e=>{const t=u(e);t&&(t["ke"]=0)}))}function zt(){Object.values(ds.state.BattleSource).forEach((e=>{sa(e)})),na()}const Jt=[270,72,1,518,430,109],ea=[699,837,839,840,940],ta=[14,15,16,17,20,27,673,838,881,882,883,884,885,886,893,894,895,1014],aa=[19,28,29,30,108,128,134,136,659];function sa(e){let t={},a={},s={},l={},n={},r={};const i=(e,t)=>{const a=u(e);a&&"是"==a["config_aura"]&&(t[e]=t[e]||0,t[e]++)},o=(e,t,a)=>{a[e]=a[e]||[],a[e].push(t)};e["enemies"].forEach((e=>{const u=c(e);u["talent"]>0&&i(u["talent"],t),u["suit_talent"]&&u["suit_talent"]>0&&i(u["suit_talent"],t);for(let t=0;t<5;t++){const e=u["skills"][t]["skill"];e>0&&i(e,a)}u["title"]>0&&Jt.includes(u["title"])&&(s[u["title"]]=s[u["title"]]||0,s[u["title"]]++);for(let t=0;t<4;t++){const a=u["items"][t];a["item"]>0&&(ea.includes(a["item"])?o(a["item"],e,l):ta.includes(a["item"])?o(a["item"],e,n):aa.includes(a["item"])&&o(a["item"],e,r))}}));const d=e=>{const t=u(e);return t?t["grade"]:0};Object.keys(t).length>0&&(e["aura_talent"]=Object.entries(t).sort(((e,t)=>d(t[0])-d(e[0])))),Object.keys(a).length>0&&(e["aura_skill"]=Object.entries(a).sort(((e,t)=>d(t[0])-d(e[0])))),Object.keys(s).length>0&&(e["aura_title"]=Object.entries(s).sort(((e,t)=>d(t[0])-d(e[0])))),Object.keys(l).length>0&&(e["steal_items1"]=Object.entries(l)),Object.keys(n).length>0&&(e["steal_items2"]=Object.entries(n)),Object.keys(r).length>0&&(e["steal_items3"]=Object.entries(r))}const la={star:[707,708,908,914,909,1225,1202],end:[970,441,442,436,1214,649,424,423],war:[124,134,1276,1352,1271,430],ke:[1350,1349,1369,1354]};function na(){Object.entries(la).forEach((([e,t])=>{for(const a of t){const t=x(a);t&&t["enemies"].forEach((a=>{const s=c(a);s["battle_attend_"+e]=s["battle_attend_"+e]||[],s["battle_attend_"+e].push(t["id"])}))}}))}var ra=a(7941);const ia=["全部","受伤","中毒","点穴","封气","定身","封招","厌食","外伤","内伤","剧毒","虚弱","盲目","冰封","暴击","双击","破甲","突防","反击","杀命","杀内","杀体","杀气","秒杀"],oa=["点穴","封气","定身","封招","厌食","外伤","内伤","剧毒","虚弱","盲目","冰封","随机"],ca={"自身攻击":{key:"裸攻",confKey:"bodyAtk",csvKey:"裸攻加成",mul:!0,pct:!0},"自身防御":{key:"裸防",confKey:"bodyDef",csvKey:"裸防加成",mul:!0,pct:!0},"自身轻功":{key:"裸轻",confKey:"bodyAgi",csvKey:"裸轻加成",mul:!0,pct:!0},"战场攻击":{key:"场攻",confKey:"battleAtk",csvKey:"c攻击加成",mul:!0,pct:!0},"战场防御":{key:"场防",confKey:"battleDef",csvKey:"c防御加成",mul:!0,pct:!0},"战场轻功":{key:"场轻",confKey:"battleAgi",csvKey:"c轻功加成",mul:!0,pct:!0},"行动时序":{key:"时序",confKey:"battleAsp",csvKey:"c加行动次序",mul:!0,pct:!0},"敌方攻击":{key:"敌攻",confKey:"enemyAtk",csvKey:"c攻击对敌加成",mul:!0,pct:!0,onlyAura:!0},"敌方防御":{key:"敌防",confKey:"enemyDef",csvKey:"c防御对敌加成",mul:!0,pct:!0,onlyAura:!0},"敌方轻功":{key:"敌轻",confKey:"enemyAgi",csvKey:"c轻功对敌加成",mul:!0,pct:!0,onlyAura:!0},"敌方时序":{key:"敌时",confKey:"enemyAsp",csvKey:"次序对敌加成",mul:!0,pct:!0,onlyAura:!0},"双击":{key:"双击",confKey:"doubleHit",csvKey:"d加双击",pct:!0},"暴击":{key:"暴击",confKey:"critical",csvKey:"d加暴击",pct:!0},"移动距离":{key:"移动",confKey:"moveDistance",csvKey:"加移动格数"},"攻击距离":{key:"射程",confKey:"attackDistance",csvKey:"加攻击移动"},"杀伤范围":{key:"范围",confKey:"attackRange",csvKey:"加杀伤范围"},"命中":{key:"命中",confKey:"hitInc",csvKey:"6命中加成",mul:!0,pct:!0,auraSelf:!0},"主系命中":{key:"命中",confKey:"specHitInc",csvKey:"6专系命中加成",mul:!0,pct:!0,mainClass:!0,auraSelf:!0},"闪避":{key:"闪避",confKey:"hitDec",csvKey:"7命中减成",mul:!0,pct:!0,dec:!0,auraSelf:!0},"主系闪避":{key:"闪避",confKey:"specHitDec",csvKey:"7专系命中减成",mul:!0,pct:!0,dec:!0,mainClass:!0,auraSelf:!0},"威力":{key:"威力",confKey:"powerInc",csvKey:"威力加成",mul:!0,pct:!0,auraSelf:!0},"主系威力":{key:"威力",confKey:"specPowerInc",csvKey:"专系威力加成",mul:!0,pct:!0,mainClass:!0,auraSelf:!0},"减威":{key:"减威",confKey:"powerDec",csvKey:"威力减成",mul:!0,pct:!0,dec:!0,auraSelf:!0},"主系减威":{key:"减威",confKey:"specPowerDec",csvKey:"专系威力减成",mul:!0,pct:!0,dec:!0,mainClass:!0,auraSelf:!0},"伤害":{key:"伤害",confKey:"damageInc",csvKey:"伤害加成",mul:!0,pct:!0,auraSelf:!0},"主系伤害":{key:"伤害",confKey:"specDamageInc",csvKey:"专系伤害加成",mul:!0,pct:!0,mainClass:!0,auraSelf:!0},"减伤":{key:"减伤",confKey:"damageDec",csvKey:"伤害减成",mul:!0,pct:!0,dec:!0,auraSelf:!0},"主系减伤":{key:"减伤",confKey:"specDamageDec",csvKey:"专系伤害减成",mul:!0,pct:!0,dec:!0,mainClass:!0,auraSelf:!0},"出招":{key:"出招",confKey:"castInc",csvKey:"大招触发概率加成",pct:!0},"主系出招":{key:"出招",confKey:"specCastInc",csvKey:"专系大招触发加成概率",pct:!0,mainClass:!0},"加受伤度":{key:"加受伤",confKey:"injuryInc",csvKey:"内伤加成",mul:!0,pct:!0,auraSelf:!0},"减受伤度":{key:"减受伤",confKey:"injuryDec",csvKey:"内伤减成",mul:!0,pct:!0,force:!0,dec:!0,auraSelf:!0},"吸血":{key:"吸血",confKey:"bloodSuck",csvKey:"加攻击吸血",pct:!0,auraSelf:!0},"免疫":{type:"combobox",items:ia,wide:10,auraSelf:!0},"异常":{type:"combobox",items:oa,wide:8,auraSelf:!0},"异常概率":{confKey:"deBuffRate",csvKey:"8造成异常概率",pct:!0,auraSelf:!0},"异常回合":{confKey:"deBuffRound",csvKey:"8造成异常回合",auraSelf:!0},"反弹":{key:"反弹",confKey:"damageCounter",csvKey:"反弹伤害",pct:!0,auraSelf:!0},"挪移":{key:"挪移",confKey:"damageTransfer",csvKey:"转移伤害",pct:!0,auraSelf:!0},"反震":{key:"反震",confKey:"damageReflect",csvKey:"反震伤害",pct:!0,auraSelf:!0},defValue(e){const t=this[e];return t?t.items?[]:t.mul?t.pct?100:1:0:0},upValue(e,t){const a=this[e];return a?a.items?t:a.mul?a.pct?2*t-100:2*t-1:2*t:t}};class ua{constructor(){Object.keys(ca).forEach((e=>{this[e]=ca.defValue(e)}))}toAttrEntry(e){e=e||{};const t=new X,a=e.mode,s=e.teamAttr;if("ignoreAll"==a)return t;let l=this;return"useTeam"==a&&s&&(l=s),Object.entries(l).forEach((([n,r])=>{const i=ca[n];if(e.upflag&&(r=ca.upValue(n,r)),!i)return;"decideTeam"!=a||i.auraSelf||(r=s[n]);const o=ca.defValue(n);if(r!=o)if("减受伤度"===n&&r<=0&&(t.addImmune("受伤"),r=null),"异常"!==n)if("免疫"!==n)if(r=Number(r),i.pct&&(r/=100),i.mainClass){if("无"!=e.classType){const a=e.classType;t.setClassValue(a,i.key,r)}}else t.setValue(i.key,r);else r.forEach((e=>{t.addImmune(e)}));else{const e=l["异常回合"],a=l["异常概率"];e>0&&a>0&&r.forEach((s=>{t.addDeBuffMake(s,Number(a),Number(e))}))}})),t}match(e,t){return"talent"===e?!t.auraSelf:"buff"!==e||t.auraSelf}importConfig(e,t){t=t||{};const a=t.type||"";Object.entries(ca).forEach((([t,s])=>{if(this.match(a,s)&&s.confKey){const a=e[s.confKey];a>0&&(this[t]=a)}})),this.match(a,ca["异常"])&&""!=e["deBuffMake"]&&(this["异常"]=e["deBuffMake"].split(" ").map((e=>e.trim()))),this.match(a,ca["免疫"])&&""!=e["deBuffImmune"]&&(this["免疫"]=e["deBuffImmune"].split(" ").map((e=>e.trim())))}exportConfig(e){e=e||{};const t=e.type||"",a={};return Object.entries(ca).forEach((([s,l])=>{if(this.match(t,l)&&l.csvKey){const t=this[s];if(t>0&&t!=ca.defValue(s)&&(a[l.csvKey]=t,l.mainClass))switch(l.key){case"威力":a["专系加威力"]=e["mainClass"];break;case"命中":a["6专系加命中"]=e["mainClass"];break;case"伤害":a["专系加伤害"]=e["mainClass"];break;case"减威":a["专系减威力"]=e["mainClass"];break;case"闪避":a["7专系减命中"]=e["mainClass"];break;case"减伤":a["专系减伤害"]=e["mainClass"];break;case"出招":a["专系大招触发加成"]=e["mainClass"];break}}})),this.match(t,ca["异常"])&&this["异常"].length>0&&(a["8造成异常"]=this["异常"].join(" ")),this.match(t,ca["免疫"])&&this["免疫"].length>0&&(a["8免疫异常"]=this["免疫"].join(" ")),a}}class da{constructor(e){this.base={name:"新天赋",id:0,round:4,ke:1,type:"天赋",classType:"无",buffTurn:0,energyCost:0,isAura:!1,auraRange:0,auraEffSelf:"",auraEffEnemy:""},this.mainAttr=new ua,this.auraAttr=new ua,e&&(Object.assign(this.base,e.base),Object.assign(this.mainAttr,e.mainAttr),Object.assign(this.auraAttr,e.auraAttr))}mainMode(){return this.base.isAura?"天赋"==this.base.type?"decideTeam":"useTeam":""}auraMode(){return this.base.isAura?"":"ignoreAll"}toAttrGroup(e){const t=this.base.isAura?"光环":"",a=this.mainAttr.toAttrEntry({teamAttr:this.auraAttr,classType:this.base.classType,mode:this.mainMode(),upflag:e}),s=this.auraAttr.toAttrEntry({classType:this.base.classType,mode:this.auraMode(),upflag:e}),l=new X,n=this.base.isAura?Ze(this.base.auraRange):0,r="特技"==this.base.type?Ie(this.base.energyCost,this.base.isAura):0;return new Ae({type:t,skillType:this.base.type,mainAttr:a,teamAttr:s,viceAttr:l,rangeFactor:n,energyGp:r})}fixAttr(){this.base.isAura||(this.base.auraEffSelf="",this.base.auraEffEnemy="")}calcGrade(e){const t=this.toAttrGroup(e),a=t.calcGrade();return a["desc"]=Te(t),a}importConfig(e,t){if(e){this.base.name=e.name,this.base.id=e.id,this.base.type="7"==e.type?"天赋":"特技",this.base.isAura=null!=t.find((e=>"团队天赋"==e.skillType||"团队状态"==e.skillType)),this.base.isAura&&(this.base.auraRange=e["attr_selfRange"],t.forEach((e=>{""!=e.selfAdv&&(this.base.auraEffSelf=e.selfAdv),""!=e.enemyAdv&&(this.base.auraEffEnemy=e.enemyAdv)})));const a=t.find((e=>"状态"==e.skillType||"团队状态"==e.skillType));this.base.buffTurn=a?a["round"]:0,this.base.energyCost="特技"==this.base.type?e["attr_costEng"]:0,""==this.base.energyCost&&(this.base.energyCost=0);const s=[];t.forEach((e=>{const t=[e["specHitIncType"],e["specHitDecType"],e["specDamageIncType"],e["specDamageIncType"],e["specPowerIncType"],e["specPowerDecType"],e["specCastIncType"]];t.forEach((e=>{""!=e&&s.push(e)}))})),this.base.classType=s.length>0?s[0]:"无"}if(t)if(1==t.length)"团队天赋"==t[0].skillType?(this.mainAttr.importConfig(t[0],{type:"buff"}),this.auraAttr.importConfig(t[0],{type:"talent"})):"团队状态"==t[0].skillType?this.auraAttr.importConfig(t[0]):this.mainAttr.importConfig(t[0]);else if(2==t.length){const e=t.find((e=>"团队天赋"==e.skillType)),a=t.find((e=>"团队状态"==e.skillType));if(!e||!a)throw new Error("天赋配置错误");this.mainAttr.importConfig(e,{type:"buff"}),this.auraAttr.importConfig(e,{type:"talent"}),this.auraAttr.importConfig(a,{type:"buff"})}}exportSkill(){const e=[],t=()=>{const e={"1技能名":this.base.name,"技能id":this.base.id,"2技能类型":"","3状态回合":this.base.buffTurn>0?this.base.buffTurn:"","4对己方有利":this.base.auraEffSelf,"4对敌方有利":this.base.auraEffEnemy,"裸攻加成":"","裸防加成":"","裸轻加成":"","c攻击加成":"","c防御加成":"","c轻功加成":"","c加行动次序":"","c攻击对敌加成":"","c防御对敌加成":"","c轻功对敌加成":"","次序对敌加成":"","d加双击":"","d加暴击":"","加移动格数":"","加攻击移动":"","加杀伤范围":"","6命中加成":"","6专系加命中":"","6专系命中加成":"","7命中减成":"","7专系减命中":"","7专系命中减成":"","威力加成":"","专系加威力":"","专系威力加成":"","威力减成":"","专系减威力":"","专系威力减成":"","伤害加成":"","专系加伤害":"","专系伤害加成":"","伤害减成":"","专系减伤害":"","专系伤害减成":"","大招触发概率加成":"","专系大招触发加成":"","专系大招触发加成概率":"","内伤加成":"","内伤减成":"","加攻击吸血":"","8免疫异常":"","8造成异常":"","8造成异常概率":"","8造成异常回合":"","反弹伤害":"","转移伤害":"","反震伤害":"","9其它说明":""};return e};if(this.base.isAura){if("天赋"==this.base.type){const a=t();a["2技能类型"]="团队天赋",Object.assign(a,this.auraAttr.exportConfig({type:"talent",mainClass:this.base.classType})),Object.assign(a,this.mainAttr.exportConfig({type:"buff",mainClass:this.base.classType}));const s=t();s["2技能类型"]="团队状态",Object.assign(s,this.auraAttr.exportConfig({type:"talent",mainClass:this.base.classType})),Object.assign(s,this.auraAttr.exportConfig({type:"buff",mainClass:this.base.classType})),e.push(a),e.push(s)}else if("特技"==this.base.type){const a=t();a["2技能类型"]="团队状态",Object.assign(a,this.auraAttr.exportConfig({mainClass:this.base.classType})),e.push(a)}}else{const a=t();"天赋"==this.base.type?a["2技能类型"]="天赋":"特技"==this.base.type?a["2技能类型"]="状态":("内功"==this.base.type||"轻功"==this.base.type)&&(a["2技能类型"]="装备技"),Object.assign(a,this.mainAttr.exportConfig({mainClass:this.base.classType})),e.push(a)}return e}}function fa(e){const t=u(e),a=_(e)||[];if(!t||"7"!=t.type&&"8"!=t.type)return null;const s=new da;return s.importConfig(t,a),s}const ha=["闪避","移动距离"],ma=["自身攻击","战场攻击","自身防御","战场防御","出招","主系出招","威力","主系威力","伤害","主系伤害","加受伤度","吸血","反弹","反震"];class pa{constructor(e){this.skill=e,this.mainAttr={},this.auraAttr={}}validate(){for(const e in this.skill.mainAttr)this.mainAttr[e]=this.validateAttr(e,!1);for(const e in this.skill.auraAttr)this.auraAttr[e]=this.validateAttr(e,!0)}validateAttr(e,t){const a=ca[e],s=t?this.skill.auraAttr[e]:this.skill.mainAttr[e],l={isAura:t,round:this.skill.base.round,ke:this.skill.base.ke,type:this.skill.base.type};return a.items?null:isNaN(s)?"必须是数字":s==ca.defValue(e)?"":"内功"==l.type&&ha.includes(e)||"轻功"==l.type&&ma.includes(e)?"本土无先例":a.pct?s%5!=0?"必须是5的倍数":a.mul?a.dec?ba(a,s,l):ga(a,s,l):va(a,s,l):_a(a,s,l)}}function ga(e,t,a={}){let s=200,l=100;return s="内功"==a.type?130:"轻功"==a.type?150:a.round>4?"命中"==e.key?1e3:200:a.round>2?a.isAura?120:150:a.isAura?110:120,"加受伤"==e.key&&(s=200),t>s?`上限${s}`:t<l?"负面效果":null}function ba(e,t,a={}){let s=100,l=10;return l="内功"==a.type?70:"轻功"==a.type?50:a.round>4?20:a.round>2?a.isAura?70:50:a.isAura?90:70,"减受伤"==e.key&&(l=0),t>s?"负面效果":t<l?`下限${l}`:null}function va(e,t){let a=100,s=0;return t>a?`上限${a}`:t<s?"负面效果":null}function _a(e,t,a={}){let s=5,l=0;return a.round>4&&(s=100),t>s?`上限${s}`:t<l?"负面效果":void 0}const ka=()=>({customSKills:[]}),ya={num:e=>e.customSKills.length},$a={async updateCustomSkill({commit:e},t){await e("updateCustomSkill",t),await e("saveCustomSkills")},async deleteCustomSkill({commit:e},t){await e("deleteCustomSkill",t),await e("saveCustomSkills")},async loadCustomSkills({commit:e}){await e("loadCustomSkills")},async upMoveCustomSkills({commit:e},t){await e("upMoveCustomSkills",t),await e("saveCustomSkills")},async downMoveCustomSkills({commit:e},t){await e("downMoveCustomSkills",t),await e("saveCustomSkills")}},La={updateCustomSkill(e,{name:t,skill:a}){const s=e.customSKills.findIndex((e=>e.name===t));-1===s?e.customSKills.push({name:t,skill:a}):e.customSKills[s].skill=a},deleteCustomSkill(e,{name:t}){const a=e.customSKills.findIndex((e=>e.name===t));e.customSKills.splice(a,1)},saveCustomSkills(e){(0,ra.localSave)("customSkills",e.customSKills)},loadCustomSkills(e){const t=(0,ra.localLoad)("customSkills");t&&t.length>0&&(e.customSKills=t.map((e=>({name:e.name,skill:new da(e.skill)}))))},upMoveCustomSkills(e,{skills:t}){t.forEach((t=>{const a=e.customSKills.findIndex((e=>e.name===t));if(a<0||0===a)return;const s=e.customSKills[a-1];e.customSKills[a-1]=e.customSKills[a],e.customSKills[a]=s})),e.customSKills.push(""),e.customSKills.pop()},downMoveCustomSkills(e,{skills:t}){for(let a=t.length-1;a>=0;a--){const s=t[a],l=e.customSKills.findIndex((e=>e.name===s));if(l<0||l===e.customSKills.length-1)continue;const n=e.customSKills[l+1];e.customSKills[l+1]=e.customSKills[l],e.customSKills[l]=n}e.customSKills.push(""),e.customSKills.pop()}};var xa={namespaced:!0,state:ka,getters:ya,actions:$a,mutations:La};const Sa={title:{2:["1","270","6","72","15","134","379","439","235","399","222","109"],4:[]},talent:{2:["1053","807","792","975","781","800","794","797","785","830","786","1047","806","805"],4:["848","796","789"]},effect:{2:["1089","184","888","1009","891","901"],4:["885","642","1090","620","908"]}};class Aa{constructor(e){this.base={name:"新角色",id:0,round:4,ke:1,classType:"无"},this.config={title:null,talent:null,effect:null,triggerSkill:null,twoHands:!1,harmony:!1},this.options={titleCustom:!1,talentCustom:!1,effectCustom:!1,triggerCustom:!1,titleScoreOnly:!1,titleDescShow:!0,talentKeOnly:!1,talentDescShow:!0,effectKeOnly:!1,effectDescShow:!0,triggerKeOnly:!1,triggerDescShow:!0},e&&(Object.assign(this.base,e.base),Object.assign(this.config,e.config),Object.assign(this.options,e.options))}checkTotalGrade(e){return Ia(this,e)}checkBan(e,t){t=t.toString();const a=Sa[e];return this.base.round<=4&&a[4].includes(t)?"4周以下禁用":this.base.round<=2&&a[2].includes(t)?"2周禁用":""}getTitle(){const e={id:-1,name:"无",desc:"无",grade:0};if(!this.config.title)return e;const t=this.config.title.split(":")[1],a=g(t);return a?{id:t,name:a.name,desc:a.desc,grade:a.grade}:e}getSkill(e){const t={id:-1,name:"无",desc:"无",grade:0};if(!e)return t;const[a,s]=e.split(":");if("std"==a){const e=u(s);return e?{id:e.id,name:e.name,desc:7==e.type?e["text_equip"]:e["text_use"],grade:wa(this,e,Number(e.grade),!1),grade_detail:Za(this,Number(e.grade))}:t}if("custom"==a){const e=y(s);if(!e)return t;const a=e.skill.calcGrade();return{id:e.id,name:e.name,desc:a.desc,grade:wa(this,e.skill,a.totalGrade,!0),grade_detail:Za(this,a.totalGrade)}}}}function wa(e,t,a,s){return e.base.round<6&&(s&&"特技"===t.base.type||!s&&8===t.type)&&a>10&&a<=15?10:a}function Ca(e){let t=1e3;return e.base.round<=2?t=e.base.ke>1?7.5:5:e.base.round<=4&&(t=e.base.ke>1?15:12.5),t}function Za(e,t){let a=Ca(e);return t>a?`上限${a}分`:""}function Ia(e,t){let a=1e3;return e.base.round<=2?a=e.base.ke>1?15:12.5:e.base.round<=4&&(a=e.base.ke>1?30:25),t>a?`上限${a}分`:""}function Ea(){return ds.getters.isReady?ds.state.TitleConfigSource.map((e=>{let t=`[${e.skillId}]${e.name}(${e.grade||0})`;return e.ext_grade&&(t+=`#${e.ext_grade.desc}`),{text:t,value:`std:${e.skillId}`,grade:e.grade||0}})).sort(((e,t)=>t.grade-e.grade)):[]}function Pa(e){const t=e.options.talentCustom;if(!ds.getters.isReady)return[];const a=Ca(e);return t?ds.state.customSkill.customSKills.filter((e=>"天赋"===e.skill.base.type)).map((e=>{const t=Number(e.skill.calcGrade().totalGrade.toFixed(2));return{text:`${e.name}(${t})`,value:`custom:${e.name}`,ke:!0,grade:t}})).filter((e=>e.grade<=a)).sort(((e,t)=>t.grade-e.grade)):Object.values(ds.state.SkillSource).filter((e=>7===e.type)).map((e=>({text:`[${e.id}]${e.name}(${e.grade})`,value:`std:${e.id}`,ke:"1"==e.ke,grade:e.grade}))).filter((e=>e.grade<=a)).sort(((e,t)=>t.grade-e.grade))}function Fa(e){const t=e.options.effectCustom;if(!ds.getters.isReady)return[];const a=Ca(e);return t?ds.state.customSkill.customSKills.filter((e=>"特技"===e.skill.base.type)).map((e=>{const t=Number(e.skill.calcGrade().totalGrade.toFixed(2));return{text:`${e.name}(${t})`,value:`custom:${e.name}`,ke:!0,grade:t}})).filter((e=>e.grade<=a)).sort(((e,t)=>t.grade-e.grade)):Object.values(ds.state.SkillSource).filter((e=>8===e.type)).map((e=>({text:`[${e.id}]${e.name}(${e.grade})`,value:`std:${e.id}`,ke:"1"==e.ke,grade:e.grade}))).filter((e=>e.grade<=a)).sort(((e,t)=>t.grade-e.grade))}function Oa(e){if(!ds.getters.isReady)return[];const t=Ca(e);return Object.values(ds.state.SkillSource).filter((e=>e.type>=0&&e.type<=4)).filter((e=>e["trigger_effect"])).map((e=>{const t=e["trigger_effect"][0],a=u(t);return{text:`[${e.id}]${e.name}：${a.name}(${a.grade})`,value:`std:${e.id}`,ke:"1"==e.ke,trigger_effect:e["trigger_effect"],grade:a.grade}})).filter((e=>e.grade<=t)).sort(((e,t)=>t.grade-e.grade))}const Ta=()=>({customRoles:[]}),Ba={num:e=>e.customRoles.length},Va={async updateCustomRole({commit:e},t){await e("updateCustomRole",t),await e("saveCustomRoles")},async deleteCustomRole({commit:e},t){await e("deleteCustomRole",t),await e("saveCustomRoles")},async loadCustomRoles({commit:e}){await e("loadCustomRoles")}},Da={updateCustomRole(e,{name:t,role:a}){const s=e.customRoles.findIndex((e=>e.name===t));-1===s?e.customRoles.push({name:t,role:a}):e.customRoles[s].role=a},deleteCustomRole(e,{name:t}){const a=e.customRoles.findIndex((e=>e.name===t));e.customRoles.splice(a,1)},saveCustomRoles(e){(0,ra.localSave)("customRoles",e.customRoles)},loadCustomRoles(e){const t=(0,ra.localLoad)("customRoles");t&&t.length>0&&(e.customRoles=t.map((e=>({name:e.name,role:new Aa(e.role)}))))}};var ja={namespaced:!0,state:Ta,getters:Ba,actions:Va,mutations:Da};const Ka={"拜师":["拳系","剑系","兵系","特系","暗系"],"飞雪":["灵素线","倾眉线"],"连城":["水笙线","戚芳线","霜华线"],"天龙":["折箭线","荡寇线"],"射雕":["暂无分线"],"白马":["文秀线","阿曼线"],"鹿鼎":["神龙线","天地线"],"笑傲":["日月线","五岳线"],"书剑":["楼兰线","红花线"],"神雕":["龙女线","莫愁线"],"侠客":["凌霄线","玄素线"],"倚天":["圣火线","武当线","蒙古线"],"碧血":["凤曜线","青衿线"],"结局":["共和","称帝"],"武当线分歧":["救赵敏","杀赵敏","救一半"],"莫愁线分歧":["杀杨龙","杨龙活"],"华山绝顶分歧":["拿灵蛇","拿蛤蟆功"],"降龙支线分歧":["拿降龙","拿流星"],"上侠客岛分歧":["阿青上岛","石破天上岛"],"戚芳线分歧":["选乌蚕衣","选戚芳"],"水笙线分歧":["选水笙","选黄马"],"霜华线分歧":["救霜华","没蛤蟆"],"阿曼线分歧":["选骆驼","选阿曼"]},Ga=[["攻","req_atk"],["防","req_def"],["轻","req_agi"],["拳","req_fs"],["剑","req_ss"],["兵","req_ws"],["特","req_rs"],["暗","req_ts"]];function Ra(e){let t=[];const a=e=>{e&&t.push(e)};let s=[];const l=e=>{e&&s.push(e)};e["req_family"]&&l(rt(e["req_family"])),e["req_party"]&&l(ot(e["req_party"])),e["req_gender"]>=0&&l(st(e["req_gender"])),e["req_hero1"]>=0&&l(Zt(e["req_hero1"])),e["req_hero2"]>=0&&l(Zt(e["req_hero2"])),e["req_itl"]&&(e["req_itl"]>0?l(`资质>=${e["req_itl"]}`):e["req_itl"]<0&&l("资质<="+-e["req_itl"])),s.length>0&&a(s.join(" | ")),0!=e["req_mpKind"]&&1!=e["req_mpKind"]||a(ht(e["req_mpKind"]));let n=[];e["req_mp"]&&n.push(`功力${e["req_mp"]}`),e["req_heal"]&&n.push(`医疗${e["req_heal"]}`),e["req_poiMk"]&&n.push(`用毒${e["req_poiMk"]}`);for(let r=0;r<8;r++)e[Ga[r][1]]&&n.push(`${Ga[r][0]}${e[Ga[r][1]]}`);return n.length>0&&a(n.join("")),t.join(", ")}const qa=[["攻","attr_atk","攻击"],["防","attr_def","防御"],["轻","attr_agi","轻功"],["拳","attr_fs","拳掌"],["剑","attr_ss","御剑"],["兵","attr_ws","兵器"],["特","attr_rs","指腿"],["暗","attr_ts","暗毒"],["武常","attr_klg","武常"]];function Ma(e){let t={};const a=(e,a)=>{a&&(t[e]=a)};for(let s=0;s<qa.length;s++)a(qa[s][2],e[qa[s][1]]);return t}function Na(e){let t=[];const a=e=>{e&&t.push(e)};for(let n=0;n<3;n++)e[qa[n][1]]&&a(`${qa[n][0]}${e[qa[n][1]]}`);let s=0,l=99;for(let n=3;n<8;n++){const t=e[qa[n][1]]||0;s=Math.max(s,t),l=Math.min(l,t)}if(s==l&&s>0)a(`五系${s}`);else for(let n=3;n<8;n++)e[qa[n][1]]&&a(`${qa[n][0]}${e[qa[n][1]]}`);return e[qa[8][1]]&&a(`${qa[8][0]}${e[qa[8][1]]}`),t.join("")}class Ha{constructor(e,t,a={}){this.id=0,this.attrs={base:{},learn:{},addon:{},total:{}},t&&(this.learn=t),e&&(this.id=e.id,this.hero=e,this.name=a["name"]||e["name"],this.originTalent=a["origin"]?.["talent"],this.itl=a["origin"]?.["itl"]||e["attr_itl"],this.poison=e["attr_poiMk"]||0,this.gender=st(e["gender"]),this.family=rt(e["family"]),this.party=ot(e["party"]),this.mpKind=ft(e["mpKind"]),this.mingyu=e["status_myd"],a["origin"]?(this.gender=a["origin"]["gender"],this.mingyu=12-a["origin"]["itl"]/10,this.mpKind=9!=a["origin"]["talent"]?a["origin"]["mpKind"]:ft(e["mpKind"]),this.poison=6==a["origin"]["talent"]?300:0):a.clone&&(this.id=0,"女"==this.gender&&(this.gender="妖"),this.family=rt(1)))}getOwnedSkills(){if(!this.hero||!this.hero["skills"])return[];let e=[];for(let t=0;t<30;t++){const a=this.hero["skills"][t];if(a["skill"]){const t=1+Math.floor(a["exp"]/100);e.push(new za({ownedSkill:{id:a["skill"],level:t}}))}}return e}changeRound(e){this.round=e,this.recalcBase(),this.recalcFinalAttr()}updateAddonAttr(e){this.attrs.addon["根骨"]=0,Object.keys(e).forEach((t=>{this.attrs.addon[t]=Number(e[t]),this.attrs.addon["根骨"]-=Number(e[t])*Ya(t)})),this.recalcFinalAttr()}recalcBase(){if(this.level=5*this.round+60,this.attrs.base["攻击"]=Number(this.hero["attr_atk"])+2*(this.level-1),this.attrs.base["防御"]=Number(this.hero["attr_def"])+2*(this.level-1),this.attrs.base["轻功"]=Number(this.hero["attr_agi"])+2*(this.level-1),this.attrs.base["武常"]=Number(this.hero["attr_klg"]),this.attrs.base["拳掌"]=Number(this.hero["attr_fs"]),this.attrs.base["御剑"]=Number(this.hero["attr_ss"]),this.attrs.base["兵器"]=Number(this.hero["attr_ws"]),this.attrs.base["指腿"]=Number(this.hero["attr_rs"]),this.attrs.base["暗毒"]=Number(this.hero["attr_ts"]),null!=this.originTalent){const e=["拳掌","御剑","兵器","指腿","暗毒"];for(let t=0;t<5;t++)this.originTalent===t?this.attrs.base[e[t]]+=60+20*this.round:this.attrs.base[e[t]]+=10+20*this.round}this.attrs.base["根骨"]=100*(this.round-1)+(this.level-1)*Math.floor(this.itl/10)}recalcLearn(){let e={};for(let t of this.learn.learnBooks){const a=t.getAttrs();for(let t in a)e[t]?e[t]+=a[t]:e[t]=a[t]}for(let t of this.learn.propEvents){const a=t.attrs||{};for(let t in a)e[t]?e[t]+=a[t]:e[t]=a[t]}this.attrs.learn=e}recalcFinalAttr(){let e={};Object.keys(this.attrs.base).forEach((t=>{e[t]=this.attrs.base[t],this.attrs.learn[t]&&(e[t]+=this.attrs.learn[t]),this.attrs.addon[t]&&(e[t]+=this.attrs.addon[t])})),this.attrs.total=e}}class Ua{constructor(e){if(this.base={name:"新方案",round:6},this.chief={origin:!0,talent:0,cloneId:56,itl:100,gender:"男",mpKind:"阴"},this.branches={},this.roles={},e&&(Object.assign(this.base,e.base),Object.assign(this.chief,e.chief),Object.assign(this.branches,e.branches),e.roles))for(let t in e.roles)this.roles[t]=new Xa({role:e.roles[t]});this.initBranches()}getRoleScheme(e){return this.roles[e]?this.roles[e]:new Xa({id:e})}updateRole(e){this.roles[e.base.id]=e}initBranches(){this.branches["射雕"]="暂无分线"}randomBranches(){const e={};for(let t in Ka){const a=Ka[t],s=Math.floor(Math.random()*a.length);e[t]=a[s]}this.branches=e}fixBranches(){this.branches["连城"]&&("水笙线"==this.branches["连城"]?this.branches["白马"]="阿曼线":this.branches["白马"]="文秀线"),this.branches["倚天"]&&("蒙古线"==this.branches["倚天"]?this.branches["鹿鼎"]="天地线":this.branches["鹿鼎"]="神龙线")}}const Qa=["攻击","防御","轻功","拳掌","御剑","兵器","指腿","暗毒"];function Ya(e){return"攻击"==e?1:"防御"==e||"轻功"==e?2:6}class Xa{constructor(e={}){if(this.base={},this.attrsAddon={},this.learnBooks=[],this.propEvents=[],e.role){Object.assign(this.base,e.role.base),Object.assign(this.attrsAddon,e.role.attrsAddon);for(let t of e.role.learnBooks)this.learnBooks.push(new Wa({data:t}));Object.assign(this.propEvents,e.role.propEvents)}else{this.base.id=e.id;for(let e of Qa)this.attrsAddon[e]=0}}isEmpty(){const e=0==Object.values(this.attrsAddon).reduce(((e,t)=>Math.abs(e)+Math.abs(t)));return e&&0==this.learnBooks.length&&0==this.propEvents.length}addLearnedBook(e){for(let t of this.learnBooks)if(t.id==e.id)return!1;for(let t=0;t<this.learnBooks.length;t++)if(!this.learnBooks[t].id)return this.learnBooks[t]=e,this.forceRefresh(),!0;return this.learnBooks.push(e),!0}upMoveBook(e){for(let t=0;t<this.learnBooks.length;t++)if(this.learnBooks[t].id==e){if(0==t)return;for(let e=t-1;e>=0;e--)if(this.learnBooks[e].type==this.learnBooks[t].type){const a=this.learnBooks[t];return this.learnBooks[t]=this.learnBooks[e],void(this.learnBooks[e]=a)}return}}downMoveBook(e){for(let t=0;t<this.learnBooks.length;t++)if(this.learnBooks[t].id==e){if(t==this.learnBooks.length-1)return;for(let e=t+1;e<this.learnBooks.length;e++)if(this.learnBooks[e].type==this.learnBooks[t].type){const a=this.learnBooks[t];return this.learnBooks[t]=this.learnBooks[e],void(this.learnBooks[e]=a)}return}}deleteLearnedBook(e,t=!1){for(let a=0;a<this.learnBooks.length;a++)if(this.learnBooks[a].id==e){if(t)this.learnBooks[a].setToEmpty();else{for(let e=a+1;e<this.learnBooks.length;e++)this.learnBooks[e-1]=this.learnBooks[e];this.learnBooks.pop()}return!0}return!1}forceRefresh(){this.learnBooks.push(""),this.learnBooks.pop()}getLearnedBooks(e){return this.learnBooks.filter((t=>e?t.type==e:!t.type)).map((e=>new za({book:e})))}getPropEvents(){return this.propEvents.map((e=>new Ja(e)))}addPropEvent(e){for(let t in e.attrs)e.attrs[t]=parseInt(e.attrs[t]);this.propEvents.push(e)}deletePropEvents(e){e.sort(((e,t)=>t-e));for(let t of e)this.propEvents.splice(t,1)}}class Wa{constructor(e={}){if(e.data)return void Object.assign(this,e.data);this.id=e.id,e.typ&&(this.type=e.typ);const t=e=>{this.flags=this.flags||[],this.flags.indexOf(e)<0&&this.flags.push(e)};e["灵犀"]&&t("灵犀"),e["璇玑"]&&t("璇玑")}setToEmpty(){this.id=0,this.flags=[]}hasFlag(e){return this.flags&&this.flags.indexOf(e)>=0}getAttrs(){const e=f(this.id);let t="洗武"==this.type?9:10,a=1;this.hasFlag("灵犀")&&(a+=.5),this.hasFlag("璇玑")&&(a+=1);const s=Ma(e);let l={};for(let n in s)l[n]=s[n]*t,a>1&&("拳掌"==n||"御剑"==n||"兵器"==n||"指腿"==n||"暗毒"==n)&&(l[n]*=a);return l}}class za{constructor(e={}){if(e["ownedSkill"]){const t=u(e["ownedSkill"]["id"]);this.name=t["name"],this.level=e["ownedSkill"]["level"]}else{const t=e["book"],a=f(t["id"]),s=u(a["targetSkill"]);this.bookId=t["id"],this.name=s?.name||`<${a["name"]}>`,this.level=10,this.effect=this.getEffectText(t),this.tag=this.getTagText(t)}}getEffectText(e){let t=[];const a=e=>{e&&t.push(e)},s=e.getAttrs();for(let l in s)a(`${l}${s[l]}`);return t.join("")}getTagText(e){let t=[];const a=e=>{e&&t.push(e)};return e.hasFlag("璇玑")&&a("璇玑"),e.hasFlag("灵犀")&&a("灵犀"),t.join("+")}}class Ja{constructor(e){this.name=e.name,this.effect=this.getEffectText(e)}getEffectText(e){let t=[];const a=e=>{e&&t.push(e)},s=e.attrs||{};for(let l in s)a(`${l}${s[l]}`);return t.join("")}}function es(e){const t=e["targetSkill"]?u(e["targetSkill"]):null;let a=e.level;return t&&5==t["type"]&&(7==a?a="防功":0==a&&(a="")),{id:e.id,level:a,name:e.name,require:Ra(e),effect:Na(e),skill:t?.name}}function ts(e,t,a={}){const s=a["无相"];if("调和"!=t.mpKind&&!s){const a=ht(e["req_mpKind"]);if(""!=a&&a!=t.mpKind)return!1}const l=e["req_gender"]>=0,n=e["req_family"]>0,r=e["req_party"]>0,i=e["req_hero1"]>=0,o=e["req_hero2"]>=0,c=l||n||r||i||o;if(c){const a=l&&lt(e["req_gender"],t.gender),s=n&&rt(e["req_family"])==t.family,c=r&&ot(e["req_party"])==t.party,u=i&&e["req_hero1"]==t.id,d=o&&e["req_hero2"]==t.id;if(!(a||s||c||u||d))return!1}if(e["req_itl"]&&!s)if(e["req_itl"]>0){if(t.itl<e["req_itl"])return!1}else if(t.itl>-e["req_itl"])return!1;return!(e["req_poiMk"]&&!s&&t.poison<=0)&&(e&&t)}const as=()=>({learnPortfolios:[],curLearnPortfolio:new Ua}),ss={num:e=>e.learnPortfolios.length},ls={async saveLearnPortfolio({commit:e},t){await e("saveLearnPortfolio",t)},async deleteLearnPortfolio({commit:e},t){await e("deleteLearnPortfolio",t),await e("clearLearnPortfolio")},async saveLearnPortfolioList({commit:e}){await e("saveLearnPortfolioList")},async loadLearnPortfolioList({commit:e}){await e("loadLearnPortfolioList")},async loadLearnPortfolio({commit:e},t){await e("loadLearnPortfolio",t)},async clearLearnPortfolio({commit:e}){await e("clearLearnPortfolio")}},ns={saveLearnPortfolioList(e){(0,ra.localSave)("learnPortfolios",e.learnPortfolios)},loadLearnPortfolioList(e){e.learnPortfolios=(0,ra.localLoad)("learnPortfolios")||[]},loadLearnPortfolio(e,{name:t}){e.curLearnPortfolio=new Ua((0,ra.localLoad)("learnPortfolio::"+t))},saveLearnPortfolio(e,{name:t,portfolio:a}){(0,ra.localSave)("learnPortfolio::"+t,a),-1===e.learnPortfolios.indexOf(t)&&(e.learnPortfolios.push(t),(0,ra.localSave)("learnPortfolios",e.learnPortfolios))},deleteLearnPortfolio(e,{name:t}){const a=e.learnPortfolios.findIndex((e=>e==t));-1!==a&&(e.learnPortfolios.splice(a,1),(0,ra.localSave)("learnPortfolios",e.learnPortfolios),(0,ra.localDelete)("learnPortfolio::"+t))},clearLearnPortfolio(e){e.curLearnPortfolio=new Ua}};var rs={namespaced:!0,state:as,getters:ss,actions:ls,mutations:ns};function is(e){const t={};return Object.values(e).forEach((e=>{t[e.suitKey]=e})),t}function os(e){const t={};return e.forEach((e=>{void 0==t[e["skillId"]]&&(t[e["skillId"]]=[]),t[e["skillId"]].push(e)})),t}function cs(e){const t={};return e.forEach((e=>{t[e.skillId]=e})),t}s.ZP.use(l.ZP);const us=17;var ds=new l.ZP.Store({state:{CurVersion:"",SupportedVersions:[],LoadingCount:0,InitDone:!1,HeroSource:{},ItemSource:{},SkillSource:{},StageSource:{},SuitSource:{},ListSource:{},SkillConfigSource:[],SkillExtConfigSource:{},TitleConfigSource:[],TitleExtConfigSource:{},EventSource:{},EventPointSource:[],EventConditionSource:{},BattleSource:[],EventInfoSource:{},TalkRef:{},Const:{},Indexes:{SkillIndex:{},SuitIndex:{},SkillConfigIndex:{},TitleIndex:{},MatchIndex:{}}},getters:{isReady(e){return 0===e.LoadingCount&&e.InitDone},loadingProgress(e){return Math.round((us-e.LoadingCount)/us*100)}},mutations:{resetLoading(e){e.LoadingCount=us},loadingOne(e){e.LoadingCount--},setVersion(e,t){e.CurVersion=o(t)},setHeroSource(e,t){e.HeroSource=t},setItemSource(e,t){e.ItemSource=t},setSkillSource(e,t){e.SkillSource=t},setStageSource(e,t){e.StageSource=t},setSuitSource(e,t){e.SuitSource=t,e.Indexes.SuitIndex=is(t)},setListSource(e,t){e.ListSource=t},setSkillConfigSource(e,t){e.SkillConfigSource=t,e.Indexes.SkillConfigIndex=os(t)},setTitleConfigSource(e,t){e.TitleConfigSource=t,e.Indexes.TitleIndex=cs(t)},setSkillExtConfigSource(e,t){e.SkillExtConfigSource=t},setTitleExtConfigSource(e,t){e.TitleExtConfigSource=t},setEventSource(e,t){e.EventSource=t},setEventInfoSource(e,t){e.EventInfoSource=t},setEventConditionSource(e,t){e.EventConditionSource=t},setEventPointSource(e,t){e.EventPointSource=t},setBattleSource(e,t){e.BattleSource=t},setTalkRef(e,t){e.TalkRef=t},setConst(e,t){e.Const=t},initAllData(e){Ot(),Tt(),jt(),Bt(),Mt(),Ht(),Vt(),Dt(),Wt(),zt(),e.InitDone=!0}},actions:{async initStore({commit:e,dispatch:t,state:a}){if(e("resetLoading"),0===a.SupportedVersions.length){const e=await i("versions");a.SupportedVersions=e,a.CurVersion=a.SupportedVersions[0]}await Promise.all([i("hero",a.CurVersion).then((t=>e("setHeroSource",t))).then((()=>e("loadingOne"))),i("item",a.CurVersion).then((t=>e("setItemSource",t))).then((()=>e("loadingOne"))),i("skill",a.CurVersion).then((t=>e("setSkillSource",t))).then((()=>e("loadingOne"))),i("stage",a.CurVersion).then((t=>e("setStageSource",t))).then((()=>e("loadingOne"))),i("suit",a.CurVersion).then((t=>e("setSuitSource",t))).then((()=>e("loadingOne"))),i("list",a.CurVersion).then((t=>e("setListSource",t))).then((()=>e("loadingOne"))),i("skill_config",a.CurVersion).then((t=>e("setSkillConfigSource",t))).then((()=>e("loadingOne"))),i("title_config",a.CurVersion).then((t=>e("setTitleConfigSource",t))).then((()=>e("loadingOne"))),i("event",a.CurVersion).then((t=>e("setEventSource",t))).then((()=>e("loadingOne"))),i("event_info",a.CurVersion).then((t=>e("setEventInfoSource",t))).then((()=>e("loadingOne"))),i("event_condition",a.CurVersion).then((t=>e("setEventConditionSource",t))).then((()=>e("loadingOne"))),i("event_point",a.CurVersion).then((t=>e("setEventPointSource",t))).then((()=>e("loadingOne"))),i("battle",a.CurVersion).then((t=>e("setBattleSource",t))).then((()=>e("loadingOne"))),i("talk_ref",a.CurVersion).then((t=>e("setTalkRef",t))).then((()=>e("loadingOne"))),i("skill_ext").then((t=>e("setSkillExtConfigSource",t))).then((()=>e("loadingOne"))),i("title_ext").then((t=>e("setTitleExtConfigSource",t))).then((()=>e("loadingOne"))),i("const").then((t=>e("setConst",t))).then((()=>e("loadingOne"))),t("customSkill/loadCustomSkills"),t("customRole/loadCustomRoles"),t("learnSim/loadLearnPortfolioList")]),e("initAllData")}},modules:{customSkill:xa,customRole:ja,learnSim:rs}}),fs=a(1705);s.ZP.use(fs.Z);var hs=new fs.Z({}),ms=a(8345),ps=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home"},[t("HelloWorld")],1)},gs=[],bs=a(266),vs=a(9256),_s=a(1713),ks=function(){var e=this,t=e._self._c;return t(vs.Z,[t(_s.Z,{staticClass:"text-center"},[t(bs.Z,{staticClass:"mb-4"},[t("h1",{staticClass:"display-2 font-weight-bold mb-3"},[e._v(" 金书红颜录数据查看器 ")])]),t(bs.Z,{staticClass:"mb-5",attrs:{cols:"12"}},[t("h2",{staticClass:"headline font-weight-bold mb-3"},[e._v(" 基本数据 ")]),t(_s.Z,{attrs:{justify:"center"}},e._l(e.dataViews,(function(a,s){return t("router-link",{key:s,staticClass:"subheading mx-3",attrs:{to:a.to}},[e._v(" "+e._s(a.text)+" ")])})),1)],1),t(bs.Z,{staticClass:"mb-5",attrs:{cols:"12"}},[t("h2",{staticClass:"headline font-weight-bold mb-3"},[e._v(" 高阶数据 ")]),t(_s.Z,{attrs:{justify:"center"}},e._l(e.highDatas,(function(a,s){return t("router-link",{key:s,staticClass:"subheading mx-3",attrs:{to:a.to}},[e._v(" "+e._s(a.text)+" ")])})),1)],1),t(bs.Z,{staticClass:"mb-5",attrs:{cols:"12"}},[t("h2",{staticClass:"headline font-weight-bold mb-3"},[e._v(" 辅助工具 ")]),t(_s.Z,{attrs:{justify:"center"}},e._l(e.tools,(function(a,s){return t("router-link",{key:s,staticClass:"subheading mx-3",attrs:{to:a.to}},[e._v(" "+e._s(a.text)+" ")])})),1)],1)],1)],1)},ys=[],$s={name:"HelloWorld",data:()=>({dataViews:[{text:"人物",to:"/hero"},{text:"物品",to:"/item"},{text:"武功",to:"/skill"},{text:"套装配合",to:"/list"},{text:"武功数值",to:"/skill-config"}],highDatas:[{text:"事件总览",to:"/event"},{text:"指令分类",to:"/event-group"},{text:"场景事件点",to:"/event-point"},{text:"战斗",to:"/battle"}],tools:[{text:"分数计算器",to:"custom-sim"},{text:"养成模拟器",to:"learn-sim"}]})},Ls=$s,xs=a(1001),Ss=(0,xs.Z)(Ls,ks,ys,!1,null,null,null),As=Ss.exports,ws={name:"HomeView",components:{HelloWorld:As}},Cs=ws,Zs=(0,xs.Z)(Cs,ps,gs,!1,null,null,null),Is=Zs.exports,Es=function(){var e=this,t=e._self._c;return t("div",[t("TabDataPage",{attrs:{name:"item",tabs:e.tabs,headersSource:e.headers,itemsSource:e.items,mapper:e.convertValue,"header-labels":e.headerLabels},on:{tabChange:e.selectTab}})],1)},Ps=[],Fs=a(626),Os=a(3011),Ts=function(){var e=this,t=e._self._c;return t(vs.Z,{staticStyle:{width:"95%","min-width":"95%",overflow:"auto"},attrs:{fluid:"","grid-list-md":""}},[t(Os.Z,{attrs:{"center-active":""},on:{change:e.tabChange}},e._l(e.tabs,(function(a){return t(Fs.Z,{key:a.value},[e._v(" "+e._s(a.title)+" ")])})),1),t("DataPage",{attrs:{name:`${e.name}_${e.selectedGroup}`,"headers-source":e.headersSource,"items-source":e.itemsSource,mapper:e.mapper,"header-labels":e.headerLabels,"header-filter":e.headerFilter,"data-filter":e.dataFilter,"extra-filters":e.extraFilters}})],1)},Bs=[],Vs=a(6797),Ds=a(4562),js=a(9582),Ks=a(4886),Gs=a(4127),Rs=a(8242),qs=a(3863),Ms=a(255),Ns=a(2348),Hs=a(400),Us=a(1214),Qs=a(7423),Ys=a(7808),Xs=a(6072),Ws=function(){var e=this,t=e._self._c;return t(vs.Z,{staticStyle:{width:"fit-content","min-width":"100%"}},[e.extraFilters&&e.extraFilters.length>0||e.headerLabels&&e.headerLabels.length>0?t(Us.Z,{attrs:{flat:"",accordion:""},model:{value:e.option,callback:function(t){e.option=t},expression:"option"}},[t(Ms.Z,[t(Hs.Z,[e._v(" 选项 ")]),t(Ns.Z,[e._l(e.extraFilters,(function(a){return t("div",{key:a.label},[t(js.Z,{attrs:{flat:""}},[t(Ks.EB,{staticClass:"text-subtitle-2"},[e._v(" "+e._s(a.label)+" ")]),t(Ks.ZB,["select"===a.type?t(Rs.Z,{attrs:{column:"",mandatory:"","active-class":"primary--text text--accent-4"},model:{value:a.selected,callback:function(t){e.$set(a,"selected",t)},expression:"filter.selected"}},e._l(a.value,(function(a){return t(Gs.Z,{key:a,attrs:{outlined:"",value:a}},[e._v(" "+e._s(a)+" ")])})),1):e._e(),"multiSelect"===a.type?t(Rs.Z,{attrs:{column:"",multiple:"","active-class":"primary--text text--accent-4"},model:{value:a.selected,callback:function(t){e.$set(a,"selected",t)},expression:"filter.selected"}},e._l(a.value,(function(a){return t(Gs.Z,{key:a,attrs:{outlined:"",value:a}},[e._v(" "+e._s(a)+" ")])})),1):e._e()],1)],1)],1)})),t(js.Z,{attrs:{flat:""}},[e.headerLabels.length>0?t(Ks.EB,{staticClass:"text-subtitle-2"},[e._v(" 表头筛选 ")]):e._e(),t(Ks.ZB,[t(Rs.Z,{attrs:{column:"",multiple:"","active-class":"primary--text text--accent-4"},on:{change:function(t){return e.settingChanged()}},model:{value:e.selectedLabels,callback:function(t){e.selectedLabels=t},expression:"selectedLabels"}},e._l(e.headerLabels,(function(a){return t(Gs.Z,{key:a.value,attrs:{outlined:""}},[e._v(" "+e._s(a.text)+" ")])})),1)],1)],1),e._t("options")],2)],1)],1):e._e(),t(Ys.Z,{staticClass:"mb-2",staticStyle:{"max-width":"100%"},attrs:{"append-icon":"mdi-magnify",label:"搜索","single-line":"","hide-details":"",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),t("div",{staticStyle:{"max-width":"100%",overflow:"scroll"}},[t("div",{staticStyle:{width:"max-content"}},[t(qs.Z,{staticClass:"elevation-1 table",attrs:{dense:"","multi-sort":"","show-group-by":"","footer-props":{"items-per-page-options":[50,-1]},"calculate-widths":!0,headers:e.headers,items:e.items,page:e.page,"items-per-page":e.itemPerPage,search:e.search},on:{"update:page":function(t){e.page=t},"update:itemsPerPage":function(t){e.itemPerPage=t},"update:items-per-page":function(t){e.itemPerPage=t}},scopedSlots:e._u([e._l(e.slotCols,(function(a){return{key:`item.${a.name}`,fn:function({item:s}){return[a.searchable&&s[`${a.name}`]?t("a",{key:`${a.name}_${s["id"]}`,on:{click:e.doSearch}},[e._v(e._s(s[`${a.name}`]))]):e._e(),a.ext&&s[`${a.name}`]?t("a",{key:`${a.name}_${s["id"]}`,on:{click:function(t){return e.extClick(t,s[`${a.name}_ext`])}}},[e._v(e._s(s[`${a.name}`]))]):e._e(),a.multiline&&s[`${a.name}`]?t("div",{key:`${a.name}_${s["id"]}`,staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(s[`${a.name}`]))]):e._e()]}}}))],null,!0)}),t(bs.Z,[t(Ds.Z,{on:{click:e.prevPage}},[e._v("上一页")]),t(Ds.Z,{on:{click:e.nextPage}},[e._v("下一页")])],1)],1)]),t(Vs.Z,{attrs:{inset:""},model:{value:e.sheet,callback:function(t){e.sheet=t},expression:"sheet"}},[t(Qs.Z,{staticClass:"text-center"},[t("div",{staticStyle:{overflow:"scroll",height:"fit-content"}},[t(Xs.Z,{attrs:{rows:"12",readonly:"",filled:"",outlined:"","hide-details":""},model:{value:e.sheetContext,callback:function(t){e.sheetContext=t},expression:"sheetContext"}})],1)])],1)],1)},zs=[];const{localSave:Js,localLoad:el}=a(7941);function tl(e){return t=>{let a=!0;return e&&e.forEach((e=>{e.selected&&(a=a&&e.filterFunc(e.selected,t))})),a}}function al(e){let t=[];return e.forEach(((e,a)=>{e.selected&&t.push(a)})),t}var sl={name:"DataPage",data(){return{search:"",option:0,page:1,itemPerPage:50,sheet:!1,sheetContext:"",selectedLabels:al(this.headerLabels)}},computed:{headers(){return this.headersSource.filter(this.headerFilter).filter((e=>!e.label||this.selectedLabels.includes(this.headerLabels.findIndex((t=>t.value==e.label)))))},items(){return this.$store.getters["isReady"]?this.itemsSource.map(this.mapper).filter(this.dataFilter).filter(tl(this.extraFilters)):[]},slotCols(){return this.headers.filter((e=>e.searchable||e.ext||e.multiline)).map((e=>({name:e.value,searchable:e.searchable,ext:e.ext,multiline:e.multiline})))}},methods:{doSearch(e){this.search=e.target.innerText},extClick(e,t){this.sheetContext=t(),this.sheet=!0},settingChanged(){const e={};e["selectedLabels"]=this.selectedLabels,Js(`setting::${this.name}`,e)},nextPage(){this.page*this.itemPerPage>=this.items.length||(this.page=this.page+1)},prevPage(){this.page<=1||(this.page=this.page-1)}},created(){if(this.name)try{const e=el(`setting::${this.name}`);e&&(this.selectedLabels=e["selectedLabels"])}catch(e){console.log(e)}},props:{name:String,headersSource:Array,itemsSource:Array,headerLabels:Array,mapper:Function,headerFilter:{Function:Function,default:()=>()=>!0},dataFilter:{Function:Function,default:()=>()=>!0},extraFilters:Array}},ll=sl,nl=(0,xs.Z)(ll,Ws,zs,!1,null,"213c6ac4",null),rl=nl.exports,il={name:"TabDataPage",data(){return{selectedGroup:this.tabs.length>0?this.tabs[0].value:"",headerFilter:e=>"ALL"==e.group||e.group.split("|").includes(this.selectedGroup),dataFilter:e=>e.tabGroup&&e.tabGroup.split("|").includes(this.selectedGroup)}},computed:{selectedTab(){return this.tabs.find((e=>e.value==this.selectedGroup))},searchableCol(){return this.headers.filter((e=>e.searchable)).map((e=>e.value))},extraFilters(){return this.selectedTab.dataFilters}},methods:{tabChange(e){const t=this.tabs[e];this.selectedGroup=t.value,this.$emit("tabChange",t.value)}},props:{name:String,tabs:Array,headersSource:Array,itemsSource:Array,headerLabels:Array,mapper:Function},components:{DataPage:rl}},ol=il,cl=(0,xs.Z)(ol,Ts,Bs,!1,null,"31d1e96b",null),ul=cl.exports;function dl(e,t,a,s,l){return{group:e,label:t,text:a,value:s,groupable:!1,...l}}function fl(e,t){return e&&0!=e.length?e.reduce(((e,a,s)=>(s%t===0&&e.push([]),e[e.length-1].push(a),e)),[]).map((e=>e.join("， "))).join("\n"):""}const hl=[{title:"武功秘籍",value:"BOOK",dataFilters:[{type:"select",label:"秘籍种类",value:["拳掌","御剑","兵器","指腿","暗毒","内功","轻功","制药","特殊","全部"],selected:"全部",filterFunc:(e,t)=>{if("全部"==e)return!0;if(0!=t.prd_mtl)return"制药"==e;if(t.targetSkill){const a=d(t.targetSkill),s=yt(a.type);return s==e}return"特殊"==e}},{type:"select",label:"秘籍标签",value:["常规","限定","高资","低资","用毒","双系","全部"],selected:"全部",filterFunc:(e,t)=>"全部"==e||("常规"==e?0==t["tags"]?.length:t["tags"]?.includes(e))}]},{title:"神兵宝甲",value:"EQUIP",dataFilters:[{type:"select",label:"装备位置",value:["武器","防具","骑宠","全部"],selected:"全部",filterFunc:(e,t)=>"全部"===e||t.position==e},{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"全部",filterFunc:(e,t)=>"全部"==e||("只看氪金"==e?t.ke:!t.ke)}]},{title:"灵丹妙药",value:"MEDIC"},{title:"伤人暗器",value:"THROWN"},{title:"剧情物品",value:"STORY"}],ml={targetSkill:It,req_hero1:Zt,req_hero2:Zt,prd_mtl:Et,prd_item1:Et,prd_item2:Et,prd_item3:Et,prd_item4:Et,useSkill:It,type:_t,req_gender:st,req_family:rt,req_party:ot,req_mpKind:ht,attr_mpKind:mt,position:ut,debuff_type:bt,flag_newbie:tt,flag_forge:tt},pl={0:"STORY",1:"EQUIP",2:"BOOK",3:"MEDIC",4:"THROWN"},gl=[dl("ALL","","序号","id",{align:"start"}),dl("ALL","","名称","name"),dl("EQUIP","","装备位置","position"),dl("BOOK","","练出武功","targetSkill"),dl("BOOK","","级别","level"),dl("BOOK","","内力性质","req_mpKind",{searchable:!0}),dl("ALL","desc","物品说明","desc"),dl("BOOK|EQUIP","req","需性别","req_gender",{searchable:!0}),dl("BOOK|EQUIP","req","需血族","req_family",{searchable:!0}),dl("BOOK|EQUIP","req","需门派","req_party",{searchable:!0}),dl("BOOK|EQUIP","req","需特殊人物1","req_hero1",{searchable:!0}),dl("BOOK|EQUIP","req","需特殊人物2","req_hero2",{searchable:!0}),dl("BOOK","req","需资质","req_itl"),dl("BOOK|EQUIP","req","需拳掌","req_fs"),dl("BOOK|EQUIP","req","需御剑","req_ss"),dl("BOOK|EQUIP","req","需兵器","req_ws"),dl("BOOK|EQUIP","req","需指腿","req_rs"),dl("BOOK|EQUIP|THROWN","req","需暗毒","req_ts"),dl("BOOK|EQUIP|MEDIC","req","需内力","req_mp"),dl("BOOK|EQUIP","req","需攻击","req_atk"),dl("BOOK","req","需轻功","req_agi"),dl("BOOK","req","需医疗","req_heal"),dl("BOOK","req","需用毒","req_poiMk"),dl("BOOK|MEDIC|THROWN","attr","加生命","attr_hp"),dl("BOOK|MEDIC","attr","加血量","attr_hpMax"),dl("BOOK|MEDIC","attr","加内力","attr_mp"),dl("BOOK|MEDIC","attr","加功力","attr_mpMax"),dl("MEDIC","attr","加体力","attr_vgr"),dl("MEDIC|THROWN","attr","中毒/解毒","attr_poi"),dl("MEDIC","attr","加气格","attr_eng"),dl("MEDIC","attr","受伤度","attr_inj"),dl("BOOK|EQUIP","attr","总属性","attr_all"),dl("BOOK","attr","总系数","attr_total_series"),dl("BOOK","attr","最高系数","attr_max_series"),dl("BOOK|EQUIP|MEDIC","attr","加攻击","attr_atk"),dl("BOOK|EQUIP|MEDIC","attr","加防御","attr_def"),dl("BOOK|EQUIP|MEDIC","attr","加轻功","attr_agi"),dl("BOOK|EQUIP|MEDIC","attr","加拳掌","attr_fs"),dl("BOOK|EQUIP|MEDIC","attr","加御剑","attr_ss"),dl("BOOK|EQUIP|MEDIC","attr","加兵器","attr_ws"),dl("BOOK|EQUIP|MEDIC","attr","加指腿","attr_rs"),dl("BOOK|EQUIP|MEDIC","attr","加暗毒","attr_ts"),dl("BOOK","attr","加医疗","attr_heal"),dl("BOOK","attr","加用毒","attr_poiMk"),dl("BOOK|EQUIP","attr","加解毒","attr_poiRd"),dl("BOOK|EQUIP|MEDIC","attr","加抗毒","attr_poiRs"),dl("BOOK|EQUIP","attr","加带毒","attr_poiAt"),dl("MEDIC","attr","加资质","attr_itl"),dl("MEDIC|BOOK","attr","加武常","attr_klg"),dl("BOOK","attr","改变内力性质","attr_mpKind"),dl("BOOK","attr","改变攻击次数","attr_atkCnt"),dl("EQUIP","spec","使用武功","useSkill"),dl("EQUIP|MEDIC|THROWN","spec","附加状态","debuff_type"),dl("EQUIP|MEDIC|THROWN","spec","附加状态几率","debuff_rate"),dl("EQUIP|MEDIC|THROWN","spec","附加状态回合","debuff_turn"),dl("BOOK|EQUIP|MEDIC|THROWN","spec","出售价格","price"),dl("BOOK","spec","需材料","prd_mtl"),dl("BOOK","spec","炼出物品1","prd_item1"),dl("BOOK","spec","炼出物品2","prd_item2"),dl("BOOK","spec","炼出物品3","prd_item3"),dl("BOOK","spec","炼出物品4","prd_item4"),dl("BOOK","spec","需材料数量1","prd_cnt1"),dl("BOOK","spec","需材料数量2","prd_cnt2"),dl("BOOK","spec","需材料数量3","prd_cnt3"),dl("BOOK","spec","需材料数量4","prd_cnt4"),dl("BOOK","spec","新手光环","flag_newbie"),dl("EQUIP","spec","可打造","flag_forge"),dl("ALL","owner","携带队友","owner_friend",{multiline:!0}),dl("ALL","owner","人数","owner_friend_cnt"),dl("ALL","owner","携带NPC","owner_npc",{multiline:!0}),dl("ALL","owner","人数","owner_npc_cnt"),dl("EQUIP","suit","本土套装","owner_suit_nk",{multiline:!0}),dl("EQUIP","suit","人数","owner_suit_nk_cnt"),dl("EQUIP","suit","氪金套装","owner_suit_ke",{multiline:!0}),dl("EQUIP","suit","人数","owner_suit_ke_cnt")],bl=[{text:"说明",value:"desc"},{text:"需求",value:"req",selected:!0},{text:"属性",value:"attr",selected:!0},{text:"其他",value:"spec",selected:!0},{text:"携带者",value:"owner",selected:!1},{text:"套装",value:"suit",selected:!1}];function vl(e){if(!e)return e;const t={};t["tabGroup"]=pl[e.type],Object.entries(e).forEach((([e,a])=>{t[e]=ml[e]?ml[e](a):a})),t["attr_all"]=_l(e);const a=kl(e);if(t["attr_total_series"]=a[0],t["attr_max_series"]=a[1],e["req_hero1"]>=0){const a=c(e["req_hero1"]);a&&a.ke&&(t["ke"]=1)}return t["owner_friend"]=fl(e["owner_friend"]||[],5),t["owner_friend_cnt"]=e["owner_friend"]?.length||0,t["owner_npc"]=fl(e["owner_npc"]||[],5),t["owner_npc_cnt"]=e["owner_npc"]?.length||0,t["owner_suit_ke"]=fl(e["owner_suit_ke"]||[],5),t["owner_suit_ke_cnt"]=e["owner_suit_ke"]?.length||0,t["owner_suit_nk"]=fl(e["owner_suit_nk"]||[],5),t["owner_suit_nk_cnt"]=e["owner_suit_nk"]?.length||0,t}function _l(e){if(!e)return 0;const t=Number(e["attr_atk"])+Number(e["attr_def"])+Number(e["attr_agi"])+Number(e["attr_fs"])+Number(e["attr_ss"])+Number(e["attr_ws"])+Number(e["attr_rs"])+Number(e["attr_ts"]);return t>0?t:""}function kl(e){if(!e)return[0,0];const t=[e["attr_fs"],e["attr_ss"],e["attr_ws"],e["attr_rs"],e["attr_ts"]];return[t.reduce(((e,t)=>Number(e)+Number(t)),0),Math.max(...t)]}var yl={name:"ItemDataView",data(){return{selectType:"BOOK",tabs:hl,headerLabels:bl,convertValue:vl}},methods:{selectTab(e){this.selectType=e}},computed:{headers(){return gl},items(){return Object.values(this.$store.state.ItemSource)}},components:{TabDataPage:ul}},$l=yl,Ll=(0,xs.Z)($l,Es,Ps,!1,null,"3fb83417",null),xl=Ll.exports,Sl=function(){var e=this,t=e._self._c;return t("div",[t("TabDataPage",{attrs:{name:"skill",tabs:e.tabs,headersSource:e.headers,itemsSource:e.items,mapper:e.convertValue,"header-labels":e.headerLabels},on:{tabChange:e.selectTab}})],1)},Al=[];function wl(e,t){return"全部"==e||("只看氪金"==e?t.ke:!t.ke)}const Cl=[{title:"外功",value:"HAND",dataFilters:[{type:"select",label:"系别",value:["拳掌","御剑","兵器","指腿","暗毒","全部"],selected:"全部",filterFunc:(e,t)=>t["attr_hit"]>0&&("全部"===e||t.type==e)},{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"不看氪金",filterFunc:wl}]},{title:"内功",value:"BODY",dataFilters:[{type:"select",label:"等级",value:["1级","2级","3级","4级","5级","防功","特殊","全部"],selected:"全部",filterFunc:(e,t)=>"全部"===e||t.levelType==e||""==t.levelType&&"特殊"==e},{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"不看氪金",filterFunc:wl}]},{title:"轻功",value:"FOOT",dataFilters:[{type:"select",label:"等级",value:["1级","2级","3级","4级","5级","全部"],selected:"全部",filterFunc:(e,t)=>"全部"===e||t.levelType==e},{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"不看氪金",filterFunc:wl}]},{title:"大绝",value:"EXPL",dataFilters:[{type:"select",label:"系别",value:["拳掌","御剑","兵器","指腿","暗毒","全部"],selected:"拳掌",filterFunc:(e,t)=>"全部"===e||t.type==e},{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"不看氪金",filterFunc:wl}]},{title:"天赋",value:"TALENT",dataFilters:[{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"不看氪金",filterFunc:wl}]},{title:"特技",value:"BUFF",dataFilters:[{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"不看氪金",filterFunc:wl}]},{title:"称号",value:"TITLE",dataFilters:[]}],Zl={trigBy:It,type:yt,levelType:Lt,debuff_type:bt,hurtType:St,rangeType:wt,flag_autoCast:tt},Il={0:"HAND",1:"HAND",2:"HAND",3:"HAND",4:"HAND",5:"BODY",6:"FOOT",7:"TALENT",8:"BUFF",10:"TITLE"},El=[dl("ALL","","序号","id",{align:"start"}),dl("ALL","","名称","name"),dl("ALL","","类型","type"),dl("BODY|TALENT|BUFF","","光环","config_aura"),dl("HAND","","等级","level"),dl("BODY|FOOT","","等级","levelType"),dl("BODY|FOOT|TALENT|BUFF|TITLE","grade","强度分值","grade",{ext:!0}),dl("BODY","grade","内功护体/防功使用分值","grade_up",{ext:!0}),dl("BODY","grade","内功综合分值","grade_mean"),dl("EXPL|BUFF","","所属招式","trigBy"),dl("HAND|EXPL|BUFF","","威力","attrl_power"),dl("BODY|FOOT|TALENT","desc","装备效果","text_equip"),dl("BODY|FOOT|BUFF","desc","使用效果","text_use"),dl("TITLE","desc","称号效果","desc"),dl("BODY|FOOT|TALENT|BUFF","desc","自动生成描述","gen_desc"),dl("HAND|BODY|FOOT|BUFF","desc","出招台词","text_cast"),dl("BUFF","attr","回合数","config_round"),dl("HAND|BODY|FOOT|EXPL|BUFF","attr","消耗气格","attr_costEng"),dl("HAND|BODY|FOOT|EXPL|BUFF","attr","消耗内力","attr_costMp"),dl("HAND|BODY|EXPL|BUFF","attr","出招率","attr_trig"),dl("HAND|BODY|EXPL|BUFF","attr","伤害类型","hurtType"),dl("HAND|BODY|EXPL|BUFF","attr","范围形状","rangeType"),dl("HAND|BODY|EXPL|BUFF","attr","移动范围","attrl_moveRange"),dl("HAND|BODY|EXPL|BUFF","attr","杀伤范围","attrl_hitRange"),dl("HAND|BODY|FOOT|EXPL|BUFF","attr","命中率","attr_hit"),dl("HAND|EXPL","attr","暴击率","attr_crit"),dl("HAND|EXPL","attr","双击率","attr_double"),dl("HAND|EXPL","attr","自伤系数","attr_selfHurt"),dl("HAND|BODY|EXPL","attr","造成中毒","attr_poison"),dl("HAND|EXPL","attr","杀命","attr_decHpMax"),dl("HAND|EXPL","attr","杀体","attr_decVigor"),dl("HAND|BODY|EXPL","attr","杀内","attrl_decMp"),dl("HAND|BODY|EXPL","attr","吸内","attrl_incMp"),dl("BODY|TALENT|BUFF","attr","我方光环范围","attr_selfRange"),dl("BODY|TALENT|BUFF","attr","敌方光环范围","attr_enemyRange"),dl("HAND|EXPL","attr","附加/解除状态","debuff_type"),dl("HAND|EXPL","attr","状态几率","debuff_rate"),dl("HAND|EXPL","attr","状态回合","debuff_turn"),dl("BODY|EXPL|BUFF","attr","满气自动释放","flag_autoCast"),dl("ALL","owner","拥有队友","owner_friend",{multiline:!0}),dl("ALL","owner","拥有人数","owner_friend_cnt"),dl("ALL","owner","拥有NPC","owner_npc",{multiline:!0}),dl("ALL","owner","拥有人数","owner_npc_cnt"),dl("BODY|FOOT|TALENT","suit","本土套装","owner_suit_nk",{multiline:!0}),dl("BODY|FOOT|TALENT","suit","人数","owner_suit_nk_cnt"),dl("BODY|FOOT|TALENT","suit","氪金套装","owner_suit_ke",{multiline:!0}),dl("BODY|FOOT|TALENT","suit","人数","owner_suit_ke_cnt"),dl("HAND|EXPL","relation","武功配合","relation_match",{multiline:!0}),dl("HAND|EXPL","relation","外功出招","relation_trigger",{multiline:!0})],Pl=[{text:"分值",value:"grade",selected:!0},{text:"说明",value:"desc",selected:!0},{text:"属性",value:"attr",selected:!0},{text:"拥有者",value:"owner",selected:!1},{text:"套装",value:"suit",selected:!1},{text:"出招配合",value:"relation",selected:!1}];function Fl(e){const t={};e.type>=0&&e.type<=4?e.trigBy||e.flag_autoCast?t.tabGroup="EXPL":t.tabGroup="HAND":t["tabGroup"]=Il[e.type],Object.entries(e).forEach((([e,a])=>{t[e]=Zl[e]?Zl[e](a):a}));const a=b(e.id,e.type);return t["owner_friend"]=fl(a?a.owner_friend:[],5),t["owner_friend_cnt"]=a?a.owner_friend?.length:0,t["owner_npc"]=fl(a?a.owner_npc:[],5),t["owner_npc_cnt"]=a?a.owner_npc?.length:0,t["owner_suit_nk"]=fl(a?a.owner_suit_nk:[],5),t["owner_suit_nk_cnt"]=a?a.owner_suit_nk?.length:0,t["owner_suit_ke"]=fl(a?a.owner_suit_ke:[],5),t["owner_suit_ke_cnt"]=a?a.owner_suit_ke?.length:0,t["relation_match"]=fl(a?a["match"]:[],1),t["relation_trigger"]=fl(a?a["trigger"]:[],1),t}var Ol={name:"SkillDataView",data(){return{selectType:"HAND",tabs:Cl,headerLabels:Pl,convertValue:Fl}},methods:{selectTab(e){this.selectType=e}},computed:{headers(){return El},items(){return Object.values(this.$store.state.SkillSource).concat(Object.values(this.$store.state.TitleConfigSource))}},components:{TabDataPage:ul}},Tl=Ol,Bl=(0,xs.Z)(Tl,Sl,Al,!1,null,"378d26c1",null),Vl=Bl.exports,Dl=function(){var e=this,t=e._self._c;return t("div",[t("DataPage",{attrs:{name:"suit",headersSource:e.headers,itemsSource:e.items,mapper:e.convertValue,"header-labels":e.headerLabels,"extra-filters":e.dataFilters}})],1)},jl=[];const Kl={weaponId:Et,armorId:Et,petId:Et,bsId:It,fsId:It,talentId:It},Gl=[{text:"配置",value:"def",selected:!0},{text:"套装属性",value:"attr",selected:!0},{text:"总属性",value:"attr_total",selected:!1},{text:"拥有者",value:"owner",selected:!1}],Rl=[{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"全部",filterFunc:(e,t)=>{if("全部"==e)return!0;const a=[t["weaponId"],t["armorId"],t["petId"]];for(const s of a){if(null==s)continue;const t=h(s);if(t["ke"]||t["req_hero1"]>0&&c(t["req_hero1"]).ke)return"只看氪金"==e}return"不看氪金"==e}}],ql=[dl("","","序号","id",{align:"start"}),dl("","","名称","name"),dl("","def","武器","weaponId",{searchable:!0}),dl("","def","防具","armorId",{searchable:!0}),dl("","def","骑宠","petId",{searchable:!0}),dl("","def","内功","bsId",{searchable:!0}),dl("","def","轻功","fsId",{searchable:!0}),dl("","def","天赋","talentId",{searchable:!0}),dl("","attr","套装属性","suitAttr"),dl("","attr","攻击","atk"),dl("","attr","防御","def"),dl("","attr","轻功","agi"),dl("","attr","拳掌","fs"),dl("","attr","御剑","ss"),dl("","attr","兵器","ws"),dl("","attr","指腿","rs"),dl("","attr","暗毒","ts"),dl("","attr_total","总属性","totalAttr"),dl("","attr_total","总攻击","total_atk"),dl("","attr_total","总防御","total_def"),dl("","attr_total","总轻功","total_agi"),dl("","attr_total","总拳掌","total_fs"),dl("","attr_total","总御剑","total_ss"),dl("","attr_total","总兵器","total_ws"),dl("","attr_total","总指腿","total_rs"),dl("","attr_total","总暗毒","total_ts"),dl("","owner","拥有队友","owner_friend",{multiline:!0}),dl("","owner","拥有人数","owner_friend_cnt"),dl("","owner","拥有NPC","owner_npc",{multiline:!0}),dl("","owner","拥有人数","owner_npc_cnt")];function Ml(e){if(!e)return e;const t={};Object.entries(e).forEach((([e,a])=>{t[e]=Kl[e]?Kl[e](a):a})),t["suitAttr"]=Nl(e),t["totalAttr"]=t["suitAttr"]+Hl(e);const a=["atk","def","agi","fs","ss","ws","rs","ts"];return a.forEach((a=>{t["total_"+a]=Number(e[a])+Number(f(e["weaponId"])["attr_"+a])+Number(f(e["armorId"])["attr_"+a])+Number(f(e["petId"])["attr_"+a]),0==t["total_"+a]&&(t["total_"+a]="")})),t["owner_friend"]=fl(e["owner_friend"],5),t["owner_friend_cnt"]=e["owner_friend"]?.length,t["owner_npc"]=fl(e["owner_npc"],5),t["owner_npc_cnt"]=e["owner_npc"]?.length,t}function Nl(e){return Number(e["atk"])+Number(e["def"])+Number(e["agi"])+Number(e["fs"])+Number(e["ss"])+Number(e["ws"])+Number(e["rs"])+Number(e["ts"])}function Hl(e){return _l(f(e["weaponId"]))+_l(f(e["armorId"]))+_l(f(e["petId"]))}var Ul={name:"SuitDataView",data(){return{headerLabels:Gl,dataFilters:Rl,convertValue:Ml}},computed:{headers(){return ql},items(){return Object.values(this.$store.state.SuitSource)}},components:{DataPage:rl}},Ql=Ul,Yl=(0,xs.Z)(Ql,Dl,jl,!1,null,"500dd8aa",null),Xl=Yl.exports,Wl=function(){var e=this,t=e._self._c;return t("div",[t("DataPage",{attrs:{name:"skill-config",tabs:e.tabs,headersSource:e.headers,itemsSource:e.items,mapper:e.convertValue,"header-labels":e.headerLabels}})],1)},zl=[];function Jl(e,t){if("全部"==e)return!0;const a=u(t.skillId);return"只看氪金"==e?a.ke:!a.ke}const en=[{title:"内功",value:"BODY",dataFilters:[{type:"select",label:"等级",value:["1级","2级","3级","4级","5级","防功","全部"],selected:"全部",filterFunc:(e,t)=>"全部"===e||t.levelType==e||""==t.levelType&&"特殊"==e}]},{title:"轻功",value:"FOOT",dataFilters:[{type:"select",label:"等级",value:["1级","2级","3级","4级","5级","全部"],selected:"全部",filterFunc:(e,t)=>"全部"===e||t.levelType==e}]},{title:"天赋",value:"TALENT",dataFilters:[{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"全部",filterFunc:Jl}]},{title:"特技",value:"BUFF",dataFilters:[{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"全部",filterFunc:Jl}]}],tn={5:"BODY",6:"FOOT",7:"TALENT",8:"BUFF"},an=[{text:"设定",value:"def",selected:!0},{text:"属性",value:"attr",selected:!0},{text:"加成",value:"factor",selected:!0},{text:"几率",value:"rate",selected:!0},{text:"距离",value:"distance",selected:!0},{text:"异常",value:"debuff",selected:!0},{text:"特殊",value:"ext",selected:!0}],sn=[dl("ALL","","武功序号","skillId",{align:"start"}),dl("ALL","","名称","name"),dl("BODY|FOOT","","等级","levelType"),dl("ALL","def","效果类别","skillType",{groupable:!0}),dl("ALL","def","效果回合数","round"),dl("ALL","def","己方益害","selfAdv"),dl("ALL","def","敌方益害","enemyAdv"),dl("ALL","attr","自身攻击","bodyAtk"),dl("ALL","attr","自身防御","bodyDef"),dl("ALL","attr","自身轻功","bodyAgi"),dl("ALL","attr","战场攻击","battleAtk"),dl("ALL","attr","战场防御","battleDef"),dl("ALL","attr","战场轻功","battleAgi"),dl("ALL","attr","行动时序","battleAsp"),dl("ALL","attr","敌方攻击","enemyAtk"),dl("ALL","attr","敌方防御","enemyDef"),dl("ALL","attr","敌方轻功","enemyAgi"),dl("ALL","attr","敌方时序","enemyAsp"),dl("ALL","factor","命中加成","hitInc"),dl("ALL","factor","专系命中加成","specHitInc"),dl("ALL","factor","命中减成","hitDec"),dl("ALL","factor","专系命中减成","specHitDec"),dl("ALL","factor","威力加成","powerInc"),dl("ALL","factor","专系威力加成","specPowerInc"),dl("ALL","factor","威力减成","powerDec"),dl("ALL","factor","专系威力减成","specPowerDec"),dl("ALL","factor","伤害加成","damageInc"),dl("ALL","factor","专系伤害加成","specDamageInc"),dl("ALL","factor","伤害减成","damageDec"),dl("ALL","factor","专系伤害减成","specDamageDec"),dl("ALL","factor","受伤度加成","injuryInc"),dl("ALL","factor","受伤度减成","injuryDec"),dl("ALL","rate","外功出招","castInc"),dl("ALL","rate","专系外功出招","specCastInc"),dl("ALL","rate","双击","doubleHit"),dl("ALL","rate","暴击","critical"),dl("ALL","rate","吸血","bloodSuck"),dl("ALL","rate","反震","damageReflect"),dl("ALL","rate","反弹","damageCounter"),dl("ALL","rate","挪移","damageTransfer"),dl("ALL","distance","移动距离","moveDistance"),dl("ALL","distance","武功移动","attackDistance"),dl("ALL","distance","武功范围","attackRange"),dl("ALL","debuff","免疫","deBuffImmune"),dl("ALL","debuff","造成异常状态","deBuffMake"),dl("ALL","ext","特殊词条","ext")];function ln(e){const t={};Object.entries(e).forEach((([e,a])=>{t[e]=0!=a?a:""}));const a=u(e["skillId"]);return a?(t["tabGroup"]=tn[a.type]||"OTHER",t["name"]=a["name"],t["levelType"]=Lt(a["levelType"]),e["specHitIncType"]&&(t["specHitInc"]=`${e["specHitIncType"]}${e["specHitInc"]}`),e["specHitDecType"]&&(t["specHitDec"]=`${e["specHitDecType"]}${e["specHitDec"]}`),e["specPowerIncType"]&&(t["specPowerInc"]=`${e["specPowerIncType"]}${e["specPowerInc"]}`),e["specPowerDecType"]&&(t["specPowerDec"]=`${e["specPowerDecType"]}${e["specPowerDec"]}`),e["specDamageIncType"]&&(t["specDamageInc"]=`${e["specDamageIncType"]}${e["specDamageInc"]}`),e["specDamageDecType"]&&(t["specDamageDec"]=`${e["specDamageDecType"]}${e["specDamageDec"]}`),e["specCastIncType"]&&(t["specCastInc"]=`${e["specCastIncType"]}${e["specCastInc"]}`),e["deBuffImmune"]&&(t["deBuffImmune"]=nn(e["deBuffImmune"])),e["deBuffMake"]&&(t["deBuffMake"]=`[${nn(e["deBuffMake"])}]${e["deBuffRound"]}回合+${e["deBuffRate"]}%`),e["ext"]&&(t["ext"]=Ee(e["ext"])),t):null}function nn(e){const t=e.split(" ").map((e=>e.trim()));return t.join("/")}var rn={name:"SkillConfigView",data(){return{tabs:en,headerLabels:an,convertValue:ln}},computed:{headers(){return sn},items(){return this.$store.state.SkillConfigSource}},components:{DataPage:ul}},on=rn,cn=(0,xs.Z)(on,Wl,zl,!1,null,"2d9d4170",null),un=cn.exports,dn=function(){var e=this,t=e._self._c;return t("div",[t("TabDataPage",{attrs:{name:"hero",tabs:e.tabs,headersSource:e.headers,itemsSource:e.items,mapper:e.convertValue,"header-labels":e.headerLabels},on:{tabChange:e.selectTab}})],1)},fn=[];const hn=["主角","女主","女儿","飞雪","连城","天龙","射雕","白马","鹿鼎","笑傲","书剑","神雕","侠客","倚天","碧血","鸳鸯"],mn=[{title:"NPC",value:"NPC",dataFilters:[{type:"select",label:"等级段",value:[5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,"全部"],selected:"全部",filterFunc:(e,t)=>"全部"==e||t.level>e-5&&t.level<=e},{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"全部",filterFunc:(e,t)=>"全部"==e||("只看氪金"==e?t.ke:!t.ke)}]},{title:"队友",value:"FRIEND",dataFilters:[{type:"select",label:"周目",value:[1,2,3,4,5,6,"全部"],selected:"全部",filterFunc:(e,t)=>"全部"==e||t["roleRound"]==e},{type:"select",label:"分组",value:["星阵队友","本土复制人","非氪金复制人","氪金复制人","全部"],selected:"全部",filterFunc:(e,t)=>{if("全部"==e)return!0;if("氪金复制人"==e)return t.ke;if("非氪金复制人"==e)return!t.ke;if(t.ke)return!1;const a=$(t.id),s=a&&hn.includes(a["group"])&&"临时"!=a["branch"];return"星阵队友"==e?s:!s}}]}],pn={equip_wp:Et,equip_ar:Et,equip_pt:Et,equip_bs:It,equip_fs:It,talent:It,mastery:It,spec_copyHero:Zt,gender:st,family:rt,party:ot,mpKind:ft,attr_atkCnt:pt,flag_hide:tt},gn=[dl("ALL","","序号","id",{align:"start"}),dl("ALL","","姓名","name"),dl("ALL","","等级","level",{groupable:!0}),dl("ALL","base","称号","nickname"),dl("ALL","base","头像","photo"),dl("ALL","base","性别","gender",{searchable:!0}),dl("ALL","base","血族","family",{searchable:!0}),dl("ALL","base","门派","party",{searchable:!0}),dl("ALL","base","内力性质","mpKind",{searchable:!0}),dl("ALL","def","称号模板","title",{searchable:!0}),dl("ALL","effect","称号效果","titleEffect"),dl("ALL","def","天赋","talent",{searchable:!0}),dl("ALL","effect","天赋效果","talentEffect"),dl("ALL","def","专精武功","mastery",{searchable:!0}),dl("ALL","def","专精威力","masteryPower"),dl("ALL","def","内功","equip_bs",{searchable:!0}),dl("ALL","effect","内功效果","bodySkillEffect"),dl("ALL","def","轻功","equip_fs",{searchable:!0}),dl("ALL","effect","轻功效果","footSkillEffect"),dl("ALL","def","装备武器","equip_wp",{searchable:!0}),dl("ALL","def","装备防具","equip_ar",{searchable:!0}),dl("ALL","def","装备骑宠","equip_pt",{searchable:!0}),dl("ALL","def","套装","suit",{searchable:!0}),dl("ALL","def","套装天赋","suit_talent",{searchable:!0}),dl("ALL","effect","套装天赋效果","suitTalentEffect"),dl("ALL","def","套装内功","suit_bs",{searchable:!0}),dl("ALL","effect","套装内功效果","suitBodySkillEffect"),dl("ALL","def","套装轻功","suit_fs",{searchable:!0}),dl("ALL","effect","套装轻功效果","suitFootSkillEffect"),dl("ALL","grade","称号分值","grade_title",{ext:!0}),dl("ALL","grade","天赋分值","grade_talent",{ext:!0}),dl("ALL","grade","内功分值","grade_bs",{ext:!0}),dl("ALL","grade","轻功分值","grade_fs",{ext:!0}),dl("ALL","grade","特技分值","grade_ss",{ext:!0}),dl("ALL","grade","触发特技分值","grade_ts",{ext:!0}),dl("ALL","grade","总分值","grade_total",{ext:!0}),dl("ALL","grade_ke","称号分值K","grade_ke_title"),dl("ALL","grade_ke","天赋分值K","grade_ke_talent"),dl("ALL","grade_ke","特技分值K","grade_ke_ss"),dl("ALL","grade_ke","触发特技分值K","grade_ke_ts"),dl("ALL","grade_ke","总分值K","grade_ke",{ext:!0}),dl("ALL","attr","血量","attr_hpMax"),dl("ALL","attr","功力","attr_mpMax"),dl("ALL","attr","攻击","attr_atk"),dl("ALL","attr","防御","attr_def"),dl("ALL","attr","轻功","attr_agi"),dl("ALL","attr","三维和","attr_3d"),dl("ALL","attr","拳掌","attr_fs"),dl("ALL","attr","御剑","attr_ss"),dl("ALL","attr","兵器","attr_ws"),dl("ALL","attr","指腿","attr_rs"),dl("ALL","attr","暗毒","attr_ts"),dl("ALL","attr","医疗","attr_heal"),dl("ALL","attr","用毒","attr_poiMk"),dl("ALL","attr","解毒","attr_poiRd"),dl("ALL","attr","抗毒","attr_poiRs"),dl("ALL","attr","带毒","attr_poiAt"),dl("ALL","attr","武学常识","attr_klg"),dl("ALL","attr","攻击次数","attr_atkCnt",{searchable:!0}),dl("ALL","attr","资质","attr_itl"),dl("ALL","attr","体质","attr_str"),dl("ALL","attr","品德","attr_mrl"),dl("ALL","skill","武功格数","skill_cnt"),dl("ALL","skill","1格武功","skill_1",{searchable:!0}),dl("ALL","skill","2格武功","skill_2",{searchable:!0}),dl("ALL","skill","3格武功","skill_3",{searchable:!0}),dl("ALL","skill","4格武功","skill_4",{searchable:!0}),dl("ALL","skill","5格武功","skill_5",{searchable:!0}),dl("ALL","skill","6格武功","skill_6",{searchable:!0}),dl("ALL","skill","7格武功","skill_7",{searchable:!0}),dl("ALL","skill","8格武功","skill_8",{searchable:!0}),dl("ALL","skill","9格武功","skill_9",{searchable:!0}),dl("ALL","skill","10格武功","skill_10",{searchable:!0}),dl("ALL","skill2","11格武功","skill_11",{searchable:!0}),dl("ALL","skill2","12格武功","skill_12",{searchable:!0}),dl("ALL","skill2","13格武功","skill_13",{searchable:!0}),dl("ALL","skill2","14格武功","skill_14",{searchable:!0}),dl("ALL","skill2","15格武功","skill_15",{searchable:!0}),dl("ALL","skill2","16格武功","skill_16",{searchable:!0}),dl("ALL","skill2","17格武功","skill_17",{searchable:!0}),dl("ALL","skill2","18格武功","skill_18",{searchable:!0}),dl("ALL","skill2","19格武功","skill_19",{searchable:!0}),dl("ALL","skill2","20格武功","skill_20",{searchable:!0}),dl("ALL","skill2","21格武功","skill_21",{searchable:!0}),dl("ALL","skill2","22格武功","skill_22",{searchable:!0}),dl("ALL","skill2","23格武功","skill_23",{searchable:!0}),dl("ALL","skill2","24格武功","skill_24",{searchable:!0}),dl("ALL","skill2","25格武功","skill_25",{searchable:!0}),dl("ALL","skill2","26格武功","skill_26",{searchable:!0}),dl("ALL","skill2","27格武功","skill_27",{searchable:!0}),dl("ALL","skill2","28格武功","skill_28",{searchable:!0}),dl("ALL","skill2","29格武功","skill_29",{searchable:!0}),dl("ALL","skill2","30格武功","skill_30",{searchable:!0}),dl("ALL","item","1格物品","item_1",{searchable:!0}),dl("ALL","item","2格物品","item_2",{searchable:!0}),dl("ALL","item","3格物品","item_3",{searchable:!0}),dl("ALL","item","4格物品","item_4",{searchable:!0}),dl("ALL","status","生命","status_hp"),dl("ALL","status","内力","status_mp"),dl("ALL","status","体力","status_vigour"),dl("ALL","status","受伤","status_injury"),dl("ALL","status","中毒","status_poison"),dl("ALL","status","经验","status_exp"),dl("ALL","status","根骨","status_bone"),dl("FRIEND","spec","卡片周目","roleRound"),dl("FRIEND","spec","幽灵队友周目","ghostMember"),dl("ALL","spec","复制人物","spec_copyHero"),dl("ALL","spec","明玉丹额度","status_myd"),dl("ALL","spec","传奇隐藏","flag_hide"),dl("ALL","spec","结局编号","spec_ending"),dl("ALL","battle","星阵出战","battle_attend_star",{multiline:!0}),dl("ALL","battle","结局出战","battle_attend_end",{multiline:!0}),dl("ALL","battle","大战出战","battle_attend_war",{multiline:!0}),dl("ALL","battle","氪家出战","battle_attend_ke",{multiline:!0})],bn=[{text:"基本",value:"base",selected:!0},{text:"配置",value:"def",selected:!0},{text:"配置效果",value:"effect"},{text:"配置分值",value:"grade"},{text:"氪版配置分值",value:"grade_ke"},{text:"属性",value:"attr",selected:!0},{text:"武功",value:"skill",selected:!0},{text:"更多武功",value:"skill2"},{text:"物品",value:"item"},{text:"状态",value:"status"},{text:"其他",value:"spec",selected:!0},{text:"出战",value:"battle"}];function vn(e){if(!e)return e;const t={};t["tabGroup"]=e["friend"]?"FRIEND":"NPC",Object.entries(e).forEach((([e,a])=>{t[e]=pn[e]?pn[e](a):a})),t["attr_3d"]=t["attr_atk"]+t["attr_def"]+t["attr_agi"],t["suit_bs"]=It(e["suit_bs"]),t["suit_fs"]=It(e["suit_fs"]),t["suit_talent"]=It(e["suit_talent"]);let a=0;for(let n=0;n<30;n++){const s=e["skills"][n];if(s["skill"]){const e=1+Math.floor(s["exp"]/100);t["skill_"+(n+1)]=`${It(s["skill"])}(${e}级)`,a++}}t["skill_cnt"]=a;for(let n=0;n<4;n++){const a=e["items"][n];a["item"]&&a["item"]>0&&(t["item_"+(n+1)]=`${Et(a["item"])}*${a["amount"]}`)}e["equip_bs"]>0&&(t["bodySkillEffect"]=u(e["equip_bs"])["text_equip"]),e["equip_fs"]>0&&(t["footSkillEffect"]=u(e["equip_fs"])["text_equip"]),e["talent"]>0&&(t["talentEffect"]=u(e["talent"])["text_equip"]),t["suit_bs"]&&(t["suitBodySkillEffect"]=u(e["suit_bs"])["text_equip"]),t["suit_fs"]&&(t["suitFootSkillEffect"]=u(e["suit_fs"])["text_equip"]),t["suit_talent"]&&(t["suitTalentEffect"]=u(e["suit_talent"])["text_equip"]);const s=g(e["title"]);s?(t["titleEffect"]=s["desc"],t["title"]=`[${e["title"]}]${s["name"]}`):t["title"]=`[${e["title"]}](未定义)`,t["masteryPower"]=kn(e),t["grade_talent"]=e["grade_talent"].toFixed(2),t["grade_talent_ext"]=_n(e["grade_talent_detail"]),e["grade_title"]&&(t["grade_title"]=e["grade_title"].toFixed(2),t["grade_title_ext"]=_n(e["grade_title_detail"])),t["grade_bs"]=e["grade_bs"].toFixed(2),t["grade_bs_ext"]=_n(e["grade_bs_detail"]),t["grade_fs"]=e["grade_fs"].toFixed(2),t["grade_fs_ext"]=_n(e["grade_fs_detail"]),t["grade_ss"]=e["grade_ss"].toFixed(2),t["grade_ss_ext"]=_n(e["grade_ss_detail"]),t["grade_ts"]=e["grade_ts"].toFixed(2),t["grade_ts_ext"]=_n(e["grade_ts_detail"]),t["grade_ke"]=e["grade_ke"].toFixed(2),t["grade_ke_ext"]=_n(e["grade_ke_detail"]),t["grade_ke_title"]=Number(e["grade_ke_title"]||0).toFixed(2),t["grade_ke_talent"]=Number(e["grade_ke_talent"]||0).toFixed(2),t["grade_ke_ts"]=Number(e["grade_ke_ts"]||0).toFixed(2),t["grade_ke_ss"]=Number(e["grade_ke_ss"]||0).toFixed(2),t["grade_total"]=Number(e["grade_total"]||0).toFixed(2),t["grade_total_ext"]=_n(e["grade_total_detail"]);const l=["star","end","war","ke"];for(let n=0;n<l.length;n++)e["battle_attend_"+l[n]]&&(t["battle_attend_"+l[n]]=yn(e["battle_attend_"+l[n]]));return t}function _n(e){return()=>e.map((e=>1==e.factor?`${e.desc}：${e.grade.toFixed(2)}`:`${e.desc}：${e.grade.toFixed(2)}，系数${e.factor.toFixed(2)}`)).join("\n")}function kn(e){if(!e||!e["mastery"])return 0;const t=u(e["mastery"]);let a=1.2*t["attrl_power"];const s=[],l=e=>{e>0&&s.push(e)},n=[],r=e=>{e>0&&n.push(e)};l(e["equip_bs"]),l(e["equip_fs"]),l(e["suit_bs"]),l(e["suit_fs"]),r(e["equip_wp"]),r(e["equip_ar"]),r(e["equip_pt"]);const i=v([e["mastery"]]);return i.forEach((e=>{"skill"==e.type?s.includes(e["skillId"])&&(a+=e["power"]):n.includes(e["itemId"])&&(a+=e["power"])})),Math.round(a)}function yn(e){const t=e.map((e=>`[${e}]${x(e)["name"]}`)).reduce(((e,t,a)=>(a%5===0&&e.push([]),e[e.length-1].push(t),e)),[]).map((e=>e.join("， ")));return t.join("\n")}var $n={name:"HeroDataView",data(){return{selectType:"NPC",tabs:mn,headerLabels:bn,convertValue:vn}},methods:{selectTab(e){this.selectType=e}},computed:{headers(){return gn},items(){return Object.values(this.$store.state.HeroSource)}},components:{TabDataPage:ul}},Ln=$n,xn=(0,xs.Z)(Ln,dn,fn,!1,null,"3b417160",null),Sn=xn.exports,An=function(){var e=this,t=e._self._c;return t(vs.Z,{staticStyle:{width:"95%","min-width":"95%",overflow:"auto"},attrs:{fluid:"","grid-list-md":""}},[t("DataPage",{attrs:{name:"event","headers-source":e.headers,"items-source":e.items,mapper:e.convertValue,"header-labels":e.headerLabels,"extra-filters":e.dataFilters}})],1)},wn=[];const Cn=[{text:"关联",value:"relation",selected:!0},{text:"战斗",value:"battle",selected:!0},{text:"效果",value:"effect",selected:!0}],Zn=[dl("ALL","","编号","id",{searchable:!0}),dl("ALL","","名称","name",{searchable:!0}),dl("ALL","relation","前驱","prev",{multiline:!0}),dl("ALL","relation","后继","next",{multiline:!0}),dl("ALL","battle","战斗","eff_battle",{multiline:!0}),dl("ALL","effect","物品","eff_item",{multiline:!0}),dl("ALL","effect","洗武","eff_xw",{multiline:!0}),dl("ALL","effect","属性","eff_attr",{multiline:!0}),dl("ALL","effect","队伍","eff_team",{multiline:!0}),dl("ALL","effect","条件","eff_condition",{multiline:!0}),dl("ALL","effect","任务","eff_quest",{multiline:!0}),dl("ALL","effect","其他","eff_other",{multiline:!0})],In=["item","xw","attr","team","condition","battle","quest","other"];function En(e){const t={...e};t["id"]="#"+e["id"],t["prev"]=e["prev"]?.map((e=>`#${e}:${k(e)}`)).join("\n"),t["next"]=e["next"]?.map((e=>`#${e}:${k(e)}`)).join("\n");for(const a of In)e["effects"]&&(t[`eff_${a}`]=e["effects"][a]?.join("\n"));return t}const Pn=[{type:"select",label:"标签",value:["世界","飞雪","连城","天龙","射雕","白马","鹿鼎","笑傲","书剑","神雕","侠客","倚天","碧血","鸳鸯","越女","场景","对话","离队"],selected:"世界",filterFunc:(e,t)=>"全部"==e||t["tags"].includes(e)}];var Fn={name:"EventView",data(){return{convertValue:En,headerLabels:Cn,dataFilters:Pn}},computed:{headers(){return Zn},items(){return Object.values(this.$store.state.EventInfoSource)}},components:{DataPage:rl}},On=Fn,Tn=(0,xs.Z)(On,An,wn,!1,null,"26bfff36",null),Bn=Tn.exports,Vn=function(){var e=this,t=e._self._c;return t("div",[t("TabDataPage",{attrs:{name:"event-group",tabs:e.tabs,headersSource:e.headers,itemsSource:e.items,"header-labels":e.headerLabels,mapper:e.convertValue},on:{tabChange:e.selectTab}})],1)},Dn=[];const jn=[3247,1090,1091,1092];function Kn(e,t){if(jn.includes(e))return!0;const a=Gn(e,t);if(!a)return!1;for(let s=0;s<a.length;s++){const e=a[s],t=/(\w+)\((.*)\)(!*)/,l=t.exec(e),n=l[1],r=l[2].split(","),i=l[3],o=0===i.length;if("36"==n){const e=r[0];if("0-0-122"==e){const e=r[2],t=c(e);if(o&&t&&t.ke)return!0}}}return!1}function Gn(e,t){if(0==t)return null;const a=S(e);if(!a||0===a.length)return null;const s=a[t];if(!s)return null;const l=s.split(";");return l}function Rn(e,t){const a=Gn(e,t);return a?a.map(qn):null}function qn(e){const t=/(\w+)\((.*)\)(!*)/,a=t.exec(e);if(!a)return null;const s=a[1],l=a[2].split(","),n=a[3],r=0===n.length;switch(s){case"4":return Mn(l,r);case"5":return Nn(l,r);case"6":return Hn(l,r);case"9":return Un(l,r);case"11":return Qn(l,r);case"16":return Yn(l,r);case"18":return Xn(l,r);case"20":return Wn(l,r);case"28":return zn(l,r);case"29":return Jn(l,r);case"31":return er(l,r);case"36":return fr(l,r);case"42":return tr(l,r);case"43":return ar(l,r);case"60":return sr(l,r);case"72":return lr(l,r);case"75":return nr(l,r);case"81":return rr(l,r);case"82":return ir(l,r);case"83":return or(l,r);case"86":return cr(l,r);case"87":return ur(l,r);case"89":return dr(l,r)}return null}function Mn(e,t){const a=f(e[0]);if(!a)return null;const s=t?"":"失败";return`物品${a.name}触发${s}`}function Nn(e,t){return"询问战斗选择"+(t?"是":"否")}function Hn(e,t){const a=x(e[0]);return`战斗[${a.id}]${a.name}${t?"胜利":"失败"}`}function Un(e,t){return"询问加入选择"+(t?"是":"否")}function Qn(e,t){return"询问是否选择"+(t?"是":"否")}function Yn(e,t){const a=c(e[0]);return`判断队友[${a.id}]${a.name}在队中${t?"":"失败"}`}function Xn(e,t){const a=f(e[0]);return`判断拥有物品[${a.id}]${a.name}${t?"":"失败"}`}function Wn(e,t){return"判断队伍满"+(t?"":"失败")}function zn(e,t){return`判断品德在[${e[1]}, ${e[2]}]之间${t?"":"失败"}`}function Jn(e,t){const a=c(e[0]);return`判断[${a.id}]${a.name}攻击力在[${e[1]}, ${e[2]}]之间${t?"":"失败"}`}function er(e,t){return`判断银两不小于${e[0]}${t?"":"失败"}`}function tr(e,t){return"判断队伍中有女性"+(t?"":"失败")}function ar(e,t){const a=f(e[0]);return`判断得到过物品[${a.id}]${a.name}${t?"":"失败"}`}function sr(e,t){if("-2"===e[0])return`判断当前场景图块素材为${e[2]}${t?"":"失败"}`;const a=m(e[0]);return`判断场景[${a.id}]${a.name}事件点${e[1]}图块素材为${e[2]}${t?"":"失败"}`}function lr(e,t){const a=f(e[0]);return`判断真实拥有物品[${a.id}]${a.name}${t?"":"失败"}`}function nr(e,t){return`判断战斗回合大于${e[0]}${t?"":"失败"}`}function rr(e,t){return`判断队伍空位不小于${e[0]}${t?"":"失败"}`}function ir(e,t){return`判断周目数不小于${e[0]}${t?"":"失败"}`}function or(e,t){const a=c(e[0]);return`判断人物[${a.id}]${a.name}等级不小于${e[1]}${t?"":"失败"}`}function cr(e,t){const a=x(e[0]);return`NPC战斗[${a.id}]${a.name}${t?"胜利":"失败"}`}function ur(e,t){return"判断非法修改"+(t?"":"失败")}function dr(e,t){return"判断队伍中有男性"+(t?"":"失败")}function fr(e,t){const a=e[0],s=e[1],l=e[2],[n,r]=mr(a,l),i=hr(s,t);return`${n}${i}${r}`}function hr(e,t){if(t)return e;switch(e){case"==":return"!=";case"!=":return"==";case">":return"<=";case"<":return">=";case">=":return"<";case"<=":return">"}return null}function mr(e,t){const a=/(\w+)-(\d+)(?:-(\d+))?/,s=a.exec(e);if(!s)return console.log("parseVariable error"),[];const l=s[1],n=s[2],r=s[3]||0;if("team"==l){let e="";return e="-1"==t?"空":gr("0",t),[`队伍位置${n}`,e]}const i=L(l,r),o=pr(l),c=gr(l,n),u=i?i.name:`偏移${r}`,d=br(t,i.type);return[`${o}.${c}.${u}`,d]}function pr(e){switch(e){case"0":return"人物";case"1":return"物品";case"2":return"场景";case"3":return"武功"}return null}function gr(e,t){let a="";switch(e){case"0":a=c(t)?.name;break;case"1":a=f(t)?.name;break;case"3":a=u(t)?.name;break}return`[${t}]${a}`}function br(e,t){return"hero"==t?gr("0",e):"item"==t?gr("1",e):"skill"==t?gr("3",e):e}const vr=(e,t)=>({type:"select",label:"路线",value:e,selected:t,filterFunc:(e,t)=>{if("全部"==e)return!0;const a=$(t.index);if(!a){const a=c(t.index);return a["ke"]?"氪卡"==e:"NPC"==e}return a.group==e}}),_r=(e,t)=>({type:"select",label:"类型",value:e,selected:t,filterFunc:(e,t)=>"全部"==e||t.op==e}),kr={type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"全部",filterFunc:(e,t)=>"全部"==e||("只看氪金"==e?t.ke:!t.ke)},yr=["主角","女主","女儿","飞雪","连城","天龙","射雕","白马","鹿鼎","笑傲","书剑","神雕","侠客","倚天","碧血","鸳鸯","男队友","NPC","女卡","男卡","氪卡","全部"],$r=[{title:"洗武",value:"xw",dataFilters:[vr(yr,"全部"),_r(["洗武功","洗天赋","洗专精","挂内功","挂轻功","全部"],"全部"),kr]},{title:"属性",value:"attr",dataFilters:[vr(yr,"全部"),_r(["改变生命","改变内力","改变攻击","改变防御","改变轻功","改变五系","改变资质","改变内力性质","改变性别","更换头像","改变结局","全部"],"全部"),kr]},{title:"物品",value:"item",dataFilters:[{type:"select",label:"物品种类",value:["秘籍","装备","药品","暗器","剧情","全部"],selected:"全部",filterFunc:(e,t)=>{if("全部"==e)return!0;const a=f(t.index);return _t(a.type)==e}},_r(["获得物品","增加/扣除物品","他人增加物品","初始装备","初始携带","全部"],"全部"),kr]},{title:"队伍",value:"team",dataFilters:[vr(yr,"全部"),_r(["队员加入","队员离队","脱下装备","全体离队","全部"],"全部"),kr]},{title:"任务",value:"quest",dataFilters:[_r(["增加任务","删除任务","全部"],"全部"),kr]},{title:"战斗",value:"battle",dataFilters:[_r(["战斗","友军战斗","限回合战斗","全部"],"全部"),kr]},{title:"条件",value:"condition",dataFilters:[_r(["判断品德","判断银两","判断拥有物品","判断得到过物品","判断真实拥有物品","判断队友在队中","判断队伍满","判断队伍中有女性","判断队伍中有男性","判断队伍空位","判断场景事件点图块","判断周目数","判断等级","判断武力","判断变量JMP","全部"],"全部"),kr]},{title:"其他",value:"other",dataFilters:[_r(["设置品德","物品专属人物设置","物品属性设置","武功属性设置","住宿","内力降为0","显示动画","打开场景","获取周目装备","获取幽灵队友","事件中存档","播放音乐","播放声音","全部"],"全部"),kr]}],Lr=[{text:"简略条件",value:"cond1",selected:!1},{text:"详细条件",value:"cond2",selected:!1}],xr=[dl("xw|attr|team","","人物","hero",{searchable:!0}),dl("item","","物品","item",{searchable:!0}),dl("ALL","","事件编号","eventId",{searchable:!0}),dl("ALL","","事件名","name"),dl("ALL","","指令","op"),dl("ALL","","描述","note"),dl("ALL","","数值索引","value"),dl("ALL","cond1","简略条件","eventCond",{multiline:!0}),dl("ALL","cond2","详细条件","eventCond2",{multiline:!0}),dl("condition","","事件点名称","extra")];function Sr(e){const t={...e};if(t["eventId"]="#"+e.eventId,t["name"]=k(e.eventId),"xw"==e["tabGroup"]||"attr"==e["tabGroup"]||"team"==e["tabGroup"]){const a=c(e["index"]);a&&(t["hero"]=`[${a.id}]${a.name}`)}else if("item"==e["tabGroup"]){const a=f(e["index"]);a&&(t["item"]=`[${a.id}]${a.name}`)}const a=Rn(e.eventId,e["condIdx"]);return t["eventCond"]=a?.[a.length-1],t["eventCond2"]=a?.join("\n"),t["ke"]=Kn(e.eventId,e["condIdx"]),t}var Ar={name:"EventGroupView",data(){return{selectType:"xw",tabs:$r,headerLabels:Lr,convertValue:Sr}},methods:{selectTab(e){this.selectType=e}},computed:{headers(){return xr},items(){return this.$store.state.EventSource[this.selectType]?this.$store.state.EventSource[this.selectType].map((e=>({...e,tabGroup:this.selectType}))):[]}},components:{TabDataPage:ul}},wr=Ar,Cr=(0,xs.Z)(wr,Vn,Dn,!1,null,"48efea30",null),Zr=Cr.exports,Ir=function(){var e=this,t=e._self._c;return t("div",[t("TabDataPage",{attrs:{name:"event-point",tabs:e.tabs,headersSource:e.headers,itemsSource:e.items,"header-labels":e.headerLabels,mapper:e.convertValue},on:{tabChange:e.selectTab}})],1)},Er=[];const Pr=[{title:"条件检查",value:"condition",dataFilters:[]}],Fr=[],Or=[dl("ALL","","编号","key",{searchable:!0}),dl("ALL","","名称","name",{searchable:!0}),dl("ALL","","天书","line",{searchable:!0}),dl("ALL","","设置点","modifyEvents",{multiline:!0}),dl("ALL","","检查点","checkEvents",{multiline:!0})];function Tr(e){const t={...e};if(e["name"]){const a=e["name"].match(/【(.*?)】/)[1];t["line"]="【"+a+"】"}return t["modifyEvents"]=e["modifyEvents"].join("\n"),t["checkEvents"]=e["checkEvents"].join("\n"),t}var Br={name:"EventPointView",data(){return{selectType:"condition",tabs:Pr,headerLabels:Fr,convertValue:Tr}},methods:{selectTab(e){this.selectType=e}},computed:{headers(){return Or},items(){return this.$store.state.EventPointSource?this.$store.state.EventPointSource.map((e=>({...e,tabGroup:this.selectType}))):[]}},components:{TabDataPage:ul}},Vr=Br,Dr=(0,xs.Z)(Vr,Ir,Er,!1,null,"5333c744",null),jr=Dr.exports,Kr=a(2165),Gr=function(){var e=this,t=e._self._c;return t(vs.Z,{staticStyle:{width:"95%","min-width":"95%",overflow:"auto"},attrs:{fluid:"","grid-list-md":""}},[t("div",[t(Os.Z,[t(Fs.Z,[e._v("战斗一览")]),t(Kr.Z,[t("BattleView")],1)],1)],1)])},Rr=[],qr=function(){var e=this,t=e._self._c;return t(vs.Z,{staticStyle:{width:"95%","min-width":"95%",overflow:"auto"},attrs:{fluid:"","grid-list-md":""}},[t("DataPage",{attrs:{name:"battle","headers-source":e.headers,"items-source":e.items,mapper:e.mapper,"header-labels":e.headerLabels,"extra-filters":[]},scopedSlots:e._u([{key:"options",fn:function(){return[t(js.Z,{attrs:{flat:""}},[t(Ks.EB,{staticClass:"text-subtitle-2"},[e._v(" 阵容显示方式 ")]),t(Ks.ZB,[t(Rs.Z,{attrs:{column:"",multiple:"","active-class":"primary--text text--accent-4"},model:{value:e.showStyle,callback:function(t){e.showStyle=t},expression:"showStyle"}},[t(Gs.Z,{attrs:{outlined:""}},[e._v(" 编号 ")]),t(Gs.Z,{attrs:{outlined:""}},[e._v(" 等级 ")])],1)],1)],1)]},proxy:!0}])})],1)},Mr=[];const Nr=[{text:"基本",value:"base",selected:!0},{text:"阵容",value:"role",selected:!0},{text:"统计",value:"stat",selected:!0},{text:"光环",value:"aura",selected:!0},{text:"偷窃",value:"steal",selected:!0}],Hr=[dl("ALL","","编号","id"),dl("ALL","","名称","name"),dl("ALL","base","类型","type"),dl("ALL","base","场景","field",{searchable:!0}),dl("ALL","base","背景音乐","bgm"),dl("ALL","base","相关事件","events",{multiline:!0}),dl("ALL","stat","敌方人数","enemyCnt"),dl("ALL","stat","敌方总等级","allEnemyLevel"),dl("ALL","stat","敌方平均等级","avgEnemyLevel"),dl("ALL","stat","敌方最高等级","maxEnemyLevel"),dl("ALL","stat","敌方最低等级","minEnemyLevel"),dl("ALL","role","敌方阵容","enemies",{multiline:!0}),dl("ALL","role","本方阵容","teams",{multiline:!0}),dl("ALL","role","友方阵容","friends",{multiline:!0}),dl("ALL","aura","敌方光环（天赋）","aura_talent",{multiline:!0}),dl("ALL","aura","敌方光环（特技）","aura_skill",{multiline:!0}),dl("ALL","aura","敌方光环（称号）","aura_title",{multiline:!0}),dl("ALL","steal","可偷窃物品（必偷）","steal_items1",{multiline:!0}),dl("ALL","steal","可偷窃物品（次选）","steal_items2",{multiline:!0}),dl("ALL","steal","可偷窃物品（可选）","steal_items3",{multiline:!0})];function Ur(e,t){const a=t["showStyle"]||[],s={...e};s["field"]=`[${e["field"]}]${m(e["field"])["name"]}`,s["type"]=A(e),s["enemies"]=Qr(e["enemies"],a),s["teams"]=Qr(e["teams"],a),s["friends"]=Qr(e["friends"],a),s["events"]=zr(e["events"]),s["aura_talent"]=Xr(e["aura_talent"]||[]),s["aura_skill"]=Xr(e["aura_skill"]||[]),s["aura_title"]=Xr(e["aura_title"]||[],!0),s["steal_items1"]=Jr(e["steal_items1"]||[]),s["steal_items2"]=Jr(e["steal_items2"]||[]),s["steal_items3"]=Jr(e["steal_items3"]||[]),s["enemyCnt"]=e["enemies"].length;let l=0,n=0,r=999;return e["enemies"].forEach((e=>{const t=c(e)["level"];l+=t,n=t>n?t:n,r=t<r?t:r})),s["allEnemyLevel"]=l,s["maxEnemyLevel"]=n,s["minEnemyLevel"]=r,s["avgEnemyLevel"]=e["enemies"].length>0?Math.round(10*s["allEnemyLevel"]/e["enemies"].length)/10:0,s}function Qr(e,t){const a=e.map((e=>Yr(e,t))).sort(((e,t)=>t.level-e.level)).reduce(((e,t,a)=>(a%5===0&&e.push([]),e[e.length-1].push(t),e)),[]).map((e=>e.join("， ")));return a.join("\n")}function Yr(e,t){const a=c(e);let s="";return t.includes(0)&&(s+=`[${a.id}]`),s+=a.name,t.includes(1)&&(s+=`(${a.level})`),s}function Xr(e,t){const a=e.map((e=>Wr(e[0],e[1],t))).reduce(((e,t,a)=>(a%5===0&&e.push([]),e[e.length-1].push(t),e)),[]).map((e=>e.join("， ")));return a.join("\n")}function Wr(e,t,a){if(a)return`${g(e)["name"]}${t}`;const s=u(e);return`${s.name}${t}`}function zr(e){return e.map((e=>`${k(e)}`)).join("\n")}function Jr(e){return e.map((e=>{const t=f(e[0]),a=e[1],s=a.map((e=>c(e)["name"])).reduce(((e,t,a)=>(a%5===0&&e.push([]),e[e.length-1].push(t),e)),[]).map((e=>e.join("，")));return`${t["name"]}：${s.join("，\n\t")}`})).join("\n")}var ei={name:"BattleView",data(){return{headerLabels:Nr,showStyle:[0],sortType:0}},computed:{headers(){return Hr},items(){return Object.values(this.$store.state.BattleSource)},mapper(){return e=>Ur(e,{showStyle:this.showStyle,sortType:this.sortType})}},components:{DataPage:rl}},ti=ei,ai=(0,xs.Z)(ti,qr,Mr,!1,null,"42b30f00",null),si=ai.exports,li={name:"BattleTabView",data(){return{}},components:{BattleView:si}},ni=li,ri=(0,xs.Z)(ni,Gr,Rr,!1,null,"24a5adc5",null),ii=ri.exports,oi=function(){var e=this,t=e._self._c;return t(vs.Z,{staticStyle:{width:"95%","min-width":"95%",overflow:"auto"},attrs:{fluid:"","grid-list-md":""}},[t("DataPage",{attrs:{name:"talk-ref","headers-source":e.headers,"items-source":e.items,mapper:e.convertValue,"header-labels":[],"extra-filters":e.dataFilters}})],1)},ci=[];const ui=[dl("ALL","","对话编号","id"),dl("ALL","","对话类型","type"),dl("ALL","","截取内容","text"),dl("ALL","","引用数","refCount"),dl("ALL","","具体引用","refs",{multiline:!0})];function di(e){const t={...e};return t["type"]=e["type"]?0==e["type"]?"常规对话":"扩展对话":"",t["refCount"]=e["refs"].length,t["refs"]=fl(e["refs"],5),t}const fi=[{type:"select",label:"类型",value:["无引用","多处引用","重复对话"],selected:"无引用",filterFunc:(e,t)=>t["group"]===e}];var hi={name:"TalkRefView",data(){return{convertValue:di,dataFilters:fi}},computed:{headers(){return ui},items(){return(this.$store.state.TalkRef["无引用"]?.map((e=>({...e,group:"无引用"})))||[]).concat(this.$store.state.TalkRef["多处引用"]?.map((e=>({...e,group:"多处引用"})))||[]).concat(this.$store.state.TalkRef["重复对话"]?.map((e=>({...e,group:"重复对话"})))||[])}},components:{DataPage:rl}},mi=hi,pi=(0,xs.Z)(mi,oi,ci,!1,null,"2b1d538e",null),gi=pi.exports,bi=function(){var e=this,t=e._self._c;return t(vs.Z,{staticStyle:{width:"95%","min-width":"95%",overflow:"auto"},attrs:{fluid:"","grid-list-md":""}},[t("div",[t(Os.Z,[t(Fs.Z,[e._v("套装")]),t(Fs.Z,[e._v("配合")]),t(Fs.Z,[e._v("阵法")]),t(Fs.Z,[e._v("组合大绝")]),t(Kr.Z,[t("SuitDataView")],1),t(Kr.Z,[t("MatchView")],1),t(Kr.Z,[t("FormationView")],1),t(Kr.Z,[t("ComprehendView")],1)],1)],1)])},vi=[],_i=function(){var e=this,t=e._self._c;return t("DataPage",{attrs:{name:"match","headers-source":e.headers,"items-source":e.items,mapper:e.convertValue,"header-labels":[],"extra-filters":e.dataFilters}})},ki=[];const yi=[dl("ALL","","配合因子","source",{searchable:!0}),dl("ALL","","因子类型","sourceType"),dl("ALL","","配合武功","matchSkill",{searchable:!0}),dl("ALL","","基础威力","basePower"),dl("ALL","","威力加成","power")];function $i(e){const t={};t["power"]=e.power;const a=u(e["matchSkillId"]);if(t["matchSkill"]=`[${e["matchSkillId"]}]${a.name}`,t["matchSKillData"]=a,t["basePower"]=a["attrl_power"],e["itemId"]){const a=f(e["itemId"]);t["source"]=`[${e["itemId"]}]${a.name}`,t["item"]=a,t["sourceType"]=ut(a["position"])}else if(e["skillId"]){const a=u(e["skillId"]);t["source"]=`[${e["skillId"]}]${a.name}`,t["skill"]=a,t["sourceType"]=yt(a["type"])}return t}const Li=[{type:"select",label:"配合种类",value:["装备","内功","轻功","全部"],selected:"全部",filterFunc:(e,t)=>"全部"==e||(!("装备"!=e||!t["item"])||!!t["skill"]&&yt(t["skill"].type)==e)},{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"全部",filterFunc:(e,t)=>"全部"==e||("只看氪金"==e?t["matchSKillData"].ke:!t["matchSKillData"].ke)}];var xi={name:"MatchView",data(){return{convertValue:$i,dataFilters:Li}},computed:{headers(){return yi},items(){return Object.values(this.$store.state.ListSource["match1"]).concat(Object.values(this.$store.state.ListSource["match2"]))}},components:{DataPage:rl}},Si=xi,Ai=(0,xs.Z)(Si,_i,ki,!1,null,"c9e7dece",null),wi=Ai.exports,Ci=function(){var e=this,t=e._self._c;return t("DataPage",{attrs:{name:"formation","headers-source":e.headers,"items-source":e.items,mapper:e.convertValue,"header-labels":[],"extra-filters":e.dataFilters}})},Zi=[];const Ii=[dl("ALL","","人物1","hero1",{searchable:!0}),dl("ALL","","人物2","hero2",{searchable:!0}),dl("ALL","","人物3","hero3",{searchable:!0}),dl("ALL","","人物4","hero4",{searchable:!0}),dl("ALL","","人物5","hero5",{searchable:!0}),dl("ALL","","人物6","hero6",{searchable:!0}),dl("ALL","","人物7","hero7",{searchable:!0}),dl("ALL","","人数","count"),dl("ALL","","总属性","totalAttr"),dl("ALL","","攻击","atk"),dl("ALL","","防御","def"),dl("ALL","","轻功","agi"),dl("ALL","","拳掌","fs"),dl("ALL","","御剑","ss"),dl("ALL","","兵器","ws"),dl("ALL","","指腿","rs"),dl("ALL","","暗器","ts")];function Ei(e){const t={...e};t["formation"]=[],t["count"]=e["heroes"].length,t["ke"]=!1;for(let a=1;a<=7;a++){if(e["heroes"].length<a)break;const s=c(e["heroes"][a-1]);t["hero"+a]=`[${s.id}]${s.name}`,s["ke"]&&(t["ke"]=!0)}return t["totalAttr"]=t["atk"]+t["def"]+t["agi"]+t["fs"]+t["ss"]+t["ws"]+t["rs"]+t["ts"],t}const Pi=[{type:"select",label:"氪金",value:["只看氪金","不看氪金","全部"],selected:"全部",filterFunc:(e,t)=>"全部"==e||("只看氪金"==e?t.ke:!t.ke)}];var Fi={name:"FormationView",data(){return{convertValue:Ei,dataFilters:Pi}},computed:{headers(){return Ii},items(){return this.$store.state.ListSource["formation"]}},components:{DataPage:rl}},Oi=Fi,Ti=(0,xs.Z)(Oi,Ci,Zi,!1,null,"5c35068c",null),Bi=Ti.exports,Vi=function(){var e=this,t=e._self._c;return t("DataPage",{attrs:{name:"comprehend","headers-source":e.headers,"items-source":e.items,mapper:e.convertValue,"header-labels":[],"extra-filters":e.dataFilters}})},Di=[];const ji=[dl("ALL","","合成大绝","comprehendSkill",{searchable:!0}),dl("ALL","","系别","series"),dl("ALL","","威力","power"),dl("ALL","","因子1","skill1",{searchable:!0}),dl("ALL","","因子1系别","skill1Series"),dl("ALL","","因子1等级","skill1Level"),dl("ALL","","因子2","skill2",{searchable:!0}),dl("ALL","","因子2系别","skill2Series"),dl("ALL","","因子2等级","skill2Level"),dl("ALL","","因子3","skill3",{searchable:!0}),dl("ALL","","因子3系别","skill3Series"),dl("ALL","","因子3等级","skill3Level")];function Ki(e){const t={},a=u(e["comprehendSkillId"]);t["comprehendSkill"]=`[${e["comprehendSkillId"]}]${a["name"]}`,t["series"]=yt(a["type"]),t["power"]=a["attrl_power"];for(let s=1;s<=3;s++){if(e["skillIds"].length<s)break;const a=u(e["skillIds"][s-1]);t[`skill${s}`]=`[${a["id"]}]${a["name"]}`,t[`skill${s}Series`]=yt(a["type"]),t[`skill${s}Level`]=a["level"]}return t}const Gi=[{type:"select",label:"系别",value:["拳掌","御剑","兵器","指腿","暗毒","全部"],selected:"全部",filterFunc:(e,t)=>"全部"==e||t["series"]==e}];var Ri={name:"ComprehendView",data(){return{convertValue:Ki,dataFilters:Gi}},computed:{headers(){return ji},items(){return this.$store.state.ListSource["comprehend"]}},components:{DataPage:rl}},qi=Ri,Mi=(0,xs.Z)(qi,Vi,Di,!1,null,"6586b65e",null),Ni=Mi.exports,Hi={name:"ListTabView",data(){return{}},components:{SuitDataView:Xl,MatchView:wi,FormationView:Bi,ComprehendView:Ni}},Ui=Hi,Qi=(0,xs.Z)(Ui,bi,vi,!1,null,"6d135132",null),Yi=Qi.exports,Xi=function(){var e=this,t=e._self._c;return t("div",[t(Os.Z,{attrs:{value:1}},[t(Fs.Z,[e._v("配置规则")]),t(Fs.Z,[e._v("人物配置模拟器")]),t(Fs.Z,[e._v("技能模拟器")]),t(Fs.Z,[e._v("词条计算规则")]),t(Kr.Z,{attrs:{transition:!1,"reverse-transition":!1}},[t("ConfigRule")],1),t(Kr.Z,{attrs:{transition:!1,"reverse-transition":!1}},[t("RoleCustomView")],1),t(Kr.Z,{attrs:{transition:!1,"reverse-transition":!1}},[t("SkillCustomView")],1),t(Kr.Z,{attrs:{transition:!1,"reverse-transition":!1}},[t("CalcRuleView")],1)],1)],1)},Wi=[],zi=a(120),Ji=a(4061),eo=a(9223),to=a(5125),ao=a(4324),so=a(5375),lo=a(3687),no=a(6313),ro=function(){var e=this,t=e._self._c;return t(js.Z,[t(Ks.ZB,[t(to.Z,[t(js.Z,{attrs:{flat:""}},[t(Ks.EB,[e._v("基本信息")]),t(Ks.ZB,[t(_s.Z,[t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(Ys.Z,{attrs:{label:"名称",outlined:"",dense:""},on:{change:function(t){e.modified=!0}},model:{value:e.skill.base.name,callback:function(t){e.$set(e.skill.base,"name",t)},expression:"skill.base.name"}})],1),t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(Ys.Z,{attrs:{label:"序号",outlined:"",dense:""},on:{change:function(t){e.modified=!0}},model:{value:e.skill.base.id,callback:function(t){e.$set(e.skill.base,"id",t)},expression:"skill.base.id"}})],1),t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(Ds.Z,{on:{click:e.importSkill}},[t("span",{staticClass:"text-subtitle-2"},[e._v("导入")])])],1),t(bs.Z,{attrs:{cols:"12",md:"5"}}),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(Ys.Z,{staticClass:"headline centered-input",attrs:{readonly:"",hint:e.totalGradeDesc,label:"总分","persistent-hint":"",outlined:""},on:{click:e.clickGrade},model:{value:e.totalGrade,callback:function(t){e.totalGrade=t},expression:"totalGrade"}})],1)],1),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(so.Z,{attrs:{items:[2,4,6],label:"周目",outlined:"",dense:""},on:{change:e.elementChanged},model:{value:e.skill.base.round,callback:function(t){e.$set(e.skill.base,"round",t)},expression:"skill.base.round"}})],1),t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(so.Z,{attrs:{items:[1,2],label:"氪度",outlined:"",dense:""},on:{change:e.elementChanged},model:{value:e.skill.base.ke,callback:function(t){e.$set(e.skill.base,"ke",t)},expression:"skill.base.ke"}})],1),t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(so.Z,{attrs:{items:["天赋","特技","内功","轻功"],label:"种类",dense:"",outlined:""},on:{change:e.elementChanged},model:{value:e.skill.base.type,callback:function(t){e.$set(e.skill.base,"type",t)},expression:"skill.base.type"}})],1),t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(so.Z,{attrs:{items:["无","拳掌","御剑","兵器","指腿","暗毒"],label:"主系",dense:"",outlined:""},on:{change:function(t){return e.elementChanged()}},model:{value:e.skill.base.classType,callback:function(t){e.$set(e.skill.base,"classType",t)},expression:"skill.base.classType"}})],1),"特技"==e.skill.base.type||"天赋"==e.skill.base.type?t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(zi.Z,{attrs:{label:"光环",dense:"",outlined:""},on:{change:function(t){return e.elementChanged()}},model:{value:e.skill.base.isAura,callback:function(t){e.$set(e.skill.base,"isAura",t)},expression:"skill.base.isAura"}})],1):e._e(),"特技"==e.skill.base.type?t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(Ys.Z,{attrs:{dense:"",label:"特技回合",outlined:""},on:{change:function(t){return e.elementChanged()}},model:{value:e.skill.base.buffTurn,callback:function(t){e.$set(e.skill.base,"buffTurn",t)},expression:"skill.base.buffTurn"}})],1):e._e(),"特技"==e.skill.base.type?t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(Ys.Z,{attrs:{dense:"",label:"特技耗气",outlined:""},on:{change:function(t){return e.elementChanged()}},model:{value:e.skill.base.energyCost,callback:function(t){e.$set(e.skill.base,"energyCost",t)},expression:"skill.base.energyCost"}})],1):e._e(),e.skill.base.isAura?t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(so.Z,{attrs:{items:[0,6,8,12],dense:"",label:"光环范围",outlined:""},on:{change:function(t){return e.elementChanged()}},model:{value:e.skill.base.auraRange,callback:function(t){e.$set(e.skill.base,"auraRange",t)},expression:"skill.base.auraRange"}})],1):e._e(),e.skill.base.isAura?t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(so.Z,{attrs:{items:["","益","害"],label:"己方益害",dense:"",outlined:""},on:{change:function(t){return e.elementChanged()}},model:{value:e.skill.base.auraEffSelf,callback:function(t){e.$set(e.skill.base,"auraEffSelf",t)},expression:"skill.base.auraEffSelf"}})],1):e._e(),e.skill.base.isAura?t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(so.Z,{attrs:{items:["","益","害"],label:"敌方益害",dense:"",outlined:""},on:{change:function(t){return e.elementChanged()}},model:{value:e.skill.base.auraEffEnemy,callback:function(t){e.$set(e.skill.base,"auraEffEnemy",t)},expression:"skill.base.auraEffEnemy"}})],1):e._e()],1)],1)],1),"特技"==e.skill.base.type&&e.skill.base.isAura?e._e():t(js.Z,{attrs:{flat:""}},[t(Ks.EB,[e._v("自身词条")]),t(Ks.ZB,e._l(e.rows,(function(a){return t(_s.Z,{key:a.title,attrs:{dense:""}},[e._l(a.cols.filter((e=>!e.onlyAura)),(function(a){return[t(bs.Z,{key:a.label,attrs:{cols:"12",sm:a.wide||1,"align-self":"end"}},["combobox"!=a.type?t(Ys.Z,{class:e.skill.mainAttr[a.label]!=a.defValue?"modified-input":"",staticStyle:{width:"80%"},attrs:{label:a.label,hint:e.validate.mainAttr[a.label],"persistent-hint":"",suffix:a.suffix,disabled:e.skill.base.isAura&&!a.auraSelf||a.mainClass&&"无"==e.skill.base.classType,dense:"",outlined:!1},on:{change:function(t){return e.elementChanged(a.label)}},model:{value:e.skill.mainAttr[a.label],callback:function(t){e.$set(e.skill.mainAttr,a.label,t)},expression:"skill.mainAttr[col.label]"}}):e._e(),"combobox"==a.type?t(so.Z,{attrs:{items:a.items,label:a.label,dense:"",chips:"",multiple:""},on:{change:function(t){return e.elementChanged(a.label)}},model:{value:e.skill.mainAttr[a.label],callback:function(t){e.$set(e.skill.mainAttr,a.label,t)},expression:"skill.mainAttr[col.label]"}}):e._e()],1)]}))],2)})),1)],1),e.skill.base.isAura?t(js.Z,{attrs:{flat:""}},[t(Ks.EB,[e._v("光环词条")]),t(Ks.ZB,e._l(e.rows,(function(a){return t(_s.Z,{key:a.title,attrs:{dense:""}},[e._l(a.cols,(function(a){return[t(bs.Z,{key:a.label,attrs:{cols:"12",sm:a.wide||1,"align-self":"end"}},["combobox"!=a.type?t(Ys.Z,{class:e.skill.auraAttr[a.label]!=a.defValue?"modified-input":"",staticStyle:{width:"80%"},attrs:{label:a.label,hint:e.validate.auraAttr[a.label],"persistent-hint":"",suffix:a.suffix,disabled:a.mainClass&&"无"==e.skill.base.classType,dense:""},on:{change:function(t){return e.elementChanged(a.label)}},model:{value:e.skill.auraAttr[a.label],callback:function(t){e.$set(e.skill.auraAttr,a.label,t)},expression:"skill.auraAttr[col.label]"}}):e._e(),"combobox"==a.type?t(so.Z,{attrs:{items:a.items,label:a.label,dense:"",chips:"",multiple:""},on:{change:function(t){return e.elementChanged(a.label)}},model:{value:e.skill.auraAttr[a.label],callback:function(t){e.$set(e.skill.auraAttr,a.label,t)},expression:"skill.auraAttr[col.label]"}}):e._e()],1)]}))],2)})),1)],1):e._e(),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",md:"1"}}),t(bs.Z,{attrs:{cols:"12",md:"8","align-self":"end"}},[t(Xs.Z,{attrs:{rows:"4",label:"自动生成描述",readonly:"",outlined:"","hide-details":"","no-resize":""},model:{value:e.grade.desc,callback:function(t){e.$set(e.grade,"desc",t)},expression:"grade.desc"}})],1),t(bs.Z,{attrs:{cols:"12",md:"1"}}),t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(Ds.Z,{attrs:{disabled:!e.modified},on:{click:e.submit}},[t("span",{staticClass:"text-subtitle-2"},[e._v(e._s(e.isEdit?"保存":"创建"))])]),t("p"),t(Ds.Z,{on:{click:e.reset}},[t("span",{staticClass:"text-subtitle-2"},[e._v("重置")])])],1)],1),t("p"),t(eo.Z),t("p"),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",md:"10"}},[t(js.Z,{attrs:{flat:""}},[t(Ks.EB,[e._v("提交记录")]),t(Ks.ZB,[t(qs.Z,{staticClass:"elevation-1 table",staticStyle:{width:"100%"},attrs:{dense:"","show-select":"","hide-default-footer":"","calculate-widths":!0,headers:e.tableHeaders,items:e.tableItems,"items-per-page":100},scopedSlots:e._u([{key:"top",fn:function(){return[t(no.Z,{attrs:{flat:""}},[t(Ds.Z,e._b({attrs:{disabled:0==e.tableSelected.length},on:{click:e.upMoveSkills}},"v-btn",e.btnProps,!1),[e._v("上移")]),t(Ds.Z,e._b({attrs:{disabled:0==e.tableSelected.length},on:{click:e.downMoveSkills}},"v-btn",e.btnProps,!1),[e._v("下移")]),t(Ds.Z,e._b({attrs:{disabled:0==e.tableSelected.length},on:{click:e.exportSkill}},"v-btn",e.btnProps,!1),[e._v("导出")])],1)]},proxy:!0},{key:"item.actions",fn:function({item:a}){return[t(ao.Z,{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(a)}}},[e._v(" mdi-pencil ")]),t(ao.Z,{attrs:{small:""},on:{click:function(t){return e.deleteItem(a)}}},[e._v(" mdi-delete ")])]}}],null,!0),model:{value:e.tableSelected,callback:function(t){e.tableSelected=t},expression:"tableSelected"}})],1)],1)],1),t(bs.Z,{attrs:{cols:"12",md:"1","align-self":"end"}},[t("p"),t(Ds.Z,{attrs:{disabled:0==e.tableSelected.length},on:{click:e.exportSkill}},[t("span",{staticClass:"text-subtitle-2"},[e._v("导出")])])],1)],1)],1),t(Vs.Z,{attrs:{inset:""},model:{value:e.bottom,callback:function(t){e.bottom=t},expression:"bottom"}},[t(Qs.Z,{staticClass:"text-center"},[t("div",{staticStyle:{overflow:"scroll",height:"fit-content"}},[t(Xs.Z,{attrs:{rows:"12",readonly:"",filled:"",outlined:"","hide-details":""},model:{value:e.gradeDetail,callback:function(t){e.gradeDetail=t},expression:"gradeDetail"}})],1)])],1),t(Ji.Z,{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[t(js.Z,[t(Ks.EB,[e._v("确认删除["+e._s(e.deletingItem?e.deletingItem.name:"")+"]？")]),t(Ks.h7,[t(lo.Z),t(Ds.Z,{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialogDelete=!1}}},[e._v("取消")]),t(Ds.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.deleteItemConfirm}},[e._v("确认")]),t(lo.Z)],1)],1)],1)],1)],1)},io=[],oo=a(7460),co=a.n(oo);function uo(e,t){const a=co().unparse(e),s=new Blob(["\ufeff"+a],{type:"text/csv;charset=utf-8;"}),l=URL.createObjectURL(s),n=document.createElement("a");n.setAttribute("href",l),n.setAttribute("download",t),n.click(),URL.revokeObjectURL(l)}const fo=[{title:"属性",cols:["自身攻击","自身防御","自身轻功","战场攻击","战场防御","战场轻功","行动时序","敌方攻击","敌方防御","敌方轻功","敌方时序"]},{title:"特性",cols:["移动距离","攻击距离","杀伤范围","暴击","双击","出招","主系出招"]},{title:"攻击效果",cols:["威力","命中","伤害","加受伤度","主系威力","主系命中","主系伤害","吸血"]},{title:"防御效果",cols:["减威","闪避","减伤","减受伤度","主系减威","主系闪避","主系减伤","反震","反弹","挪移"]},{title:"异常",cols:["异常","异常概率","异常回合"]},{title:"免疫",cols:["免疫"]}],ho=[{text:"名称",value:"name"},{text:"序号",value:"sid"},{text:"分数",value:"grade"},{text:"描述",value:"desc",width:"60%"},{text:"操作",value:"actions",sortable:!1}];var mo={name:"SkillCustomView",data(){return{bottom:!1,modified:!1,dialogDelete:!1,tableSelected:[],deletingItem:null,skill:new da,validate:new pa,grade:{desc:"",detail:()=>""},totalGrade:"0.00",totalGradeDesc:"",gradeDetail:""}},methods:{save(){this.modified&&((0,ra.localSave)("curSkill",this.skill),this.modified=!1)},submit(){this.$store.dispatch("customSkill/updateCustomSkill",{name:this.skill.base.name,skill:new da(this.skill)}),this.modified=!1},editItem(e){const t=this.$store.state["customSkill"].customSKills.find((t=>t.name===e.name));this.skill=new da(t.skill),this.elementChanged()},deleteItem(e){this.dialogDelete=!0,this.deletingItem=e},deleteItemConfirm(){this.$store.dispatch("customSkill/deleteCustomSkill",{name:this.deletingItem.name}),this.dialogDelete=!1},elementChanged(){if(this.modified=!0,this.skill.fixAttr(),"内功"==this.skill.base.type){this.grade=this.skill.calcGrade();const e=this.skill.calcGrade(!0);this.totalGrade=(.5*this.grade.totalGrade+.5*e.totalGrade).toFixed(2),this.totalGradeDesc=`普通：${this.grade.totalGrade.toFixed(2)}，护体：${e.totalGrade.toFixed(2)}`}else this.grade=this.skill.calcGrade(),this.totalGrade=this.grade.totalGrade.toFixed(2),this.totalGradeDesc="";this.validate=new pa(this.skill),this.validate.validate()},clickGrade(){this.gradeDetail=this.grade.detail(),this.bottom=!0},reset(){this.skill=new da,this.elementChanged()},importSkill(){const e=fa(this.skill.base.id);null!=e&&(this.skill=e,this.elementChanged())},exportSkill(){const e=[];this.tableSelected.forEach((t=>{const a=this.$store.state["customSkill"].customSKills.find((e=>e.name===t.name));e.push(...a.skill.exportSkill()),e.push({"1技能名":t.desc})})),e.length>0&&uo(e,"games.csv")},upMoveSkills(){this.$store.dispatch("customSkill/upMoveCustomSkills",{skills:this.tableSelected.map((e=>e.name))})},downMoveSkills(){this.$store.dispatch("customSkill/downMoveCustomSkills",{skills:this.tableSelected.map((e=>e.name))})},deleteSkills(){}},computed:{isEdit(){return void 0!==this.$store.state["customSkill"].customSKills.find((e=>e.name===this.skill.base.name))},rows(){const e=fo.map((e=>({title:e.title,cols:e.cols.map((e=>{const t=ca[e];return{...t,label:e,suffix:t.pct?"%":"",defValue:ca.defValue(e)}}))})));return e},tableHeaders(){return ho},tableItems(){return this.$store.state["customSkill"].customSKills.map((({name:e,skill:t})=>{const a=t.calcGrade();return{id:e,name:e,sid:t.base.id,grade:a.totalGrade.toFixed(2),desc:a.desc,action:"删除"}}))}},mixins:[{data(){return{btnProps:{text:!0,outlined:!0,class:"my-btn"}}}}]},po=mo,go=(0,xs.Z)(po,ro,io,!1,null,"457ab92d",null),bo=go.exports,vo=function(){var e=this,t=e._self._c;return t("div",[t(Os.Z,[t(Fs.Z,[e._v("词条")]),t(Fs.Z,[e._v("条件")]),t(Kr.Z,[t(vs.Z,[t(qs.Z,{staticClass:"elevation-1 table",staticStyle:{width:"100%"},attrs:{dense:"","hide-default-footer":"","show-group-by":"","calculate-widths":!0,headers:e.attrPrefixHeaders,items:e.attrPrefixItems,"items-per-page":100}})],1)],1),t(Kr.Z,[t(vs.Z,[t(qs.Z,{staticClass:"elevation-1 table",staticStyle:{width:"100%"},attrs:{dense:"","hide-default-footer":"","calculate-widths":!0,headers:e.conditionHeaders,items:e.conditionItems,"items-per-page":100}})],1)],1)],1)],1)},_o=[];const ko=[{text:"名称",value:"name",groupable:!1},{text:"组别",value:"group",groupable:!0},{text:"通用/特殊",value:"cmn",groupable:!0},{text:"标准分",value:"value",groupable:!1},{text:"算分规则",value:"calcType",groupable:!0},{text:"相关技能",value:"owners",groupable:!1}],yo=[{text:"名称",value:"name"},{text:"系数",value:"factor"},{text:"说明",value:"desc"},{text:"相关技能",value:"owners"}];var $o={name:"CalcRuleView",data:()=>({showDialog:!1}),computed:{attrPrefixHeaders(){return ko},attrPrefixItems(){return U.map((e=>({name:e.name,group:e.group,value:e.value,cmn:e.hasCalcFlag("cmn")?"通用":"特殊",calcType:e.calcTypeDisplay(),owners:this.attrPrefixOwners[e.key]?.join("，")})))},conditionHeaders(){return yo},conditionItems(){return Object.entries(Y).map((([e,t])=>({name:e,factor:t.factor,desc:t.desc,owners:this.conditionOwners[e]?.join("，")})))}},created(){const e=this.$store.state.SkillSource,t={},a={};Object.values(e).forEach((e=>{e["ext_attr"]&&e["ext_attr"].forEach((s=>{s["values"]&&s["values"].forEach((s=>{s["attr"]&&(a[s["attr"]]?a[s["attr"]].includes(e["name"])||a[s["attr"]].push(e["name"]):a[s["attr"]]=[e["name"]]),s["condition"]&&(t[s["condition"]]?t[s["condition"]].includes(e["name"])||t[s["condition"]].push(e["name"]):t[s["condition"]]=[e["name"]])}))}))})),this.attrPrefixOwners=a,this.conditionOwners=t}},Lo=$o,xo=(0,xs.Z)(Lo,vo,_o,!1,null,"d4d1bae4",null),So=xo.exports,Ao=a(2936),wo=function(){var e=this,t=e._self._c;return t(js.Z,[t(Ks.ZB,[t(to.Z,[t(js.Z,{attrs:{flat:""}},[t(Ks.EB,[e._v("基本信息")]),t(Ks.ZB,[t(_s.Z,[t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(Ys.Z,{attrs:{label:"人物名",outlined:"",dense:""},model:{value:e.role.base.name,callback:function(t){e.$set(e.role.base,"name",t)},expression:"role.base.name"}})],1),t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(so.Z,{attrs:{outlined:"",dense:"",items:[2,4,6],label:"周目"},on:{change:e.recalc},model:{value:e.role.base.round,callback:function(t){e.$set(e.role.base,"round",t)},expression:"role.base.round"}})],1),t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(so.Z,{attrs:{items:[1,2,4,6,8,10],outlined:"",dense:"",label:"氪度"},on:{change:e.recalc},model:{value:e.role.base.ke,callback:function(t){e.$set(e.role.base,"ke",t)},expression:"role.base.ke"}})],1),t(bs.Z,{attrs:{cols:"12",md:"5"}}),t(bs.Z,{attrs:{cols:"12",md:"1"}},[t(Ds.Z,{attrs:{disabled:!e.modified},on:{click:e.submit}},[t("span",{staticClass:"text-subtitle-2"},[e._v(e._s(e.isEdit?"保存":"创建"))])]),t("p"),t(Ds.Z,{on:{click:e.reset}},[t("span",{staticClass:"text-subtitle-2"},[e._v("重置")])])],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(Ys.Z,{staticClass:"headline centered-input",attrs:{readonly:"",label:"总分",outlined:"","persistent-hint":"",hint:e.role.checkTotalGrade(e.totalGrade)},model:{value:e.totalGrade,callback:function(t){e.totalGrade=t},expression:"totalGrade"}})],1)],1),t(_s.Z,[t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(zi.Z,{attrs:{label:"双手攻击（1分）",dense:"","hide-details":""},model:{value:e.role.config.twoHands,callback:function(t){e.$set(e.role.config,"twoHands",t)},expression:"role.config.twoHands"}})],1),e.role.base.round<4?t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(zi.Z,{attrs:{label:"内力调和（1分）",dense:"","hide-details":""},model:{value:e.role.config.harmony,callback:function(t){e.$set(e.role.config,"harmony",t)},expression:"role.config.harmony"}})],1):e._e()],1)],1)],1),t(js.Z,{attrs:{flat:""}},[t(Ks.EB,[e._v("人物配置")]),t(Ks.ZB,[t(_s.Z,[t(bs.Z,{attrs:{cols:"12",md:"6"}},[t(js.Z,{attrs:{outlined:""}},[t(Ks.EB,{staticClass:"text-h6"},[e._v("称号")]),t(Ks.ZB,[t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{dense:"",cols:"12",md:"4"}},[t(Ao.Z,{attrs:{dense:"",outlined:"",label:"称号","persistent-placeholder":"","persistent-hint":"",items:e.titleList,hint:e.bans.title},on:{change:e.titleSelectChanged},model:{value:e.role.config.title,callback:function(t){e.$set(e.role.config,"title",t)},expression:"role.config.title"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(zi.Z,{attrs:{label:"新创",dense:"",disabled:"","hide-details":""},on:{change:function(t){e.role.config.title=null,e.titleSelectChanged()}},model:{value:e.role.options.titleCustom,callback:function(t){e.$set(e.role.options,"titleCustom",t)},expression:"role.options.titleCustom"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(zi.Z,{attrs:{label:"只看有分",dense:"","hide-details":""},on:{change:function(t){e.role.config.title=null,e.titleSelectChanged()}},model:{value:e.role.options.titleScoreOnly,callback:function(t){e.$set(e.role.options,"titleScoreOnly",t)},expression:"role.options.titleScoreOnly"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}}),t(bs.Z,{attrs:{dense:"",cols:"12",md:"2"}},[t(Ys.Z,{staticClass:"centered-input",attrs:{label:"分数",outlined:"",dense:"",readonly:"",value:e.objs.title?.grade?.toFixed(2)||0}})],1)],1),e.role.options.titleDescShow?t(Xs.Z,{attrs:{label:"描述",outlined:"",dense:"",readonly:"",rows:"3",value:e.objs.title?.desc,"no-resize":""}}):e._e()],1)],1)],1),t(bs.Z,{attrs:{cols:"12",md:"6"}},[t(js.Z,{attrs:{outlined:""}},[t(Ks.EB,{staticClass:"text-h6"},[e._v("天赋")]),t(Ks.ZB,[t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{dense:"",cols:"12",md:"4"}},[t(Ao.Z,{attrs:{dense:"",outlined:"",label:"天赋","persistent-placeholder":"","persistent-hint":"",items:e.talentList,hint:e.bans.talent},on:{change:e.talentSelectChanged},model:{value:e.role.config.talent,callback:function(t){e.$set(e.role.config,"talent",t)},expression:"role.config.talent"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(zi.Z,{attrs:{label:"新创",dense:"","hide-details":""},on:{change:function(t){e.role.config.talent=null,e.talentSelectChanged()}},model:{value:e.role.options.talentCustom,callback:function(t){e.$set(e.role.options,"talentCustom",t)},expression:"role.options.talentCustom"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(zi.Z,{attrs:{label:"只看氪金",dense:"","hide-details":""},on:{change:function(t){e.role.config.talent=null,e.talentSelectChanged()}},model:{value:e.role.options.talentKeOnly,callback:function(t){e.$set(e.role.options,"talentKeOnly",t)},expression:"role.options.talentKeOnly"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}}),t(bs.Z,{attrs:{dense:"",cols:"12",md:"2"}},[t(Ys.Z,{staticClass:"centered-input",attrs:{label:"分数",outlined:"",dense:"",readonly:"","persistent-hint":"",value:e.objs.talent?.grade?.toFixed(2)||0,hint:e.objs.talent?.grade_detail}})],1)],1),e.role.options.talentDescShow?t(Xs.Z,{attrs:{label:"描述",outlined:"",dense:"",readonly:"","no-resize":"",rows:"3",value:e.objs.talent?.desc}}):e._e()],1)],1)],1)],1),t("p"),t(_s.Z,[t(bs.Z,{attrs:{cols:"12",md:"6"}},[t(js.Z,{attrs:{outlined:""}},[t(Ks.EB,{staticClass:"text-h6"},[e._v("特技")]),t(Ks.ZB,[t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{dense:"",cols:"12",md:"4"}},[t(Ao.Z,{attrs:{dense:"",outlined:"",label:"特技","persistent-placeholder":"","persistent-hint":"",items:e.effectList,hint:e.bans.effect},on:{change:e.effectSelectChanged},model:{value:e.role.config.effect,callback:function(t){e.$set(e.role.config,"effect",t)},expression:"role.config.effect"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(zi.Z,{attrs:{label:"新创",dense:"","hide-details":""},on:{change:function(t){e.role.config.effect=null,e.effectSelectChanged()}},model:{value:e.role.options.effectCustom,callback:function(t){e.$set(e.role.options,"effectCustom",t)},expression:"role.options.effectCustom"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(zi.Z,{attrs:{label:"只看氪金",dense:"","hide-details":""},on:{change:function(t){e.role.config.effect=null,e.effectSelectChanged()}},model:{value:e.role.options.effectKeOnly,callback:function(t){e.$set(e.role.options,"effectKeOnly",t)},expression:"role.options.effectKeOnly"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}}),t(bs.Z,{attrs:{dense:"",cols:"12",md:"2"}},[t(Ys.Z,{staticClass:"centered-input",attrs:{label:"分数",outlined:"",dense:"",readonly:"","persistent-hint":"",value:e.objs.effect?.grade?.toFixed(2)||0,hint:e.objs.effect?.grade_detail}})],1)],1),e.role.options.effectDescShow?t(Xs.Z,{attrs:{label:"描述",outlined:"",dense:"",readonly:"","no-resize":"",rows:"3",value:e.objs.effect?.desc}}):e._e()],1)],1)],1),t(bs.Z,{attrs:{cols:"12",md:"6"}},[t(js.Z,{attrs:{outlined:""}},[t(Ks.EB,{staticClass:"text-h6"},[e._v("武功触发特技")]),t(Ks.ZB,[t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{dense:"",cols:"12",md:"4"}},[e.role.options.triggerCustom?e._e():t(Ao.Z,{attrs:{dense:"",outlined:"",label:"触发武功","persistent-placeholder":"","persistent-hint":"",items:e.triggerSkillList},on:{change:e.triggerSkillSelectChanged},model:{value:e.role.config.triggerSkill,callback:function(t){e.$set(e.role.config,"triggerSkill",t)},expression:"role.config.triggerSkill"}}),e.role.options.triggerCustom?t(Ao.Z,{attrs:{dense:"",outlined:"",label:"指定触发特技","persistent-placeholder":"","persistent-hint":"",items:e.triggerEffectList},on:{change:e.triggerEffectSelectChanged},model:{value:e.role.config.triggerSkill,callback:function(t){e.$set(e.role.config,"triggerSkill",t)},expression:"role.config.triggerSkill"}}):e._e()],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(zi.Z,{attrs:{label:"指定新创",dense:"","hide-details":""},on:{change:function(t){e.role.config.triggerSkill=null,e.role.options.triggerCustom?e.triggerEffectSelectChanged():e.triggerSkillSelectChanged()}},model:{value:e.role.options.triggerCustom,callback:function(t){e.$set(e.role.options,"triggerCustom",t)},expression:"role.options.triggerCustom"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(zi.Z,{attrs:{label:"只看氪金",dense:"","hide-details":""},on:{change:function(t){e.role.config.triggerSkill=null,e.role.options.triggerCustom?e.triggerEffectSelectChanged():e.triggerSkillSelectChanged()}},model:{value:e.role.options.triggerKeOnly,callback:function(t){e.$set(e.role.options,"triggerKeOnly",t)},expression:"role.options.triggerKeOnly"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}}),t(bs.Z,{attrs:{dense:"",cols:"12",md:"2"}},[t(Ys.Z,{staticClass:"centered-input",attrs:{label:"分数",outlined:"",dense:"",readonly:"","persistent-hint":"",value:e.triggerSkillGrade,suffix:"*0.5",hint:e.objs.trigger?.grade_detail}})],1)],1),e.role.options.effectDescShow?t(Xs.Z,{attrs:{label:"描述",outlined:"",dense:"",readonly:"","no-resize":"",rows:"3",value:e.objs.trigger?.desc}}):e._e()],1)],1)],1)],1),t("p")],1)],1),t("p"),t(eo.Z),t("p"),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",md:"10"}},[t(js.Z,{attrs:{flat:""}},[t(Ks.EB,[e._v("提交记录")]),t(Ks.ZB,[t(qs.Z,{staticClass:"elevation-1 table",staticStyle:{width:"100%"},attrs:{dense:"","show-select":"","hide-default-footer":"","calculate-widths":!0,headers:e.tableHeaders,items:e.tableItems,"items-per-page":100},scopedSlots:e._u([{key:"item.actions",fn:function({item:a}){return[t(ao.Z,{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(a)}}},[e._v(" mdi-pencil ")]),t(ao.Z,{attrs:{small:""},on:{click:function(t){return e.deleteItem(a)}}},[e._v(" mdi-delete ")])]}}],null,!0)})],1)],1)],1)],1)],1),t(Ji.Z,{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[t(js.Z,[t(Ks.EB,[e._v("确认删除["+e._s(e.deletingItem?e.deletingItem.name:"")+"]？")]),t(Ks.h7,[t(lo.Z),t(Ds.Z,{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.dialogDelete=!1}}},[e._v("取消")]),t(Ds.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.deleteItemConfirm}},[e._v("确认")]),t(lo.Z)],1)],1)],1)],1)],1)},Co=[];const Zo=[{text:"名称",value:"name"},{text:"称号",value:"title"},{text:"天赋",value:"talent"},{text:"特技",value:"effect"},{text:"触发武功",value:"trigger"},{text:"操作",value:"actions",sortable:!1}];var Io={name:"RoleCustomView",data(){return{role:new Aa,modified:!1,dialogDelete:!1,deletingItem:null,bottom:!1,objs:{title:null,talent:null,effect:null,trigger:null},bans:{title:"",talent:"",effect:""}}},methods:{save(){this.modified&&((0,ra.localSave)("curRole",this.role),this.modified=!1)},submit(){this.$store.dispatch("customRole/updateCustomRole",{name:this.role.base.name,role:new Aa(this.role)}),this.modified=!1},reset(){this.role=new Aa,this.modified=!1,this.objs={title:null,talent:null,effect:null,trigger:null},this.modified=!1},recalc(){this.titleSelectChanged(),this.talentSelectChanged(),this.effectSelectChanged(),this.role.options.triggerCustom?this.triggerEffectSelectChanged():this.triggerSkillSelectChanged()},editItem(e){const t=this.$store.state["customRole"].customRoles.find((t=>t.name===e.name));this.role=new Aa(t.role),this.titleSelectChanged(),this.talentSelectChanged(),this.effectSelectChanged(),this.role.options.triggerCustom?this.triggerEffectSelectChanged():this.triggerSkillSelectChanged(),this.modified=!1},deleteItem(e){this.dialogDelete=!0,this.deletingItem=e},deleteItemConfirm(){this.$store.dispatch("customRole/deleteCustomRole",{name:this.deletingItem.name}),this.dialogDelete=!1},elementChanged(){this.modified=!0},titleSelectChanged(){this.objs.title=this.role.getTitle(),this.bans.title=this.role.checkBan("title",this.objs.title?.id||0),this.elementChanged()},talentSelectChanged(){this.objs.talent=this.role.getSkill(this.role.config.talent),this.bans.talent=this.role.checkBan("talent",this.objs.talent?.id||0),this.elementChanged()},effectSelectChanged(){this.objs.effect=this.role.getSkill(this.role.config.effect),this.bans.effect=this.role.checkBan("effect",this.objs.effect?.id||0),this.elementChanged()},triggerSkillSelectChanged(){const e=this.role.getSkill(this.role.config.triggerSkill);if(-1==e.id)return void(this.objs.trigger=null);const t=u(e.id);this.objs.trigger=this.role.getSkill(`std:${t["trigger_effect"][0]}`),this.elementChanged()},triggerEffectSelectChanged(){this.objs.trigger=this.role.getSkill(this.role.config.triggerSkill),this.elementChanged()}},computed:{isEdit(){return void 0!==this.$store.state["customRole"].customRoles.find((e=>e.name===this.role.base.name))},tableHeaders(){return Zo},tableItems(){return this.$store.state["customRole"].customRoles.map((({name:e,role:t})=>{const a=new Aa(t);return{id:e,name:e,title:a.getTitle().name,talent:a.getSkill(a.config.talent).name,effect:a.getSkill(a.config.effect).name,trigger:a.getSkill(a.config.triggerSkill).name,action:"删除"}}))},totalGrade(){let e=0;return e+=this.objs.title?.grade||0,e+=this.objs.talent?.grade||0,e+=this.objs.effect?.grade||0,e+=.5*this.objs.trigger?.grade||0,this.role.config.twoHands&&(e+=1),this.role.base.round<4&&this.role.config.harmony&&(e+=1),e.toFixed(2)},titleList(){return[{text:"",value:null}].concat(Ea().filter((e=>!this.role.options.titleScoreOnly||e.grade>0)))},talentList(){return[{text:"",value:null}].concat(Pa(this.role).filter((e=>this.role.options.talentKeOnly?e.ke:!e.ke||this.role.options.talentCustom)))},effectList(){return[{text:"",value:null}].concat(Fa(this.role).filter((e=>this.role.options.effectKeOnly?e.ke:!e.ke||this.role.options.effectCustom)))},triggerEffectList(){return[{text:"",value:null}].concat(Fa(this.role))},triggerSkillList(){return this.$store.getters["isReady"]?[{text:"",value:null}].concat(Oa(this.role).filter((e=>this.role.options.triggerKeOnly?e.ke:!e.ke)).map((e=>({...e})))):[]},triggerSkillHint(){if(!this.objs.trigger)return"";const e=u(this.objs.trigger.id);return`触发特技：[${e?.id}]${e?.name||""}`},triggerSkillGrade(){return this.objs.trigger?this.objs.trigger.grade.toFixed(2):0}}},Eo=Io,Po=(0,xs.Z)(Eo,wo,Co,!1,null,"bebdcffa",null),Fo=Po.exports,Oo=function(){var e=this,t=e._self._c;return t(vs.Z,[t("h1",{attrs:{id:"-"}},[e._v("基础规则")]),t("p",[e._v("零、本规则对2周/4周氪学家有效，"),t("a",{staticStyle:{color:"red"}},[e._v("6周科学家不受本规则约束，通用设定除外。")])]),t("p",[e._v("一、数值只能取5的倍数，不能取121%、89%之类的数值。")]),t("p",[e._v("二、订制天赋/特技使用负面效果不进行扣分；使用本土配置中的负面效果按效果扣分。光环效果禁止存在负面。 ")]),t("p",[e._v("三、如因游戏调整导致实际分值超过规则限制，应及时调整使分值符合规则限定。如不想临时调整，则设定时分数应空余2.5分以上。")]),t("p",[e._v("四、四周：属性类词条（即可叠乘的项目，如攻防轻序威命伤）的增减最高不超过1项±50、或2项±40。功能性词条（即不可叠乘的项目，如出招、双击、暴击、反震反弹挪移、异常概率，受伤度虽可叠乘也可归类此处）不超过100。移动、范围、距离不超过5。")]),t("p",[e._v("五、定制特技低于10分以实际分值为准，高于10分按10分计。高于10分的自创特技不能通过武功共享给其他人。 自创4周特技不高于15分（同四周天赋）；自创2周特技（自挂）不高于7.5分（同2周天赋）；自创2周特技（武功带）不高于10分（约通用特技）。单项均参照本周目天赋限制设定。 不能共享高于本周目限制的特技。")]),t("p",[e._v("六、定制套装不计入分值，但套装天赋不能高于同周目天赋分值上限，也不能使用本周目禁用的天赋。 单个散件和套装属性中对任意一项数值的加成不超过300。")]),t("p",[e._v("七、使用本土天赋时，按如下规则计分：1、能通过表格计算的天赋（葵花百劫、至大乾元等），以实际分值计算（特别的，初阶天赋分值=实际分值"),t("em",[e._v("0.5+进阶天赋实际分值")]),e._v("0.5） 2、不能通过表格计算的功能性天赋（风云再起、天威奋烈等），2周可用的按5分计算，2周不可用4周可用的按10分计算，时乘六龙按12.5分计算。")]),t("p",[e._v("八、2周单氪内轻为单五级，双氪内轻为双5级，均限制使用明神武典/天魔功极/凌波微步。2周四氪以上，可使用明神武典/天魔功极/凌波微步。")]),t("p",[e._v("九、十氪及以上"),t("a",{staticStyle:{color:"red"}},[e._v("（修正：不再要求十氪）")]),e._v("，可以用分值兑换“两次攻击”=1分。十氪及以上的2周人物，可以用分值兑换“内力调和”=1分。 ")]),t("p",[e._v("十、自创武功威力=360 / 10威力系数，威力系数与范围移动有关，标准2气；自伤与否不影响威力；3气增加500威力；每少1气，减少500威力。 ")]),t("h1",{attrs:{id:"h1"}},[e._v("周目规则")]),t("table",[t("thead",[t("tr",[t("th",[e._v("四周难三")]),t("th",[e._v("天赋分值")]),t("th",[e._v("配置总分")]),t("th",[e._v("单项词条限制上限")]),t("th",[e._v("本土天赋限制")]),t("th",[e._v("称号限制")]),t("th",[e._v("特技限制")])])]),t("tbody",[t("tr",[t("td",[e._v("单氪")]),t("td",[e._v("12.5")]),t("td",[e._v("25")]),t("td",[e._v("增益1.5，减益0.5")]),t("td",{attrs:{rowspan:"3"}},[e._v("苍空战旗、千骑万军、天子龙气")]),t("td",{attrs:{rowspan:"3"}},[e._v("无")]),t("td",{attrs:{rowspan:"3"}},[e._v("星空、天极、道心 水击、万象、变身")])]),t("tr",[t("td",[e._v("双氪以上")]),t("td",[e._v("15")]),t("td",[e._v("30")]),t("td",[e._v("增益1.5，减益0.5")])]),t("tr",[t("td",[e._v("光环天赋")]),t("td",[e._v("15")]),t("td",[e._v("30")]),t("td",[e._v("增益1.2，减益0.7")])])])]),t("p"),t("table",[t("thead",[t("tr",[t("th",[e._v("二周难四")]),t("th",[e._v("天赋分值")]),t("th",[e._v("配置总分")]),t("th",[e._v("单项词条限制上限")]),t("th",[e._v("本土天赋限制")]),t("th",[e._v("称号限制")]),t("th",[e._v("特技限制")])])]),t("tbody",[t("tr",[t("td",[e._v("单氪")]),t("td",[e._v("5")]),t("td",[e._v("12.5")]),t("td",[e._v("增益1.2，减益0.7")]),t("td",{attrs:{rowspan:"3"}},[e._v("苍空战旗、千骑万军、天子龙气"),t("br"),e._v("时乘六龙、天元剑气、至大乾元"),t("br"),e._v(" 国士无双、风云再起、葵花百劫"),t("br"),e._v("极道归元、长生不息、无我无剑"),t("br"),e._v(" 逍遥极乐、例不虚发、玲珑璇玑"),t("br"),e._v("天灵剑幻、武中无相")]),t("td",{attrs:{rowspan:"3"}},[e._v("六如、太上、老张、表妹"),t("br"),e._v(" 蝠王、香帅、玄冥、邪王"),t("br"),e._v("黄蓉、霓裳、剑仙、无名 ")]),t("td",{attrs:{rowspan:"3"}},[e._v("星空、天极、道心、水击、万象、变身"),t("br"),e._v(" 神游、七光、战神、天地、天道、紫气"),t("br"),e._v(" 自创武功通用特技（15%类) ")])]),t("tr",[t("td",[e._v("双氪以上")]),t("td",[e._v("7.5")]),t("td",[e._v("15")]),t("td",[e._v("增益1.2，减益0.7")])]),t("tr",[t("td",[e._v("光环天赋")]),t("td",[e._v("7.5")]),t("td",[e._v("15")]),t("td",[e._v("增益1.1，减益0.9")])])])])])},To=[],Bo={name:"ConfigRule"},Vo=Bo,Do=(0,xs.Z)(Vo,Oo,To,!1,null,"56f93c4e",null),jo=Do.exports,Ko={name:"CustomSimulatorView",data(){return{}},components:{SkillCustomView:bo,CalcRuleView:So,RoleCustomView:Fo,ConfigRule:jo}},Go=Ko,Ro=(0,xs.Z)(Go,Xi,Wi,!1,null,"57514700",null),qo=Ro.exports,Mo=a(9570),No=a(3201),Ho=a(9258),Uo=function(){var e=this,t=e._self._c;return t(js.Z,[t(Ks.ZB,[t(to.Z,[t(js.Z,{attrs:{flat:""}},[t(Ks.EB,[e._v("模拟方案")]),t(Ks.ZB,[t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(Mo.Z,{attrs:{outlined:"",dense:"",label:"方案名",items:e.portfolioList},model:{value:e.learnPortfolio.base.name,callback:function(t){e.$set(e.learnPortfolio.base,"name",t)},expression:"learnPortfolio.base.name"}})],1),t(bs.Z,{attrs:{cols:"12",md:"6"}}),t(bs.Z,{attrs:{cols:"12",md:"4"}},[t(vs.Z,[t(No.Z,{attrs:{row:""}},[t(Ds.Z,e._b({on:{click:e.save}},"v-btn",e.btnProps,!1),[e._v("保存")]),t(Ds.Z,e._b({on:{click:e.load}},"v-btn",e.btnProps,!1),[e._v("加载")]),t(Ds.Z,e._b({on:{click:e.del}},"v-btn",e.btnProps,!1),[e._v("删除")]),t(Ds.Z,e._b({on:{click:e.clear}},"v-btn",e.btnProps,!1),[e._v("重置")]),t(Ds.Z,e._b({attrs:{disabled:""}},"v-btn",e.btnProps,!1),[e._v("导出")]),t(Ds.Z,e._b({attrs:{disabled:""}},"v-btn",e.btnProps,!1),[e._v("导入")])],1)],1)],1)],1)],1)],1),t(js.Z,{attrs:{flat:""}},[t(Ks.EB,[e._v("周目路线")]),t(Ks.ZB,[t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:[1,2,3,4,5,6],label:"周目"},on:{change:e.roundChanged},model:{value:e.learnPortfolio.base.round,callback:function(t){e.$set(e.learnPortfolio.base,"round",t)},expression:"learnPortfolio.base.round"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:e.config.branches["拜师"],label:"拜师","persistent-hint":!1},model:{value:e.learnPortfolio.branches["拜师"],callback:function(t){e.$set(e.learnPortfolio.branches,"拜师",t)},expression:"learnPortfolio.branches['拜师']"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:e.config.branches["结局"],label:"结局","persistent-hint":!1},model:{value:e.learnPortfolio.branches["结局"],callback:function(t){e.$set(e.learnPortfolio.branches,"结局",t)},expression:"learnPortfolio.branches['结局']"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(Ds.Z,e._b({on:{click:e.randomBranch}},"v-btn",e.btnProps,!1),[e._v("随一手")])],1)],1),e._l(e.branches,(function(a){return t(_s.Z,{key:a.index,attrs:{dense:""}},[e._l(a.cols,(function(a){return[t(bs.Z,{key:a.index,attrs:{md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:a.list,label:a.name,disabled:e.config.lockedBranches.includes(a.name)},on:{change:e.branchChanged},model:{value:e.learnPortfolio.branches[a.name],callback:function(t){e.$set(e.learnPortfolio.branches,a.name,t)},expression:"learnPortfolio.branches[col.name]"}})],1)]}))],2)})),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:e.config.branches["华山绝顶分歧"],label:"华山绝顶分歧","persistent-hint":!1},model:{value:e.learnPortfolio.branches["华山绝顶分歧"],callback:function(t){e.$set(e.learnPortfolio.branches,"华山绝顶分歧",t)},expression:"learnPortfolio.branches['华山绝顶分歧']"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:e.config.branches["降龙支线分歧"],label:"降龙支线分歧","persistent-hint":!1},model:{value:e.learnPortfolio.branches["降龙支线分歧"],callback:function(t){e.$set(e.learnPortfolio.branches,"降龙支线分歧",t)},expression:"learnPortfolio.branches['降龙支线分歧']"}})],1),t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:e.config.branches["上侠客岛分歧"],label:"上侠客岛分歧","persistent-hint":!1},model:{value:e.learnPortfolio.branches["上侠客岛分歧"],callback:function(t){e.$set(e.learnPortfolio.branches,"上侠客岛分歧",t)},expression:"learnPortfolio.branches['上侠客岛分歧']"}})],1),"武当线"==e.learnPortfolio.branches["倚天"]?t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:e.config.branches["武当线分歧"],label:"武当线分歧","persistent-hint":!1},model:{value:e.learnPortfolio.branches["武当线分歧"],callback:function(t){e.$set(e.learnPortfolio.branches,"武当线分歧",t)},expression:"learnPortfolio.branches['武当线分歧']"}})],1):e._e(),"莫愁线"==e.learnPortfolio.branches["神雕"]?t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:e.config.branches["莫愁线分歧"],label:"莫愁线分歧","persistent-hint":!1},model:{value:e.learnPortfolio.branches["莫愁线分歧"],callback:function(t){e.$set(e.learnPortfolio.branches,"莫愁线分歧",t)},expression:"learnPortfolio.branches['莫愁线分歧']"}})],1):e._e(),"水笙线"==e.learnPortfolio.branches["连城"]?t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:e.config.branches["水笙线分歧"],label:"水笙线分歧","persistent-hint":!1},model:{value:e.learnPortfolio.branches["水笙线分歧"],callback:function(t){e.$set(e.learnPortfolio.branches,"水笙线分歧",t)},expression:"learnPortfolio.branches['水笙线分歧']"}})],1):e._e(),"戚芳线"==e.learnPortfolio.branches["连城"]?t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:e.config.branches["戚芳线分歧"],label:"戚芳线分歧","persistent-hint":!1},model:{value:e.learnPortfolio.branches["戚芳线分歧"],callback:function(t){e.$set(e.learnPortfolio.branches,"戚芳线分歧",t)},expression:"learnPortfolio.branches['戚芳线分歧']"}})],1):e._e(),"霜华线"==e.learnPortfolio.branches["连城"]?t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:e.config.branches["霜华线分歧"],label:"霜华线分歧","persistent-hint":!1},model:{value:e.learnPortfolio.branches["霜华线分歧"],callback:function(t){e.$set(e.learnPortfolio.branches,"霜华线分歧",t)},expression:"learnPortfolio.branches['霜华线分歧']"}})],1):e._e(),"阿曼线"==e.learnPortfolio.branches["白马"]?t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(so.Z,{staticStyle:{width:"80%"},attrs:{outlined:"",dense:"","hide-details":"",items:e.config.branches["阿曼线分歧"],label:"阿曼线分歧","persistent-hint":!1},model:{value:e.learnPortfolio.branches["阿曼线分歧"],callback:function(t){e.$set(e.learnPortfolio.branches,"阿曼线分歧",t)},expression:"learnPortfolio.branches['阿曼线分歧']"}})],1):e._e()],1)],2)],1),t(js.Z,{attrs:{flat:""}},[t(Ks.EB,[e._v("人物模拟")]),t(Ks.ZB,[t(_s.Z,[t(bs.Z,{attrs:{cols:"12",md:"2"}},[t(Ao.Z,{attrs:{dense:"",outlined:"",label:"人物选择","persistent-placeholder":"","persistent-hint":"",items:e.roles},on:{change:e.roleSelectChanged},model:{value:e.select.role,callback:function(t){e.$set(e.select,"role",t)},expression:"select.role"}})],1),t(bs.Z,{attrs:{cols:"12",md:"10"}},[t(Rs.Z,{attrs:{column:"",mandatory:"","active-class":"primary--text text--accent-4"},model:{value:e.select.roleGroup,callback:function(t){e.$set(e.select,"roleGroup",t)},expression:"select.roleGroup"}},e._l(e.config.roleGroupType,(function(a){return t(Gs.Z,{key:a,attrs:{outlined:"",value:a},on:{change:e.roleGroupChanged}},[e._v(" "+e._s(a)+" ")])})),1)],1)],1),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{md:"1"}},[t("h3",[e._v("基本信息")])]),t(bs.Z,{attrs:{md:"1"}},[t(Ys.Z,{attrs:{readonly:"",dense:"",label:"名称",value:e.roleInfo.name||"未选择"}})],1),t(bs.Z,{attrs:{md:"1"}},[t(Ys.Z,{attrs:{readonly:"",dense:"",label:"等级",value:e.roleInfo.level||0}})],1),t(bs.Z,{attrs:{md:"1"}},[e.isChief&&e.learnPortfolio.chief.origin&&9!=e.learnPortfolio.chief.talent?e._e():t(Ys.Z,{attrs:{readonly:"",dense:"",label:"内力性质",value:e.roleInfo.mpKind}}),e.isChief&&e.learnPortfolio.chief.origin&&9!=e.learnPortfolio.chief.talent?t(so.Z,{attrs:{dense:"",label:"内力性质选择",items:["阴","阳"]},on:{change:e.originRoleChanged},model:{value:e.learnPortfolio.chief.mpKind,callback:function(t){e.$set(e.learnPortfolio.chief,"mpKind",t)},expression:"learnPortfolio.chief.mpKind"}}):e._e()],1),t(bs.Z,{attrs:{md:"1"}},[e.isChief&&e.learnPortfolio.chief.origin?e._e():t(Ys.Z,{attrs:{readonly:"",dense:"",label:"资质",value:e.roleInfo.itl||0}}),e.isChief&&e.learnPortfolio.chief.origin?t(so.Z,{attrs:{dense:"",label:"资质选择",items:[50,100]},on:{change:e.originRoleChanged},model:{value:e.learnPortfolio.chief.itl,callback:function(t){e.$set(e.learnPortfolio.chief,"itl",t)},expression:"learnPortfolio.chief.itl"}}):e._e()],1),t(bs.Z,{attrs:{md:"1"}},[e.isChief&&e.learnPortfolio.chief.origin?e._e():t(Ys.Z,{attrs:{readonly:"",dense:"",label:"性别",value:e.roleInfo.gender}}),e.isChief&&e.learnPortfolio.chief.origin?t(so.Z,{attrs:{dense:"",label:"性别选择",items:["男","妖"]},on:{change:e.originRoleChanged},model:{value:e.learnPortfolio.chief.gender,callback:function(t){e.$set(e.learnPortfolio.chief,"gender",t)},expression:"learnPortfolio.chief.gender"}}):e._e()],1),t(bs.Z,{attrs:{md:"1"}},[t(Ys.Z,{attrs:{readonly:"",dense:"",label:"血族",value:e.roleInfo.family||"无"}})],1),t(bs.Z,{attrs:{md:"1"}},[t(Ys.Z,{attrs:{readonly:"",dense:"",label:"门派",value:e.roleInfo.party||"无"}})],1),t(bs.Z,{attrs:{md:"1"}},[t(Ys.Z,{attrs:{readonly:"",dense:"",label:"初始用毒",value:e.roleInfo.poison||0}})],1),e.isChief?t(bs.Z,{attrs:{md:"1"}},[t(zi.Z,{attrs:{dense:"",label:"原始人"},on:{change:e.roleSelectChanged},model:{value:e.learnPortfolio.chief.origin,callback:function(t){e.$set(e.learnPortfolio.chief,"origin",t)},expression:"learnPortfolio.chief.origin"}})],1):e._e(),e.isChief&e.learnPortfolio.chief.origin?t(bs.Z,{attrs:{md:"1"}},[t(so.Z,{attrs:{dense:"",label:"初始天赋",items:e.config.originTalents},on:{change:e.originRoleChanged},model:{value:e.learnPortfolio.chief.talent,callback:function(t){e.$set(e.learnPortfolio.chief,"talent",t)},expression:"learnPortfolio.chief.talent"}})],1):e._e(),e.isChief&!e.learnPortfolio.chief.origin?t(bs.Z,{attrs:{md:"1"}},[t(Ao.Z,{attrs:{dense:"",label:"复制人选择",items:e.cloneRoles},on:{change:e.cloneRoleSelectChanged},model:{value:e.learnPortfolio.chief.cloneId,callback:function(t){e.$set(e.learnPortfolio.chief,"cloneId",t)},expression:"learnPortfolio.chief.cloneId"}})],1):e._e()],1),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{md:"1"}},[t("h3",[e._v("基础属性")])]),e._l(e.config.attrs,(function(a){return t(bs.Z,{key:`${a}_base`,attrs:{cols:"auto",md:"1"}},[t(Ys.Z,{attrs:{readonly:"",dense:"",label:`${a}`,value:e.roleInfo.attrs.base[a]||0}})],1)})),t(bs.Z,{attrs:{cols:"auto",md:"1"}},[t(Ys.Z,{attrs:{readonly:"",dense:"",label:"根骨",value:e.roleInfo.attrs.base["根骨"]||0}})],1)],2),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{md:"1"}},[t("h3",[e._v("修炼增加")])]),e._l(e.config.attrs,(function(a){return t(bs.Z,{key:`${a}_learn`,attrs:{cols:"auto",md:"1"}},[t(Ys.Z,{attrs:{readonly:"",dense:"",label:`${a}`,value:e.roleInfo.attrs.learn[a]||0}})],1)}))],2),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{md:"1"}},[t("h3",[e._v("投入根骨")])]),e._l(e.config.attrs.slice(0,-1),(function(a){return t(bs.Z,{key:`${a}_add`,attrs:{cols:"auto",md:"1"}},[t(Ys.Z,{attrs:{dense:"",outlined:"",label:`${a}`,rules:[e.numberRules]},on:{change:function(t){return e.roleInfo.updateAddonAttr(e.learnRole.attrsAddon)}},model:{value:e.learnRole.attrsAddon[a],callback:function(t){e.$set(e.learnRole.attrsAddon,a,t)},expression:"learnRole.attrsAddon[attr]"}})],1)})),t(bs.Z,{attrs:{cols:"auto",md:"1"}},[t(Ys.Z,{attrs:{readonly:"",dense:"",label:"剩余根骨",value:e.roleInfo.attrs.total["根骨"]||0}})],1),t(bs.Z,{attrs:{md:"1"}},[t(Ys.Z,{attrs:{readonly:"",dense:"",label:"明玉丹额度",value:e.roleInfo.mingyu||0}})],1)],2),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{md:"1"}},[t("h3",[e._v("最终属性")])]),e._l(e.config.attrs,(function(a){return t(bs.Z,{key:`${a}_final`,attrs:{cols:"auto",md:"1"}},[t(Ys.Z,{attrs:{readonly:"",dense:"",label:`${a}`,value:e.roleInfo.attrs.total[a]||0}})],1)}))],2),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",md:"6"}},[t(js.Z,[t(Ks.EB,[e._v("修炼")]),t(Ks.ZB,{staticStyle:{height:"40.5rem"}},[t(vs.Z,[t(No.Z,{attrs:{row:""}},[t(Rs.Z,{attrs:{column:"",mandatory:"","active-class":"primary--text text--accent-4"},model:{value:e.select.learnTab,callback:function(t){e.$set(e.select,"learnTab",t)},expression:"select.learnTab"}},e._l(e.config.learnType,(function(a){return t(Gs.Z,{key:a,attrs:{outlined:""}},[e._v(" "+e._s(a)+" ")])})),1),t(lo.Z),t(zi.Z,{staticStyle:{"margin-right":"5px","margin-left":"5px"},attrs:{"hide-details":"",dense:"",label:"无相"},model:{value:e.select.flagWx,callback:function(t){e.$set(e.select,"flagWx",t)},expression:"select.flagWx"}}),t(zi.Z,{staticStyle:{"margin-right":"5px","margin-left":"5px"},attrs:{"hide-details":"",dense:"",label:"璇玑"},model:{value:e.select.flagXj,callback:function(t){e.$set(e.select,"flagXj",t)},expression:"select.flagXj"}}),t(zi.Z,{staticStyle:{"margin-right":"5px","margin-left":"5px"},attrs:{"hide-details":"",dense:"",label:"灵犀"},model:{value:e.select.flagLx,callback:function(t){e.$set(e.select,"flagLx",t)},expression:"select.flagLx"}})],1)],1),t(qs.Z,{staticStyle:{overflow:"scroll",height:"35.5rem"},attrs:{dense:"","show-select":"","hide-default-footer":"","single-select":!1,headers:e.learnHeaders,items:e.learnItems,"items-per-page":-1,"no-data-text":"","disable-sort":""},scopedSlots:e._u([{key:"top",fn:function(){return[t(no.Z,{attrs:{flat:""}},[t(Ds.Z,e._b({attrs:{disabled:!e.select.learnSelect.length},on:{click:e.upMoveBook}},"v-btn",e.btnProps,!1),[e._v("上移")]),t(Ds.Z,e._b({attrs:{disabled:!e.select.learnSelect.length},on:{click:e.downMoveBook}},"v-btn",e.btnProps,!1),[e._v("下移")]),t(Ds.Z,e._b({attrs:{disabled:!e.select.learnSelect.length},on:{click:e.deleteBook}},"v-btn",e.btnProps,!1),[e._v("删除")]),t(Ji.Z,{attrs:{"max-width":"500px"},scopedSlots:e._u([{key:"activator",fn:function({on:a}){return[t(Ds.Z,e._g(e._b({attrs:{disabled:4!=e.select.learnTab}},"v-btn",e.btnProps,!1),a),[e._v("添加")])]}}]),model:{value:e.select.eventPropDialog,callback:function(t){e.$set(e.select,"eventPropDialog",t)},expression:"select.eventPropDialog"}},[t(js.Z,[t(Ks.EB,[t("span",{staticClass:"text-h5"},[e._v("添加事件属性")])]),t(Ks.ZB,[t(vs.Z,[t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",sm:"12",md:"12"}},[t(Ys.Z,{attrs:{dense:"",label:"事件名称"},model:{value:e.select.propEvent.name,callback:function(t){e.$set(e.select.propEvent,"name",t)},expression:"select.propEvent.name"}})],1)],1),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",sm:"4"}},[t(Ys.Z,{attrs:{dense:"",label:"加攻击"},model:{value:e.select.propEvent.attrs["攻击"],callback:function(t){e.$set(e.select.propEvent.attrs,"攻击",t)},expression:"select.propEvent.attrs['攻击']"}})],1),t(bs.Z,{attrs:{cols:"12",sm:"4"}},[t(Ys.Z,{attrs:{dense:"",label:"加防御"},model:{value:e.select.propEvent.attrs["防御"],callback:function(t){e.$set(e.select.propEvent.attrs,"防御",t)},expression:"select.propEvent.attrs['防御']"}})],1),t(bs.Z,{attrs:{cols:"12",sm:"4"}},[t(Ys.Z,{attrs:{dense:"",label:"加轻功"},model:{value:e.select.propEvent.attrs["轻功"],callback:function(t){e.$set(e.select.propEvent.attrs,"轻功",t)},expression:"select.propEvent.attrs['轻功']"}})],1)],1),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",sm:"4"}},[t(Ys.Z,{attrs:{dense:"",label:"加拳掌"},model:{value:e.select.propEvent.attrs["拳掌"],callback:function(t){e.$set(e.select.propEvent.attrs,"拳掌",t)},expression:"select.propEvent.attrs['拳掌']"}})],1),t(bs.Z,{attrs:{cols:"12",sm:"4"}},[t(Ys.Z,{attrs:{dense:"",label:"加御剑"},model:{value:e.select.propEvent.attrs["御剑"],callback:function(t){e.$set(e.select.propEvent.attrs,"御剑",t)},expression:"select.propEvent.attrs['御剑']"}})],1),t(bs.Z,{attrs:{cols:"12",sm:"4"}},[t(Ys.Z,{attrs:{dense:"",label:"加兵器"},model:{value:e.select.propEvent.attrs["兵器"],callback:function(t){e.$set(e.select.propEvent.attrs,"兵器",t)},expression:"select.propEvent.attrs['兵器']"}})],1)],1),t(_s.Z,{attrs:{dense:""}},[t(bs.Z,{attrs:{cols:"12",sm:"4"}},[t(Ys.Z,{attrs:{dense:"",label:"加指腿"},model:{value:e.select.propEvent.attrs["指腿"],callback:function(t){e.$set(e.select.propEvent.attrs,"指腿",t)},expression:"select.propEvent.attrs['指腿']"}})],1),t(bs.Z,{attrs:{cols:"12",sm:"4"}},[t(Ys.Z,{attrs:{dense:"",label:"加暗毒"},model:{value:e.select.propEvent.attrs["暗毒"],callback:function(t){e.$set(e.select.propEvent.attrs,"暗毒",t)},expression:"select.propEvent.attrs['暗毒']"}})],1),t(bs.Z,{attrs:{cols:"12",sm:"4"}},[t(Ys.Z,{attrs:{dense:"",label:"加武常"},model:{value:e.select.propEvent.attrs["武常"],callback:function(t){e.$set(e.select.propEvent.attrs,"武常",t)},expression:"select.propEvent.attrs['武常']"}})],1)],1)],1)],1),t(Ks.h7,[t(lo.Z),t(Ds.Z,{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.select.eventPropDialog=!1}}},[e._v(" 取消 ")]),t(Ds.Z,{attrs:{color:"blue darken-1",text:""},on:{click:e.addPropEvent}},[e._v(" 确定 ")])],1)],1)],1)],1)]},proxy:!0}]),model:{value:e.select.learnSelect,callback:function(t){e.$set(e.select,"learnSelect",t)},expression:"select.learnSelect"}})],1)],1)],1),t(bs.Z,{attrs:{cols:"12",md:"6"}},[t(js.Z,[t(Ks.EB,[e._v("秘籍")]),t(Ks.ZB,{staticStyle:{height:"40.5rem"}},[t(vs.Z,[t(No.Z,{attrs:{row:""}},[t(Rs.Z,{attrs:{column:"",mandatory:"","active-class":"primary--text text--accent-4"},on:{change:e.bookTagChanged},model:{value:e.select.bookTab,callback:function(t){e.$set(e.select,"bookTab",t)},expression:"select.bookTab"}},e._l(e.config.bookType,(function(a){return t(Gs.Z,{key:a,attrs:{outlined:""}},[e._v(" "+e._s(a)+" ")])})),1),t(lo.Z),t(so.Z,{staticStyle:{"text-align":"center",width:"4rem"},attrs:{dense:"",label:"等级",items:e.bookLevels,"hide-details":""},model:{value:e.select.bookLevel,callback:function(t){e.$set(e.select,"bookLevel",t)},expression:"select.bookLevel"}})],1)],1),t(qs.Z,{staticStyle:{overflow:"scroll",height:"35.5rem"},attrs:{dense:"","hide-default-footer":"","show-group-by":"",headers:e.bookHeaders,items:e.bookItems,"no-data-text":"","items-per-page":-1,search:e.select.search},on:{"dblclick:row":e.learnBook},scopedSlots:e._u([{key:"top",fn:function(){return[t(no.Z,{attrs:{flat:""}},[t(Ys.Z,{staticClass:"mb-2",staticStyle:{"max-width":"100%"},attrs:{dense:"","append-icon":"mdi-magnify",label:"搜索","single-line":"","hide-details":"",clearable:""},model:{value:e.select.search,callback:function(t){e.$set(e.select,"search",t)},expression:"select.search"}}),t(zi.Z,{attrs:{label:"可修炼","hide-details":"",dense:""},model:{value:e.select.available,callback:function(t){e.$set(e.select,"available",t)},expression:"select.available"}}),t(zi.Z,{attrs:{label:"可获取",disabled:"","hide-details":"",dense:""},model:{value:e.select.obtainable,callback:function(t){e.$set(e.select,"obtainable",t)},expression:"select.obtainable"}})],1)]},proxy:!0}])})],1)],1)],1)],1)],1)],1)],1),t(Ho.Z,{attrs:{"multi-line":!0,color:"success",outlined:""},scopedSlots:e._u([{key:"action",fn:function({attrs:a}){return[t(Ds.Z,e._b({attrs:{color:"red",text:""},on:{click:function(t){e.select.snackbar=!1}}},"v-btn",a,!1),[e._v(" 关闭 ")])]}}]),model:{value:e.select.snackbar,callback:function(t){e.$set(e.select,"snackbar",t)},expression:"select.snackbar"}},[e._v(" "+e._s(e.select.msg)+" ")])],1)],1)},Qo=[];const Yo=[["飞雪","连城","天龙","射雕","白马","鹿鼎"],["笑傲","书剑","神雕","侠客","倚天","碧血"]],Xo=["射雕","白马","鹿鼎"],Wo=["主角团","飞雪","连城","天龙","射雕","白马","鹿鼎","笑傲","书剑","神雕","侠客","倚天","碧血","鸳鸯","男队友","氪金人","其他"],zo=["攻击","防御","轻功","拳掌","御剑","兵器","指腿","暗毒","武常"],Jo=["修炼","洗武","明玉","特殊秘籍","事件加属性"],ec=["拳掌","御剑","兵器","指腿","暗毒","内功","轻功","防功","特殊"],tc=["拳系","剑系","兵系","特系","暗系","医疗","用毒","口才","美食","魅力"],ac=[dl("","","栏位","col",{align:"start"}),dl("","","名称","name"),dl("","","修炼效果","effect"),dl("","","标签","tag")],sc=[dl("","","等级","level",{filterable:!1}),dl("","","名称","name",{sortable:!1}),dl("","","需求","require",{sortable:!1,filterable:!1}),dl("","","修炼效果","effect",{sortable:!1,filterable:!1})];var lc={name:"LearnSimulator",components:{},data(){return{roleInfo:new Ha,learnRole:new Xa({id:0}),config:{branches:Ka,lockedBranches:Xo,attrs:zo,learnType:Jo,bookType:ec,roleGroupType:Wo,originTalents:tc.map(((e,t)=>({text:e,value:t})))},select:{role:null,roleGroup:0,learnTab:0,bookTab:0,learnSelect:[],eventPropDialog:!1,propEvent:{attrs:{}},bookLevel:"不限",snackbar:!1,available:!1,obtainable:!1,flagXj:!1,flagLx:!1,flagWx:!1,msg:"",search:""}}},methods:{save(){this.learnRole.isEmpty()||this.learnPortfolio.updateRole(this.learnRole),this.$store.dispatch("learnSim/saveLearnPortfolio",{name:this.learnPortfolio.base.name,portfolio:this.learnPortfolio})},load(){this.$store.dispatch("learnSim/loadLearnPortfolio",{name:this.learnPortfolio.base.name}).then((()=>{this.resetView()}))},del(){this.$store.dispatch("learnSim/deleteLearnPortfolio",{name:this.learnPortfolio.base.name}).then((()=>{this.resetView()}))},clear(){this.$store.dispatch("learnSim/clearLearnPortfolio").then((()=>{this.resetView()}))},resetView(){this.select.role=0,this.roleSelectChanged()},roundChanged(){this.roleInfo.changeRound(this.learnPortfolio.base.round)},branchChanged(){this.$store.state["learnSim"].curLearnPortfolio.fixBranches()},randomBranch(){this.$store.state["learnSim"].curLearnPortfolio.randomBranches(),this.$store.state["learnSim"].curLearnPortfolio.fixBranches()},roleGroupChanged(){this.select.role=null},roleSelectChanged(){if(null==this.select.role)return;if(this.learnRole=this.learnPortfolio.getRoleScheme(this.select.role),0==this.select.role)return void(this.learnPortfolio.chief.origin?this.originRoleChanged():this.cloneRoleSelectChanged());this.learnRole.isEmpty()||this.learnPortfolio.updateRole(this.learnRole);const e=c(this.select.role);this.roleInfo=new Ha(e,this.learnRole),this.afterRoleChanged(e)},cloneRoleSelectChanged(){if(0!=this.select.role||this.learnPortfolio.chief.origin||0==this.learnPortfolio.chief.cloneId)return;const e=c(this.learnPortfolio.chief.cloneId);this.roleInfo=new Ha(e,this.learnRole,{name:"谢衡",clone:!0}),this.afterRoleChanged(e)},originRoleChanged(){if(0!=this.select.role||!this.learnPortfolio.chief.origin)return;const e=c(0);this.roleInfo=new Ha(e,this.learnRole,{origin:{talent:this.learnPortfolio.chief.talent,itl:this.learnPortfolio.chief.itl,mpKind:this.learnPortfolio.chief.mpKind,gender:this.learnPortfolio.chief.gender}}),this.afterRoleChanged(e)},afterRoleChanged(e){this.roleInfo.changeRound(this.learnPortfolio.base.round),this.roleInfo.updateAddonAttr(this.learnRole.attrsAddon),this.select.flagWx=805==e["talent"],this.select.flagXj=806==e["talent"],this.select.flagLx=828==e["talent"],this.roleInfo.recalcLearn(),this.roleInfo.recalcFinalAttr()},learnBook(e,t){if("事件加属性"==Jo[this.select.learnTab])return;let a={id:t.item.id};const s=f(t.item.id);let l=!1;s["targetSkill"]&&-1!=s["targetSkill"]?"洗武"==Jo[this.select.learnTab]?a["typ"]="洗武":"明玉"==Jo[this.select.learnTab]&&(a["typ"]="明玉"):(l=!0,a["typ"]="特殊秘籍"),this.select.flagXj&&(a["璇玑"]=!0),this.select.flagLx&&(a["灵犀"]=!0);const n=this.learnRole.addLearnedBook(new Wa(a));n?(this.learnBookChanged(),l&&"特殊秘籍"!=Jo[this.select.learnTab]?this.select.learnTab=Jo.indexOf("特殊秘籍"):"特殊秘籍"!=Jo[this.select.learnTab]||l||(this.select.learnTab=0)):this.showMsg("这本秘籍已经学过了")},learnBookChanged(){this.roleInfo.recalcLearn(),this.roleInfo.recalcFinalAttr()},upMoveBook(){for(const e of this.select.learnSelect)e.bookId&&this.learnRole.upMoveBook(e.bookId);this.learnRole.forceRefresh(),this.select.learnSelect=[]},downMoveBook(){this.select.learnSelect.reverse();for(const e of this.select.learnSelect)e.bookId&&this.learnRole.downMoveBook(e.bookId);this.learnRole.forceRefresh(),this.select.learnSelect=[]},deleteBook(){if("事件加属性"==Jo[this.select.learnTab])return this.learnRole.deletePropEvents(this.select.learnSelect.map((e=>e.col-1))),this.roleInfo.recalcLearn(),this.roleInfo.recalcFinalAttr(),void(this.select.learnSelect=[]);for(const e of this.select.learnSelect)e.bookId&&this.learnRole.deleteLearnedBook(e.bookId);this.learnBookChanged(),this.select.learnSelect=[]},bookTagChanged(){-1==this.bookLevels.indexOf(this.select.bookLevel)&&(this.select.bookLevel="不限")},addPropEvent(){this.learnRole.addPropEvent(this.select.propEvent),this.roleInfo.recalcLearn(),this.roleInfo.recalcFinalAttr(),this.select.eventPropDialog=!1,this.select.propEvent={attrs:{}}},showMsg(e){this.select.msg=e,this.select.snackbar=!0},numberRules:e=>{const t=/^\d+$/;return t.test(e)||"只能输入数字"}},computed:{ready(){return this.$store.getters["isReady"]},portfolioList(){return this.$store.state["learnSim"].learnPortfolios},learnPortfolio(){return this.$store.state["learnSim"].curLearnPortfolio},isChief(){return 0==this.select.role},branches(){const e=Yo.map(((e,t)=>({index:t,cols:e.map(((e,t)=>({index:t,name:e,list:Ka[e]})))})));return e},cloneRoles(){return Object.values(this.$store.state.HeroSource).filter((e=>e["friend"]&&0!=e["id"])).map((e=>({text:`[${e.id}]${e.name}`,value:e.id})))},roles(){return Object.values(this.$store.state.HeroSource).filter((e=>e["friend"])).filter((e=>{const t=this.select.roleGroup;if("全部"==t)return!0;const a=$(e.id);return a?"主角"==a.group||"女主"==a.group||"女儿"==a.group?"主角团"==t:a.group==t||"其他"==t&&-1==Wo.indexOf(a.group):"氪金人"==t&&e["ke"]})).map((e=>({text:`[${e.id}]${e.name}`,value:e.id})))},learnHeaders(){return ac},bookHeaders(){return sc},learnItems(){let e=[];return 0==this.select.learnTab&&(e=e.concat(this.roleInfo.getOwnedSkills().map((e=>({tag:1==e.level?"初始1级":"初始",...e}))))),e=4==this.select.learnTab?e.concat(this.learnRole.getPropEvents()):e.concat(this.learnRole.getLearnedBooks(this.select.learnTab>0?Jo[this.select.learnTab]:null)),e.map(((e,t)=>({id:t,col:t+1,...e})))},bookItems(){if(!this.$store.getters["isReady"])return[];const e=Object.values(this.$store.state.ItemSource).filter((e=>2==e.type&&("内功"==e["bookType"]?7==e["level"]?"防功"==ec[this.select.bookTab]:0==e["level"]?"特殊"==ec[this.select.bookTab]:"内功"==ec[this.select.bookTab]:e["bookType"]==ec[this.select.bookTab]))).filter((e=>!this.select.bookLevel||"不限"==this.select.bookLevel||e["level"]==this.select.bookLevel)).filter((e=>!this.select.available||ts(e,this.roleInfo,{"无相":this.select.flagWx}))).map((e=>es(e))).sort(((e,t)=>"number"===typeof e.level&&"number"===typeof t.level?e.level-t.level:"number"===typeof e.level?-1:"number"===typeof t.level?1:e.level?.localeCompare(t.level)||0));return e},bookLevels(){const e=["不限"],t=(e,t)=>Array.from({length:t-e+1},((t,a)=>a+e));let a=[];return this.select.bookTab<5?a=t(2,9):5!=this.select.bookTab&&6!=this.select.bookTab||(a=t(1,5)),e.concat(a)}},created(){this.ready&&this.resetView()},watch:{ready:{handler:function(e,t){e&&!t&&this.resetView()},deep:!0}},mixins:[{data(){return{btnProps:{text:!0,outlined:!0,class:"my-btn"}}}}]},nc=lc,rc=(0,xs.Z)(nc,Uo,Qo,!1,null,"124900a4",null),ic=rc.exports;s.ZP.use(ms.ZP);const oc=[{path:"/",name:"home",component:Is},{path:"/about",name:"about",component:()=>a.e(443).then(a.bind(a,1272))},{path:"/hero",name:"hero",component:Sn},{path:"/item",name:"item",component:xl},{path:"/skill",name:"skill",component:Vl},{path:"/suit",name:"suit",component:Xl},{path:"/list",name:"list",component:Yi},{path:"/skill-config",name:"skill-config",component:un},{path:"/event",name:"event",component:Bn},{path:"/event-group",name:"event-group",component:Zr},{path:"/event-point",name:"event-point",component:jr},{path:"/battle",name:"battle",component:ii},{path:"/talk-ref",name:"talk-ref",component:gi},{path:"/custom-sim",name:"custom",component:qo},{path:"/learn-sim",name:"learn",component:ic},{path:"/coming",name:"coming",component:()=>a.e(390).then(a.bind(a,5390))}],cc=new ms.ZP({routes:oc,mode:"hash",base:"/"});var uc=cc,dc=a(998),fc=a(6232),hc=a(5550),mc=a(5808),pc=a(7397),gc=a(4525),bc=a(9471),vc=a(4611),_c=a(3059),kc=a(9709),yc=a(2933),$c=a(3305),Lc=function(){var e=this,t=e._self._c;return t(dc.Z,[t(kc.Z,{attrs:{app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[t(gc.Z,{attrs:{to:"/"}},[t(vc.Z,[t(ao.Z,[e._v("mdi-home-city")])],1),t(bc.V9,[e._v("首页")])],1),t(eo.Z),t(mc.Z,{attrs:{dense:"",nav:""}},e._l(e.items,(function(a){return t(pc.Z,{key:a.title,attrs:{value:!0,"sub-group":""},scopedSlots:e._u([{key:"activator",fn:function(){return[t(bc.V9,[e._v(e._s(a.title))])]},proxy:!0}],null,!0)},e._l(a.sub,(function(a){return t(gc.Z,{key:a.title,attrs:{to:a.to,link:""}},[t(bc.km,[t(bc.V9,[e._v(e._s(a.title))])],1)],1)})),1)})),1)],1),t(fc.Z,{attrs:{app:"",color:"primary",height:"50vh",dark:""}},[t(hc.Z,{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),t("div",{staticClass:"d-flex align-center"},[t("span",{staticClass:"mr-1"},[e._v("金书红颜录数据查看器")])]),t(lo.Z),t("span",{staticClass:"mr-2"},[e._v("游戏版本：")]),t(so.Z,{staticClass:"text-subtitle-2",staticStyle:{"max-width":"100pt",height:"40px"},attrs:{dense:"",items:e.SupportedVersions.map((e=>e.name)),value:e.selectedVersion,outlined:""},on:{change:e.changeVersion}})],1),t(_c.Z,[t("router-view"),t(yc.Z,{attrs:{absolute:!1,value:e.showOverlay}},[t($c.Z,{attrs:{rotate:90,size:100,width:15,value:e.loadingProgress,color:"primary"}},[e._v(" "+e._s(e.loadingProgress)+"% ")])],1)],1)],1)},xc=[],Sc={name:"App",data:()=>({drawer:!0,items:[{title:"基本数据",sub:[{title:"人物",to:"/hero"},{title:"武功",to:"/skill"},{title:"物品",to:"/item"},{title:"套装配合",to:"/list"},{title:"武功数值",to:"/skill-config"}]},{title:"高阶数据",sub:[{title:"事件总览",to:"/event"},{title:"事件指令",to:"/event-group"},{title:"场景事件点",to:"/event-point"},{title:"战斗",to:"/battle"},{title:"对话引用",to:"/talk-ref"}]},{title:"辅助工具",sub:[{title:"分数计算器",to:"/custom-sim"},{title:"养成模拟器(Beta)",to:"/learn-sim"}]}]}),computed:{...(0,l.rn)(["SupportedVersions"]),selectedVersion(){return this.$store.state.CurVersion?.name||""},loadingProgress(){return this.$store.getters["loadingProgress"]},showOverlay(){return!this.$store.getters["isReady"]}},methods:{changeVersion(e){this.$store.commit("setVersion",e),this.$store.dispatch("initStore")}},components:{}},Ac=Sc,wc=(0,xs.Z)(Ac,Lc,xc,!1,null,null,null),Cc=wc.exports;s.ZP.config.productionTip=!1,new s.ZP({vuetify:hs,store:ds,router:uc,beforeCreate(){this.$store.dispatch("initStore")},render:e=>e(Cc)}).$mount("#app")},7941:function(e,t,a){function s(e,t){localStorage.setItem(e,JSON.stringify(t))}function l(e){localStorage.removeItem(e)}function n(e){const t=localStorage.getItem(e);return"undefined"!=t?JSON.parse(t):null}a.r(t),a.d(t,{localDelete:function(){return l},localLoad:function(){return n},localSave:function(){return s}})}},t={};function a(s){var l=t[s];if(void 0!==l)return l.exports;var n=t[s]={exports:{}};return e[s].call(n.exports,n,n.exports,a),n.exports}a.m=e,function(){var e=[];a.O=function(t,s,l,n){if(!s){var r=1/0;for(u=0;u<e.length;u++){s=e[u][0],l=e[u][1],n=e[u][2];for(var i=!0,o=0;o<s.length;o++)(!1&n||r>=n)&&Object.keys(a.O).every((function(e){return a.O[e](s[o])}))?s.splice(o--,1):(i=!1,n<r&&(r=n));if(i){e.splice(u--,1);var c=l();void 0!==c&&(t=c)}}return t}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[s,l,n]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,s){return a.f[s](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+(443===e?"about":e)+"."+{390:"5f20b0f2",443:"59813d5b"}[e]+".js"}}(),function(){a.miniCssF=function(e){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="jsproj-web:";a.l=function(s,l,n,r){if(e[s])e[s].push(l);else{var i,o;if(void 0!==n)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==s||d.getAttribute("data-webpack")==t+n){i=d;break}}i||(o=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,a.nc&&i.setAttribute("nonce",a.nc),i.setAttribute("data-webpack",t+n),i.src=s),e[s]=[l];var f=function(t,a){i.onerror=i.onload=null,clearTimeout(h);var l=e[s];if(delete e[s],i.parentNode&&i.parentNode.removeChild(i),l&&l.forEach((function(e){return e(a)})),t)return t(a)},h=setTimeout(f.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=f.bind(null,i.onerror),i.onload=f.bind(null,i.onload),o&&document.head.appendChild(i)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){var e={143:0};a.f.j=function(t,s){var l=a.o(e,t)?e[t]:void 0;if(0!==l)if(l)s.push(l[2]);else{var n=new Promise((function(a,s){l=e[t]=[a,s]}));s.push(l[2]=n);var r=a.p+a.u(t),i=new Error,o=function(s){if(a.o(e,t)&&(l=e[t],0!==l&&(e[t]=void 0),l)){var n=s&&("load"===s.type?"missing":s.type),r=s&&s.target&&s.target.src;i.message="Loading chunk "+t+" failed.\n("+n+": "+r+")",i.name="ChunkLoadError",i.type=n,i.request=r,l[1](i)}};a.l(r,o,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,s){var l,n,r=s[0],i=s[1],o=s[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(l in i)a.o(i,l)&&(a.m[l]=i[l]);if(o)var u=o(a)}for(t&&t(s);c<r.length;c++)n=r[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(u)},s=self["webpackChunkjsproj_web"]=self["webpackChunkjsproj_web"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(2223)}));s=a.O(s)})();
//# sourceMappingURL=app.bf7efe67.js.map